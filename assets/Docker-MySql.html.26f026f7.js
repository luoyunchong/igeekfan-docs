import{_ as s}from"./plugin-vue_export-helper.21dcd24c.js";import{d as n}from"./app.a1a206ff.js";const a={},e=n(`<h1 id="docker-\u914D\u7F6E-mysql" tabindex="-1"><a class="header-anchor" href="#docker-\u914D\u7F6E-mysql" aria-hidden="true">#</a> Docker \u914D\u7F6E MySql</h1><h2 id="_1-\u62C9\u53D6\u955C\u50CF" tabindex="-1"><a class="header-anchor" href="#_1-\u62C9\u53D6\u955C\u50CF" aria-hidden="true">#</a> 1.\u62C9\u53D6\u955C\u50CF</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> pull mysql:5.7   <span class="token comment"># \u62C9\u53D6 mysql 5.7</span>
<span class="token function">docker</span> pull mysql       <span class="token comment"># \u62C9\u53D6\u6700\u65B0\u7248mysql\u955C\u50CF</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_2\u4E0D\u6307\u5B9A\u76EE\u5F55\u6620\u5C04" tabindex="-1"><a class="header-anchor" href="#_2\u4E0D\u6307\u5B9A\u76EE\u5F55\u6620\u5C04" aria-hidden="true">#</a> 2\u4E0D\u6307\u5B9A\u76EE\u5F55\u6620\u5C04</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">docker</span> run -p <span class="token number">3306</span>:3306 --name mysql -e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> -d mysql
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>-p \u7AEF\u53E3\u914D\u7F6E \u4E3B\u673A3306/\u5BB9\u56683306 -name \u5BB9\u5668\u540D\uFF0C\u6B64\u5904\u4E3Amysql -e \u914D\u7F6E\u4FE1\u606F MYSQL_ROOT_PASSWORD=123456 \u6307\u5B9A\u5BC6\u7801\u4E3A123456 -d \u6307\u5B9A\u955C\u50CF sudo docker run -p 3306:3306 --name mysql -e MYSQL_ROOT_PASSWORD=123456 -d mysql</p><blockquote><p>\u9ED8\u8BA4\u7684\u914D\u7F6E\u6587\u4EF6\u662F\uFF1A/etc/mysql/my.cnf \u9ED8\u8BA4\u7684\u6570\u636E\u76EE\u5F55\u662F\uFF1A/var/lib/mysql</p></blockquote><p>\u6211\u4EEC\u8FDB\u5165mysql\u5BB9\u5668\u4E2D\uFF0C\u67E5\u770Bmy.cnf.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it mysql <span class="token function">bash</span>
<span class="token function">cat</span> /etc/mysql/my.cnf
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>my.cnf \u52A0\u8F7D\u4E86 /etc/mysql/conf.d\u76EE\u5F55\u4E2D\u6240\u6709\u4EE5\u540E\u7F00\u4E3A.cnf\u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u6240\u4EE5\u6211\u4EEC\u6620\u5C04\u76EE\u5F55\uFF0C\u53EA\u9700\u8981\u6620\u5C04conf.d\u76EE\u5F55\u5373\u53EF\u3002</p><p>\u5148\u5728linux\u4E0A\u521B\u5EFA\u76EE\u5F55</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">mkdir</span> -p /usr/local/docker/mysql/conf.d
<span class="token function">sudo</span> <span class="token function">vim</span> mysql-docker.cnf
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u4FDD\u5B58\u5185\u5BB9</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
server-id <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">#\u670D\u52A1Id\u552F\u4E00</span>
port <span class="token operator">=</span> <span class="token number">3306</span>
log-error    <span class="token operator">=</span> /var/log/mysql/error.log
<span class="token comment">#\u53EA\u80FD\u7528IP\u5730\u5740</span>
skip_name_resolve 
<span class="token comment">#\u6570\u636E\u5E93\u9ED8\u8BA4\u5B57\u7B26\u96C6</span>
character-set-server <span class="token operator">=</span> utf8mb4
<span class="token comment">#\u6570\u636E\u5E93\u5B57\u7B26\u96C6\u5BF9\u5E94\u4E00\u4E9B\u6392\u5E8F\u7B49\u89C4\u5219 </span>
collation-server <span class="token operator">=</span> utf8mb4_general_ci
<span class="token comment">#\u8BBE\u7F6Eclient\u8FDE\u63A5mysql\u65F6\u7684\u5B57\u7B26\u96C6,\u9632\u6B62\u4E71\u7801</span>
<span class="token assign-left variable">init_connect</span><span class="token operator">=</span><span class="token string">&#39;SET NAMES utf8mb4&#39;</span>
<span class="token comment">#\u6700\u5927\u8FDE\u63A5\u6570</span>
max_connections <span class="token operator">=</span> <span class="token number">300</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#\u5982\u679C\u9047\u5230\u8FD9\u4E2A\u9519\u5C31\u6267\u884C\u4E0B\u6743\u9650</span>
<span class="token comment">#mysqld: [Warning] World-writable config file &#39;/etc/mysql/conf.d/mysql-docker.cnf&#39; is ignored</span>
<span class="token function">sudo</span> <span class="token function">chmod</span> <span class="token number">644</span> mysql-docker.cnf
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_3-\u5EFA\u7ACB\u76EE\u5F55\u6620\u5C04" tabindex="-1"><a class="header-anchor" href="#_3-\u5EFA\u7ACB\u76EE\u5F55\u6620\u5C04" aria-hidden="true">#</a> 3.\u5EFA\u7ACB\u76EE\u5F55\u6620\u5C04</h2><p>\u5728linux\u4E0A\u521B\u5EFA\u76EE\u5F55\uFF0C\u7528\u4E8E\u5B58\u653Emysql\u7684\u65E5\u5FD7\u548C\u6570\u636E\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">mkdir</span> -p /usr/local/docker/mysql/logs
<span class="token function">sudo</span> <span class="token function">mkdir</span> -p /usr/local/docker/mysql/data
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">docker</span> run -p <span class="token number">3310</span>:3306 --name mysql <span class="token punctuation">\\</span>
-v /usr/local/docker/mysql/conf.d:/etc/mysql/conf.d <span class="token punctuation">\\</span>
-v /usr/local/docker/mysql/logs:/var/log/mysql <span class="token punctuation">\\</span>
-v /usr/local/docker/mysql/data:/var/lib/mysql <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\\</span>
--restart<span class="token operator">=</span>always <span class="token punctuation">\\</span>
-d mysql

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#\u67E5\u770Bdocker \u4E0B\u8FDB\u7A0B\uFF0Cmysql\u662F\u5426\u542F\u52A8</span>
<span class="token function">docker</span> <span class="token function">ps</span> 
<span class="token comment">#\u7531\u4E8E mysql /var/log/mysql \u9ED8\u8BA4\u60C5\u51B5\u4E0B\u67E5\u770B</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> mysql <span class="token function">chown</span> mysql:root /var/log/mysql
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>-p \u7AEF\u53E3\u914D\u7F6E linux\u4E3B\u673A3310/\u5BB9\u56683306</li><li>-name \u5BB9\u5668\u540D\uFF0C\u6B64\u5904\u4E3Amysql</li><li>-v \u6307\u5B9A\u5BB9\u5668\u53CA\u5176\u6302\u8F7D\u7684\u5377\uFF0C\u6B64\u5916\u4E3A \u5BBF\u4E3B\u673A\u6587\u4EF6\u76EE\u5F55:\u5BB9\u5668\u6587\u4EF6\u76EE\u5F55\uFF0C\u53EF\u6307\u5B9A\u591A\u4E2A\u6570\u636E\u6587\u4EF6\u76EE\u5F55</li><li>-e \u914D\u7F6E\u4FE1\u606F MYSQL_ROOT_PASSWORD=123456 \u8BBE\u7F6E MySql\u670D\u52A1\u7684root\u5BC6\u7801\u4E3A123456</li><li>--restart=always \u5BB9\u5668\u9000\u51FA\u65F6\u603B\u662F\u91CD\u542F</li><li>-d \u540E\u53F0\u8FD0\u884C\u3002</li><li>\u955C\u50CF\u540D</li></ul><h2 id="docker\u76F8\u5173\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#docker\u76F8\u5173\u547D\u4EE4" aria-hidden="true">#</a> Docker\u76F8\u5173\u547D\u4EE4</h2><p>\u5176\u4E2Dmysql\u4E3A\u5BB9\u5668\u7684name\u6216id</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#\u91CD\u542F\u5BB9\u5668</span>
<span class="token function">docker</span> restart mysql
<span class="token comment">#\u6682\u505C\u5BB9\u5668</span>
<span class="token function">docker</span> stop mysql
<span class="token comment">#\u5220\u9664\u5BB9\u5668</span>
<span class="token function">docker</span> <span class="token function">rm</span> mysql
<span class="token comment">#\u542F\u52A8\u5BB9\u5668</span>
<span class="token function">docker</span> start mysql
<span class="token comment">#\u66F4\u65B0\u5BB9\u5668 \u5F00\u673A\u4E5F\u80FD\u91CD\u542F</span>
<span class="token function">docker</span> update mysql --restart<span class="token operator">=</span>always
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="\u914D\u7F6E\u8FDC\u7A0Bnavicat\u53EF\u8BBF\u95EE" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u8FDC\u7A0Bnavicat\u53EF\u8BBF\u95EE" aria-hidden="true">#</a> \u914D\u7F6E\u8FDC\u7A0BNavicat\u53EF\u8BBF\u95EE</h3><p>\u5982\u679C\u9047\u5230\u65E0\u6CD5\u8BBF\u95EE\u65F6\uFF0C\u53EF\u4EE5\u4F7F\u7528\u6B64\u65B9\u5F0F</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it mysql /bin/bash
mysql -uroot -p123456
use mysql<span class="token punctuation">;</span>
ALTER <span class="token environment constant">USER</span> <span class="token string">&#39;root&#39;</span>@<span class="token string">&#39;%&#39;</span> IDENTIFIED WITH mysql_native_password BY <span class="token string">&#39;123456&#39;</span><span class="token punctuation">;</span>
flush privileges<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="restart\u53C2\u6570" tabindex="-1"><a class="header-anchor" href="#restart\u53C2\u6570" aria-hidden="true">#</a> Restart\u53C2\u6570</h3><p>Docker \u4E2Drestart\u53C2\u6570\u7528\u4E8E\u6307\u5B9A\u81EA\u52A8\u91CD\u542Fdocker\u5BB9\u5668\u7B56\u7565\uFF0C\u5305\u542B3\u4E2A\u9009\u9879\uFF1Ano\uFF0Con-failure[:times]\uFF0Calways\uFF0Cunless-stopped</p><p>no \u9ED8\u8BA4\u503C\uFF0C\u8868\u793A\u5BB9\u5668\u9000\u51FA\u65F6\uFF0Cdocker\u4E0D\u81EA\u52A8\u91CD\u542F\u5BB9\u5668</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run --restart<span class="token operator">=</span>no <span class="token punctuation">[</span>\u5BB9\u5668\u540D<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>on-failure \u82E5\u5BB9\u5668\u7684\u9000\u51FA\u72B6\u6001\u975E0\uFF0C\u5219docker\u81EA\u52A8\u91CD\u542F\u5BB9\u5668\uFF0C\u8FD8\u53EF\u4EE5\u6307\u5B9A\u91CD\u542F\u6B21\u6570\uFF0C\u82E5\u8D85\u8FC7\u6307\u5B9A\u6B21\u6570\u672A\u80FD\u542F\u52A8\u5BB9\u5668\u5219\u653E\u5F03**</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run --restart<span class="token operator">=</span>on-failure:3 <span class="token punctuation">[</span>\u5BB9\u5668\u540D<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>always \u5BB9\u5668\u9000\u51FA\u65F6\u603B\u662F\u91CD\u542F**</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run --restart<span class="token operator">=</span>always <span class="token punctuation">[</span>\u5BB9\u5668\u540D<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>unless-stopped \u5BB9\u5668\u9000\u51FA\u65F6\u603B\u662F\u91CD\u542F\uFF0C\u4F46\u4E0D\u8003\u8651Docker\u5B88\u62A4\u8FDB\u7A0B\u542F\u52A8\u65F6\u5C31\u5DF2\u7ECF\u505C\u6B62\u7684\u5BB9\u5668**</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run --restart<span class="token operator">=</span>unless-stopped <span class="token punctuation">[</span>\u5BB9\u5668\u540D<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u5982\u679C\u5BB9\u5668\u542F\u52A8\u65F6\u6CA1\u6709\u8BBE\u7F6E\u2013restart\u53C2\u6570\uFF0C\u5219\u901A\u8FC7\u4E0B\u9762\u547D\u4EE4\u8FDB\u884C\u66F4\u65B0\uFF1A* *</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> update --restart<span class="token operator">=</span>always <span class="token punctuation">[</span>\u5BB9\u5668\u540D<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div>`,39);function l(p,c){return e}var t=s(a,[["render",l],["__file","Docker-MySql.html.vue"]]);export{t as default};
