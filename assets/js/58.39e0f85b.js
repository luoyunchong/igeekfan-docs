(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{636:function(_,t,v){"use strict";v.r(t);var d=v(10),r=Object(d.a)({},(function(){var _=this,t=_.$createElement,v=_._self._c||t;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("h2",{attrs:{id:"基于rbac实现权限设计"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#基于rbac实现权限设计"}},[_._v("#")]),_._v(" 基于RBAC实现权限设计")]),_._v(" "),v("p",[_._v("功能：实现一个用户设置多个分组，分组可以设置多个权限，权限与后台API方法对应，前端菜单绑定权限编码，前端按钮绑定权限编码，从而实现用户可配置权限，从而控制界面上的元素等。")]),_._v(" "),v("h3",{attrs:{id:"_1-用户表-lin-user"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-用户表-lin-user"}},[_._v("#")]),_._v(" 1. 用户表 lin_user")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("字段")]),_._v(" "),v("th",[_._v("备注")]),_._v(" "),v("th",[_._v("类型")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("id")]),_._v(" "),v("td",[_._v("主键Id")]),_._v(" "),v("td",[_._v("bigint")])]),_._v(" "),v("tr",[v("td",[_._v("username")]),_._v(" "),v("td",[_._v("用户名")]),_._v(" "),v("td",[_._v("varchar")])]),_._v(" "),v("tr",[v("td",[_._v("nickname")]),_._v(" "),v("td",[_._v("昵称")]),_._v(" "),v("td",[_._v("varchar")])]),_._v(" "),v("tr",[v("td",[_._v("phone_number")]),_._v(" "),v("td",[_._v("手机号")]),_._v(" "),v("td",[_._v("varchar")])]),_._v(" "),v("tr",[v("td",[_._v("avatar")]),_._v(" "),v("td",[_._v("用户默认生成图像，为null、头像url")]),_._v(" "),v("td",[_._v("varchar")])]),_._v(" "),v("tr",[v("td",[_._v("email")]),_._v(" "),v("td",[_._v("电子邮箱")]),_._v(" "),v("td",[_._v("varchar")])]),_._v(" "),v("tr",[v("td",[_._v("active")]),_._v(" "),v("td",[_._v("1激活 2  非激活")]),_._v(" "),v("td",[_._v("int")])])])]),_._v(" "),v("h3",{attrs:{id:"_2-分组表-lin-group"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-分组表-lin-group"}},[_._v("#")]),_._v(" 2. 分组表 lin_group")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("字段")]),_._v(" "),v("th",[_._v("备注")]),_._v(" "),v("th",[_._v("类型")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("id")]),_._v(" "),v("td",[_._v("主键Id")]),_._v(" "),v("td",[_._v("bigint")])]),_._v(" "),v("tr",[v("td",[_._v("name")]),_._v(" "),v("td",[_._v("权限组名称")]),_._v(" "),v("td",[_._v("varchar")])]),_._v(" "),v("tr",[v("td",[_._v("info")]),_._v(" "),v("td",[_._v("权限组描述")]),_._v(" "),v("td",[_._v("varchar")])]),_._v(" "),v("tr",[v("td",[_._v("is_static")]),_._v(" "),v("td",[_._v("是否是静态分组")]),_._v(" "),v("td",[_._v("bit")])])])]),_._v(" "),v("h3",{attrs:{id:"_3-用户分组表-lin-user-group"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-用户分组表-lin-user-group"}},[_._v("#")]),_._v(" 3. 用户分组表 lin_user_group")]),_._v(" "),v("p",[_._v("用户分组表。用于用户和分组表的关联。可配置一个用户属于多个分组。")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("字段")]),_._v(" "),v("th",[_._v("备注")]),_._v(" "),v("th",[_._v("类型")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("id")]),_._v(" "),v("td",[_._v("主键Id")]),_._v(" "),v("td",[_._v("bigint")])]),_._v(" "),v("tr",[v("td",[_._v("user_id")]),_._v(" "),v("td",[_._v("用户ID")]),_._v(" "),v("td",[_._v("bigint")])]),_._v(" "),v("tr",[v("td",[_._v("group_id")]),_._v(" "),v("td",[_._v("分组ID")]),_._v(" "),v("td",[_._v("bigint")])])])]),_._v(" "),v("h3",{attrs:{id:"_4-权限表-lin-permission"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4-权限表-lin-permission"}},[_._v("#")]),_._v(" 4. 权限表 lin_permission")]),_._v(" "),v("p",[_._v("权限表，本系统通过反射在系统初次启动时，启动异步任务，将不存在的权限新增到此表中。")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("字段")]),_._v(" "),v("th",[_._v("备注")]),_._v(" "),v("th",[_._v("类型")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("id")]),_._v(" "),v("td",[_._v("主键Id")]),_._v(" "),v("td",[_._v("bigint")])]),_._v(" "),v("tr",[v("td",[_._v("module")]),_._v(" "),v("td",[_._v("权限所属模块，例如：人员管理")]),_._v(" "),v("td",[_._v("varchar")])]),_._v(" "),v("tr",[v("td",[_._v("name")]),_._v(" "),v("td",[_._v("所属权限、权限名称，例如：访问首页")]),_._v(" "),v("td",[_._v("varchar")])])])]),_._v(" "),v("h3",{attrs:{id:"_5-分组权限表-lin-group-permission"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_5-分组权限表-lin-group-permission"}},[_._v("#")]),_._v(" 5. 分组权限表 lin_group_permission")]),_._v(" "),v("p",[_._v("分组权限表，用于分组与权限表的关联")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("字段")]),_._v(" "),v("th",[_._v("备注")]),_._v(" "),v("th",[_._v("类型")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("id")]),_._v(" "),v("td",[_._v("主键Id")]),_._v(" "),v("td",[_._v("bigint")])]),_._v(" "),v("tr",[v("td",[_._v("group_id")]),_._v(" "),v("td",[_._v("分组Id")]),_._v(" "),v("td",[_._v("bigint")])]),_._v(" "),v("tr",[v("td",[_._v("permission_id")]),_._v(" "),v("td",[_._v("权限Id")]),_._v(" "),v("td",[_._v("bigint")])])])]),_._v(" "),v("h3",{attrs:{id:"_6-用户身份认证登录表-lin-user-identity"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_6-用户身份认证登录表-lin-user-identity"}},[_._v("#")]),_._v(" 6. 用户身份认证登录表 lin_user_identity")]),_._v(" "),v("p",[_._v("用户授权信息表，用于存储不同登录类型的用户信息，如手机号、邮件、用户名、第三方应用（微信、QQ、GitHub）的登录")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("字段")]),_._v(" "),v("th",[_._v("备注")]),_._v(" "),v("th",[_._v("类型")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("id")]),_._v(" "),v("td",[_._v("char")]),_._v(" "),v("td",[_._v("主键Id")])]),_._v(" "),v("tr",[v("td",[_._v("identity_type")]),_._v(" "),v("td",[_._v("varchar")]),_._v(" "),v("td",[_._v("认证类型Password，GitHub、QQ、WeiXin等")])]),_._v(" "),v("tr",[v("td",[_._v("identifier")]),_._v(" "),v("td",[_._v("varchar")]),_._v(" "),v("td",[_._v("认证者，例如 用户名,手机号，邮件等，")])]),_._v(" "),v("tr",[v("td",[_._v("credential")]),_._v(" "),v("td",[_._v("varchar")]),_._v(" "),v("td",[_._v("凭证，例如 密码,存OpenId、Id，同一IdentityType的OpenId的值是唯一的")])]),_._v(" "),v("tr",[v("td",[_._v("create_user_id")]),_._v(" "),v("td",[_._v("bigint")]),_._v(" "),v("td",[_._v("绑定的用户Id")])]),_._v(" "),v("tr",[v("td",[_._v("create_time")]),_._v(" "),v("td",[_._v("datetime")]),_._v(" "),v("td")])])]),_._v(" "),v("h2",{attrs:{id:"字典管理"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#字典管理"}},[_._v("#")]),_._v(" 字典管理")]),_._v(" "),v("p",[_._v("主要功能：仅限于通用的下拉列表选择，有变化的可能性。抽象成统一的配置项。")]),_._v(" "),v("p",[_._v("比如：文章是（原创，转载，翻译),性别是（男，女）。当然更多，在下文会有介绍。")]),_._v(" "),v("h3",{attrs:{id:"_1-base-type-字典类别管理"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-base-type-字典类别管理"}},[_._v("#")]),_._v(" 1.base_type （字典类别管理）")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("字段")]),_._v(" "),v("th",[_._v("类型")]),_._v(" "),v("th",[_._v("备注")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("id")]),_._v(" "),v("td",[_._v("int")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("type_code")]),_._v(" "),v("td",[_._v("varchar(50)")]),_._v(" "),v("td",[_._v("类别编码")])]),_._v(" "),v("tr",[v("td",[_._v("full_name")]),_._v(" "),v("td",[_._v("varchar(50)")]),_._v(" "),v("td",[_._v("全称")])]),_._v(" "),v("tr",[v("td",[_._v("sort_code")]),_._v(" "),v("td",[_._v("int")]),_._v(" "),v("td",[_._v("排序码")])])])]),_._v(" "),v("h3",{attrs:{id:"_2-base-item-字典管理"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-base-item-字典管理"}},[_._v("#")]),_._v(" 2.base_item （字典管理）")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("字段")]),_._v(" "),v("th",[_._v("类型")]),_._v(" "),v("th",[_._v("备注")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("id")]),_._v(" "),v("td",[_._v("int")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("base_type_id")]),_._v(" "),v("td",[_._v("int")]),_._v(" "),v("td",[_._v("类别id(关联base_type的id)")])]),_._v(" "),v("tr",[v("td",[_._v("item_code")]),_._v(" "),v("td",[_._v("varchar(50)")]),_._v(" "),v("td",[_._v("字典编码")])]),_._v(" "),v("tr",[v("td",[_._v("item_name")]),_._v(" "),v("td",[_._v("varchar(50)")]),_._v(" "),v("td",[_._v("字典全称")])]),_._v(" "),v("tr",[v("td",[_._v("sort_code")]),_._v(" "),v("td",[_._v("int")]),_._v(" "),v("td",[_._v("排序码")])])])]),_._v(" "),v("p",[_._v("BaseType 1 对BaseItem多。")]),_._v(" "),v("p",[_._v("如：标签管理，一个文章下可以设置多个标签，原本需要设计表Tag,字段也大抵为Id,Name,Sort及关联表。\n我们使用BaseType、BaseItem实现。\nBaseType中TypeCode为tag,FullName为标签，id为1时。\nBaseItem中BaseTypeId为1，ItemCode为编码,ItemName为标签。ItemCode为不重复的字符串即可。")]),_._v(" "),v("p",[_._v("另Tag与Article的关联表，需要另设计一个表。")]),_._v(" "),v("p",[_._v("当我们要实现文章类别的下拉，原本需要设计一个表ArticleType，有字段,id,name,sort等。\n我们可以通过BaseType、BaseItem来实现，从而简化这些基础数据。\nBaseType有一条数据，TypeCode为 字符串category、FullName文章类别，BaseItem存多个文章类别(Java、大数据、Python、C#等)，编码不同即可。")]),_._v(" "),v("p",[v("strong",[_._v("但现实总是事与愿违")]),_._v(",后台取文章列表时，想要取出文章对应的分类，手动join时，总觉得join的表会有些奇怪。")]),_._v(" "),v("p",[_._v("当然还有其他原因，"),v("strong",[_._v("局限性")]),_._v("：")]),_._v(" "),v("ol",[v("li",[_._v("比如使用了这个字典，分类需要增加一个图片字段，就不能满足要求，那怎么办呢，做不了。")]),_._v(" "),v("li",[_._v("比如标签需要实现这个标签下有多少个文章，通过统计也能实现，")])]),_._v(" "),v("p",[_._v("使用FreeSql实现时，如果二个表之间没有导航属性，是更复杂的。")]),_._v(" "),v("h2",{attrs:{id:""}},[v("a",{staticClass:"header-anchor",attrs:{href:"#"}},[_._v("#")])]),_._v(" "),v("h3",{attrs:{id:"lin-file文件存储"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#lin-file文件存储"}},[_._v("#")]),_._v(" lin_file文件存储")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("字段")]),_._v(" "),v("th",[_._v("类型")]),_._v(" "),v("th",[_._v("备注")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("id")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("bigint")])]),_._v(" "),v("tr",[v("td",[_._v("extension")]),_._v(" "),v("td",[_._v("varchar")]),_._v(" "),v("td",[_._v("后缀")])]),_._v(" "),v("tr",[v("td",[_._v("md5")]),_._v(" "),v("td",[_._v("varchar")]),_._v(" "),v("td",[_._v("图片md5值，防止上传重复图片")])]),_._v(" "),v("tr",[v("td",[_._v("name")]),_._v(" "),v("td",[_._v("varchar")]),_._v(" "),v("td",[_._v("名称")])]),_._v(" "),v("tr",[v("td",[_._v("path")]),_._v(" "),v("td",[_._v("varchar")]),_._v(" "),v("td",[_._v("路径")])]),_._v(" "),v("tr",[v("td",[_._v("size")]),_._v(" "),v("td",[_._v("bigint")]),_._v(" "),v("td",[_._v("大小")])]),_._v(" "),v("tr",[v("td",[_._v("type")]),_._v(" "),v("td",[_._v("smallint")]),_._v(" "),v("td",[_._v("1 local，2 代表七牛云 3 其他表示其他地方")])]),_._v(" "),v("tr",[v("td",[_._v("create_user_id")]),_._v(" "),v("td",[_._v("bigint")]),_._v(" "),v("td",[_._v("创建者ID")])])])]),_._v(" "),v("h3",{attrs:{id:"lin-log-日志记录"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#lin-log-日志记录"}},[_._v("#")]),_._v(" lin_log 日志记录")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("字段")]),_._v(" "),v("th",[_._v("类型")]),_._v(" "),v("th",[_._v("备注")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("id")]),_._v(" "),v("td",[_._v("bigint")]),_._v(" "),v("td",[_._v("主键Id")])]),_._v(" "),v("tr",[v("td",[_._v("authority")]),_._v(" "),v("td",[_._v("varchar")]),_._v(" "),v("td",[_._v("访问哪个权限")])]),_._v(" "),v("tr",[v("td",[_._v("message")]),_._v(" "),v("td",[_._v("varchar")]),_._v(" "),v("td",[_._v("日志信息")])]),_._v(" "),v("tr",[v("td",[_._v("method")]),_._v(" "),v("td",[_._v("varchar")]),_._v(" "),v("td",[_._v("请求方法")])]),_._v(" "),v("tr",[v("td",[_._v("path")]),_._v(" "),v("td",[_._v("varchar")]),_._v(" "),v("td",[_._v("请求路径")])]),_._v(" "),v("tr",[v("td",[_._v("status_code")]),_._v(" "),v("td",[_._v("int")]),_._v(" "),v("td",[_._v("请求的http返回码")])]),_._v(" "),v("tr",[v("td",[_._v("time")]),_._v(" "),v("td",[_._v("datetime")]),_._v(" "),v("td",[_._v("日志创建时间")])]),_._v(" "),v("tr",[v("td",[_._v("user_id")]),_._v(" "),v("td",[_._v("bigint")]),_._v(" "),v("td",[_._v("用户id")])]),_._v(" "),v("tr",[v("td",[_._v("user_name")]),_._v(" "),v("td",[_._v("varchar")]),_._v(" "),v("td",[_._v("用户当时的昵称")])]),_._v(" "),v("tr",[v("td",[_._v("other_message")]),_._v(" "),v("td",[_._v("longtext")]),_._v(" "),v("td")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);