(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{621:function(s,t,a){"use strict";a.r(t);var e=a(10),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"后端准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#后端准备"}},[s._v("#")]),s._v(" 后端准备")]),s._v(" "),a("h2",{attrs:{id:"server-端必备环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#server-端必备环境"}},[s._v("#")]),s._v(" Server 端必备环境")]),s._v(" "),a("ul",[a("li",[s._v("安装软件开发包 "),a("a",{attrs:{href:"https://dotnet.microsoft.com/zh-cn/download/dotnet/6.0",target:"_blank",rel:"noopener noreferrer"}},[s._v(".NET SDK 6.0"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("安装开发工具  "),a("a",{attrs:{href:"https://visualstudio.microsoft.com/zh-hans/vs/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Visual Studio 2022"),a("OutboundLink")],1),s._v("  或 "),a("a",{attrs:{href:"https://www.jetbrains.com/rider/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Rider"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("安装MySQL（version 5.7+)")]),s._v(" "),a("li",[s._v("Redis 4.0.14.2 for Windows "),a("a",{attrs:{href:"https://github.com/tporadowski/redis/releases",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/tporadowski/redis/releases"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"获取工程项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取工程项目"}},[s._v("#")]),s._v(" 获取工程项目")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/luoyunchong/lin-cms-dotnetcore.git\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"数据库配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据库配置"}},[s._v("#")]),s._v(" 数据库配置")]),s._v(" "),a("p",[s._v("文件位置"),a("code",[s._v("src/LinCms.Web/appsettings.json")]),s._v("，当数据库中存储表情包是，"),a("code",[s._v("Charset")]),s._v("为"),a("code",[s._v("utf8mb4")])]),s._v(" "),a("p",[a("strong",[s._v("请务必根据自己的实际情况修改此配置项")]),s._v("，"),a("code",[s._v("DefaultDB")]),s._v("为0时，代表使用"),a("code",[s._v("MySQL")]),s._v("，"),a("code",[s._v("DefaultDB")]),s._v("为1时，代表使用"),a("code",[s._v("SqlServer")]),s._v(",以此类推。")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"ConnectionStrings"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"DefaultDB"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"DataType"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"MySql"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"SqlServer"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"PostgreSQL"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Oracle"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Sqlite"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"MySql"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Data Source=localhost;Port=3306;User ID=root;Password=root;Initial Catalog=lincms;Charset=utf8mb4;SslMode=none;Max pool size=1;Connection LifeTime=20"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"SqlServer"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Data Source=.;User ID=sa;Password=123456;Integrated Security=True;Initial Catalog=LinCMS;Pooling=true;Min Pool Size=1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"PostgreSQL"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Host=localhost;Port=5432;Username=postgres;Password=123456; Database=lincms;Pooling=true;Minimum Pool Size=1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Oracle"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token null keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Sqlite"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Data Source=|DataDirectory|\\\\lincms.db; Attachs=lincms.db; Pooling=true;Min Pool Size=1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"CsRedis"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1:6379,password=,defaultDatabase=0"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[a("code",[s._v("LinCms.IdentityServer4")]),s._v(" 项目不是必须的，需要需要运行，需要修改数据库配置项")]),s._v(" "),a("p",[a("code",[s._v("identityserver4/LinCms.IdentityServer4/appsettings.json")]),s._v(" 数据库配置、同"),a("code",[s._v("LinCms.Web")]),s._v("中的配置项相同")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[s._v("  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"ConnectionStrings"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"DefaultDB"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"DataType"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"MySql"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"SqlServer"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"PostgreSQL"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Oracle"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Sqlite"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"MySql"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Data Source=localhost;Port=3308;User ID=root;Password=root;Initial Catalog=lincms;Charset=utf8mb4;SslMode=none;Max pool size=1;Connection LifeTime=20"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"SqlServer"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Data Source=.;User ID=sa;Password=123456;Integrated Security=True;Initial Catalog=LinCMS;Pooling=true;Min Pool Size=1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Sqlite"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Data Source=|DataDirectory|\\\\lincms.db; Attachs=lincms.db; Pooling=true;Min Pool Size=1"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("其中MariaDB（看做MySql）,通过"),a("code",[s._v("Serilog")]),s._v("记录日志，需要配置相应的链接串。")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MariaDB"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Args"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"connectionString"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Data Source=localhost;Port=3306;User ID=root;Password=root;Initial Catalog=lincms;Charset=utf8mb4;SslMode=none;Max pool size=1;Connection LifeTime=20"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"数据迁移"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据迁移"}},[s._v("#")]),s._v(" 数据迁移")]),s._v(" "),a("p",[s._v("该项目使用"),a("a",{attrs:{href:"https://github.com/2881099/FreeSql",target:"_blank",rel:"noopener noreferrer"}},[s._v("FreeSql"),a("OutboundLink")],1),s._v("，默认自动迁移数据表结构，会自动根据配置项创建数据库，初始化种子数据")]),s._v(" "),a("p",[s._v("默认会创建用户"),a("code",[s._v("admin")]),s._v("，密码"),a("code",[s._v("123qwe")])]),s._v(" "),a("h2",{attrs:{id:"visual-studio-2022运行项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#visual-studio-2022运行项目"}},[s._v("#")]),s._v(" visual studio 2022运行项目")]),s._v(" "),a("p",[s._v("双击lin-cms-dotnetcore.sln，使用vs2022打开项目。右键解决方案，点击生成解决方案。")]),s._v(" "),a("p",[s._v("由于将identityserver4单独拆成了一个项目，所以需要同时启动二个项目，"),a("strong",[s._v("右键解决方案，属性。")]),s._v(",选择多个启动项目，勾选二个项目同时启动。如下图所示。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://pic.downk.cc/item/5e83fd74504f4bcb04cf5474.png",alt:""}})]),s._v(" "),a("p",[s._v("这时候会打开二个网页  https://localhost:5001/swagger/index.html，即可看到swagger页面。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://pic.downk.cc/item/5e83ffd1504f4bcb04d0f039.jpg",alt:""}})]),s._v(" "),a("p",[s._v("会打开浏览器，访问"),a("a",{attrs:{href:"https://localhosst:5001/swagger/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://localhosst:5001/swagger/index.html"),a("OutboundLink")],1),s._v("，会看到swagger的文档。\n访问"),a("a",{attrs:{href:"https://localhosst:5001/swagger/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://localhosst:5003/swagger/index.html"),a("OutboundLink")],1),s._v(" 是ids4的接口文档，什么也看不到。")]),s._v(" "),a("p",[s._v("LinCms.Web运行效果：\n"),a("img",{attrs:{src:"https://ae01.alicdn.com/kf/He52bc4d3708242d2995419bb584e1f53Q.jpg",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署"}},[s._v("#")]),s._v(" 部署")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://blog.igeekfan.cn/2022/06/09/dotnetcore/ASP.NET-Core-Deploy-To-Ubuntu",target:"_blank",rel:"noopener noreferrer"}},[s._v("部署至Linux(Ubuntu16.06)"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://blog.igeekfan.cn/2022/06/09/dotnetcore/ASP.NET-Core-Deploy-To-Docker-Ubuntu/",target:"_blank",rel:"noopener noreferrer"}},[s._v("部署至Linux(Ubuntu16.06)下的Docker"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"部署前准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署前准备"}},[s._v("#")]),s._v(" 部署前准备")]),s._v(" "),a("p",[s._v("因为该项目基于IdentityServer4,实现的授权认证服务，")]),s._v(" "),a("p",[s._v("开发阶段使用"),a("code",[s._v("AddDeveloperSigningCredential()")]),s._v("方法即可完成签名认证，但是在生产环境，我们必须使用"),a("code",[s._v("AddSigningCredential()")]),s._v("方法并且使用OpenSSL生成自己的签名证书")]),s._v(" "),a("p",[s._v("Startup.cs")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('            services.AddIdentityServer()\n#if  DEBUG\n                .AddDeveloperSigningCredential()\n#endif\n#if !DEBUG\n                .AddSigningCredential(new X509Certificate2(Path.Combine(AppContext.BaseDirectory,\n                        Configuration["Certificates:Path"]),\n                    Configuration["Certificates:Password"]))\n#endif\n                .AddInMemoryIdentityResources(InMemoryConfiguration.GetIdentityResources())\n                .AddInMemoryApiResources(InMemoryConfiguration.GetApis())\n                .AddInMemoryClients(InMemoryConfiguration.GetClients())\n                .AddProfileService<LinCmsProfileService>()\n                .AddResourceOwnerValidator<LinCmsResourceOwnerPasswordValidator>();\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("appsettings.Production.json")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('{\n    "Certificates":\n    {\n        "Path":"ids4.pfx",\n        "Password":"123qwe"\n    }\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h3",{attrs:{id:"使用openssl生成证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用openssl生成证书"}},[s._v("#")]),s._v(" 使用OpenSSL生成证书")]),s._v(" "),a("p",[s._v("官网下载并安装OpenSSL "),a("a",{attrs:{href:"https://slproweb.com/products/Win32OpenSSL.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("OpenSSL官网"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("下载 Win64 OpenSSL v1.1.1b 版本")]),s._v(" "),a("p",[s._v("在OpenSSL的bin文件夹，以管理员身份打开CMD执行以下命令：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("openssl req -newkey rsa:2048 -nodes -keyout ids4.key -x509 -days 365 -out ids4.cer\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("下面将生成的证书和Key封装成一个文件，以便IdentityServer可以使用它们去正确地签名tokens")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("openssl pkcs12 -export -in ids4.cer -inkey ids4.key -out ids4.pfx \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h5",{attrs:{id:"注-在生成的过程中会让我们输入export-password"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注-在生成的过程中会让我们输入export-password"}},[s._v("#")]),s._v(" (注：在生成的过程中会让我们输入Export Password)")]),s._v(" "),a("p",[s._v("这个 密码与appsettings.Production.json配置项相同。")]),s._v(" "),a("p",[s._v("发布时，把ids4.pfx，放到项目根目录")]),s._v(" "),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/guolianyu/p/9872661.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("IdentityServer4之JWT签名(RSA加密证书)及验签"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=r.exports}}]);