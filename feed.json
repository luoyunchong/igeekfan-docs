{
  "version": "https://jsonfeed.org/version/1.1",
  "title": ".NET 开发者指北",
  "home_page_url": "https://igeekfan.cn/igeekfan-docs/",
  "feed_url": "https://igeekfan.cn/igeekfan-docs/feed.json",
  "description": "问君能有几多愁？恰似一江春水向东流。",
  "items": [
    {
      "title": "API 参考",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/api-reference.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/api-reference.html",
      "summary": "API 参考 LinCMS.NET Core 使用 Swagger (Swashbuckle) 自动生成交互式 API 文档。 当后端项目运行时，你可以通过访问以下路径来浏览和测试 API： Swagger UI: /swagger (例如: http://localhost:5000/swagger) Swagger JSON: /swagger/v...",
      "content_html": "\n<p><a href=\"http://LinCMS.NET\" target=\"_blank\" rel=\"noopener noreferrer\">LinCMS.NET</a> Core 使用 Swagger (Swashbuckle) 自动生成交互式 API 文档。</p>\n<p>当后端项目运行时，你可以通过访问以下路径来浏览和测试 API：</p>\n<ul>\n<li><strong>Swagger UI</strong>: <code>/swagger</code> (例如: <code>http://localhost:5000/swagger</code>)</li>\n<li><strong>Swagger JSON</strong>: <code>/swagger/v1/swagger.json</code> (或其他版本)</li>\n</ul>\n<p>Swagger UI 提供了一个用户友好的界面，你可以：</p>\n<ul>\n<li>查看所有可用的 API 端点及其 HTTP 方法。</li>\n<li>查看每个端点的请求参数、请求体结构和响应结构。</li>\n<li>直接在界面中发送请求并查看响应，方便调试。</li>\n<li>查看 DTO 模型的定义和验证规则。</li>\n</ul>\n<p>建议在开发和集成过程中经常参考 Swagger 文档。</p>\n",
      "date_published": "2025-04-28T17:00:03.000Z",
      "date_modified": "2025-04-28T17:00:03.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "后端快速入门",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/backend-quickstart.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/backend-quickstart.html",
      "summary": "后端快速入门 本文档将指导你如何在本地运行 LinCMS.NET Core 的后端项目。 环境要求 .NET 9 SDK 或更高版本 关系型数据库，如 MySql 5.7+, PostgreSQL 12+, SQLServer 2012+, Sqlite3 (默认) Redis (可选，用于分布式缓存和消息队列) IDE (Visual Studio ...",
      "content_html": "\n<p>本文档将指导你如何在本地运行 <a href=\"http://LinCMS.NET\" target=\"_blank\" rel=\"noopener noreferrer\">LinCMS.NET</a> Core 的后端项目。</p>\n<h2>环境要求</h2>\n<ul>\n<li><a href=\"https://dotnet.microsoft.com/download/dotnet/6.0\" target=\"_blank\" rel=\"noopener noreferrer\">.NET 9 SDK</a> 或更高版本</li>\n<li>关系型数据库，如 MySql 5.7+, PostgreSQL 12+, SQLServer 2012+, Sqlite3 (默认)</li>\n<li>Redis (可选，用于分布式缓存和消息队列)</li>\n<li>IDE (Visual Studio 2022 / VS Code / JetBrains Rider)</li>\n</ul>\n<h2>获取源码</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">git</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> clone</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> https://github.com/luoyunchong/lin-cms-dotnetcore.git</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lin-cms-dotnetcore</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>配置</h2>\n<p>主要的配置文件位于 <code>src/LinCms.Web/appsettings.json</code> 和特定环境的 <code>appsettings.{Environment}.json</code> (如 <code>appsettings.Development.json</code>)。</p>\n<h3>数据库配置</h3>\n<p>默认使用 Sqlite 数据库，文件位于 <code>src/LinCms.Web/lin-cms.db</code>。</p>\n<p>如需切换数据库，请修改 <code>ConnectionStrings</code> 节点：</p>\n<p><strong>MySql:</strong></p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"ConnectionStrings\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"MySql\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"server=localhost;port=3306;database=lincms;userid=root;password=root;sslmode=none;AllowPublicKeyRetrieval=True;\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">},</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"DbType\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"MySql\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> // 同时修改 DbType</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><strong>PostgreSQL:</strong></p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"ConnectionStrings\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"PostgreSQL\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Host=localhost;Port=5432;Database=lincms;Username=postgres;Password=root;\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">},</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"DbType\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"PostgreSQL\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> // 同时修改 DbType</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><strong>SQLServer:</strong></p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"ConnectionStrings\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"SqlServer\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Data Source=.;Initial Catalog=lincms;Integrated Security=True;Encrypt=True;TrustServerCertificate=True;\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">},</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"DbType\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"SqlServer\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> // 同时修改 DbType</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><strong>注意</strong>: 修改 <code>DbType</code> 字段以匹配你选择的数据库类型。</p>\n<h3>其他配置</h3>\n<ul>\n<li><strong>Redis</strong>: 如果需要使用 Redis，请在 <code>appsettings.json</code> 中配置 <code>ConnectionStrings:Redis</code> 并设置 <code>UseRedis</code> 为 <code>true</code>。</li>\n<li><strong>JWT</strong>: 可以在 <code>Jwt</code> 节点下配置 Token 的密钥 (<code>SecretKey</code>)、过期时间 (<code>Expires</code>) 等。</li>\n<li><strong>文件上传</strong>: 在 <code>File</code> 节点下配置上传设置，如存储位置 (<code>StoreDir</code>)、单个文件大小限制 (<code>SingleLimit</code>) 等。</li>\n</ul>\n<h2>数据库迁移与初始化</h2>\n<p>项目使用 FreeSql 的 CodeFirst 模式进行数据库迁移。</p>\n<ol>\n<li><strong>设置启动项目</strong>: 在 IDE 或命令行中，确保 <code>src/LinCms.Web</code> 是启动项目。</li>\n<li><strong>执行迁移</strong>:<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 进入 Web 项目目录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> src/LinCms.Web</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 执行数据库迁移 (如果表结构有变更)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --sync-structure</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># (可选) 初始化种子数据 (如果需要示例数据)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --init-db</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>或者直接运行 <code>src/LinCms.Web</code> 项目，启动时会自动执行迁移（如果配置了 <code>SyncStructure</code> 为 <code>true</code>）。</li>\n</ol>\n<h2>运行项目</h2>\n<h3>使用 IDE</h3>\n<ul>\n<li><strong>Visual Studio / Rider</strong>: 打开 <code>lin-cms-dotnetcore.sln</code> 解决方案文件，将 <code>LinCms.Web</code> 设置为启动项目，直接按 F5 或点击运行按钮。</li>\n<li><strong>VS Code</strong>: 打开项目根目录，确保已安装 C# 扩展。按 F5 启动调试，选择 <code>.NET Core Launch (web)</code> 配置。</li>\n</ul>\n<h3>使用命令行</h3>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 进入 Web 项目目录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> src/LinCms.Web</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 运行项目 (自动监听文件变化并重启)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> watch</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 或者直接运行</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># dotnet run</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>项目启动后，默认监听 <code>http://localhost:5000</code> 和 <code>https://localhost:5001</code>。</p>\n<p>你可以在浏览器中访问 <code>https://localhost:5001/swagger/index.html</code> 查看 API 文档。</p>\n<h2>下一步</h2>\n<ul>\n<li>查看 <a href=\"/igeekfan-docs/dotnetcore/lin-cms/project-structure.html\" target=\"_blank\">项目结构</a> 了解代码组织方式。</li>\n<li>浏览 <a href=\"/igeekfan-docs/dotnetcore/lin-cms/api-reference.html\" target=\"_blank\">API 参考</a> (Swagger)。</li>\n<li>学习如何 <a href=\"/igeekfan-docs/dotnetcore/lin-cms/deployment.html\" target=\"_blank\">部署项目</a>。</li>\n<li>查看 <a href=\"/igeekfan-docs/dotnetcore/lin-cms/faq.html\" target=\"_blank\">常见问题</a>。</li>\n</ul>\n",
      "date_published": "2025-04-28T17:00:03.000Z",
      "date_modified": "2025-04-28T17:01:11.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "贡献指南",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/contributing.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/contributing.html",
      "summary": "贡献指南 感谢你对 LinCMS.NET Core 项目的兴趣并考虑做出贡献！ 我们欢迎各种形式的贡献，包括但不限于： 报告 Bug 提交功能建议 编写或改进文档 提交代码 (Pull Requests) 如何贡献 详细的贡献指南通常位于项目的主代码仓库中。 后端仓库: https://github.com/luoyunchong/lin-cms-do...",
      "content_html": "\n<p>感谢你对 <a href=\"http://LinCMS.NET\" target=\"_blank\" rel=\"noopener noreferrer\">LinCMS.NET</a> Core 项目的兴趣并考虑做出贡献！</p>\n<p>我们欢迎各种形式的贡献，包括但不限于：</p>\n<ul>\n<li>报告 Bug</li>\n<li>提交功能建议</li>\n<li>编写或改进文档</li>\n<li>提交代码 (Pull Requests)</li>\n</ul>\n<h2>如何贡献</h2>\n<p>详细的贡献指南通常位于项目的主代码仓库中。</p>\n<ul>\n<li><strong>后端仓库</strong>: <a href=\"https://github.com/luoyunchong/lin-cms-dotnetcore\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/lin-cms-dotnetcore</a></li>\n<li><strong>前端仓库</strong>: <a href=\"https://github.com/luoyunchong/lin-cms-vue\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/lin-cms-vue</a></li>\n</ul>\n<p>请在相应仓库查找 <code>CONTRIBUTING.md</code> 文件 (如果存在) 或查阅 README 文件中的贡献部分，了解具体的流程、代码风格要求和行为准则。</p>\n<h2>报告问题</h2>\n<p>如果你发现了 Bug 或有功能建议，请通过相应仓库的 <a href=\"https://github.com/luoyunchong/lin-cms-dotnetcore/issues\" target=\"_blank\" rel=\"noopener noreferrer\">Issues</a> 页面提交。</p>\n<p>提交 Issue 时，请尽量提供详细的信息，例如：</p>\n<ul>\n<li>清晰的标题和描述。</li>\n<li>复现 Bug 的步骤。</li>\n<li>期望的行为和实际观察到的行为。</li>\n<li>相关截图或日志。</li>\n<li>你使用的环境信息 (操作系统, .NET 版本, Node.js 版本, 浏览器等)。</li>\n</ul>\n<h2>提交代码 (Pull Request)</h2>\n<ol>\n<li>Fork 目标仓库。</li>\n<li>基于最新的 <code>main</code> 或 <code>dev</code> 分支创建新的特性分支。</li>\n<li>进行代码修改，确保遵循项目的代码风格。</li>\n<li>(如果适用) 添加必要的单元测试或集成测试。</li>\n<li>确保所有测试通过。</li>\n<li>提交 Pull Request 到原始仓库的相应分支。</li>\n<li>在 PR 描述中清晰说明你的修改内容和目的，并关联相关的 Issue (如果存在)。</li>\n</ol>\n<p>我们期待你的贡献！</p>\n",
      "date_published": "2025-04-28T17:00:03.000Z",
      "date_modified": "2025-04-28T17:00:03.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "数据库表设计",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/database-design.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/database-design.html",
      "summary": "数据库表设计 LinCMS.NET Core 使用 FreeSql 的 CodeFirst 模式来定义和管理数据库表结构。实体类 (Entity) 定义在 src/LinCms.Core/Entities 目录下，按模块划分。 以下是核心模块的部分表结构说明： FreeSql.Repository 仓储层 FreeSql 提供了强大的仓储层实现，简化了...",
      "content_html": "\n<p><a href=\"http://LinCMS.NET\" target=\"_blank\" rel=\"noopener noreferrer\">LinCMS.NET</a> Core 使用 FreeSql 的 CodeFirst 模式来定义和管理数据库表结构。实体类 (Entity) 定义在 <code>src/LinCms.Core/Entities</code> 目录下，按模块划分。</p>\n<p>以下是核心模块的部分表结构说明：</p>\n<h2>FreeSql.Repository 仓储层</h2>\n<p>FreeSql 提供了强大的仓储层实现，简化了数据库操作。</p>\n<ul>\n<li><strong>IBaseRepository&lt;TEntity, TKey&gt;</strong>: 基础仓储接口，提供了常用的 CRUD 操作。</li>\n<li><strong>GuidRepository&lt;TEntity&gt;</strong>: 针对主键为 Guid 的实体提供的便捷仓储。</li>\n<li><strong>LongRepository&lt;TEntity&gt;</strong>: 针对主键为 long 的实体提供的便捷仓储。</li>\n</ul>\n<p>开发者可以通过依赖注入获取特定实体的仓储实例，例如：</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IBaseRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">_userRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> UserService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">IBaseRepository</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">&lt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">LinUser</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> userRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">    _userRepository</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> userRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetUserAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Guid</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> userId</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    return</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _userRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">u</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> u</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Id</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> userId</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToOneAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>核心表 (部分)</h2>\n<h3><code>lin_user</code> (用户信息表)</h3>\n<p>存储系统用户的基础信息。</p>\n<p>| 字段名        | 类型         | 说明                 |<br>\n|</p>\n",
      "date_published": "2025-04-28T17:00:03.000Z",
      "date_modified": "2025-04-28T17:00:03.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "部署指南",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/deployment.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/deployment.html",
      "summary": "部署指南 本文档介绍如何部署 LinCMS.NET Core 后端和 LinCMS Vue 2 前端项目。 概述 通常部署包含以下步骤： 环境准备: 安装必要的运行时和依赖 (如 .NET Runtime, ASP.NET Core Runtime, Node.js, Web 服务器, 数据库)。 构建/发布项目: 生成生产环境可用的文件。 配置: 配...",
      "content_html": "\n<p>本文档介绍如何部署 <a href=\"http://LinCMS.NET\" target=\"_blank\" rel=\"noopener noreferrer\">LinCMS.NET</a> Core 后端和 LinCMS Vue 2 前端项目。</p>\n<h2>概述</h2>\n<p>通常部署包含以下步骤：</p>\n<ol>\n<li><strong>环境准备</strong>: 安装必要的运行时和依赖 (如 .NET Runtime, <a href=\"http://ASP.NET\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET</a> Core Runtime, Node.js, Web 服务器, 数据库)。</li>\n<li><strong>构建/发布项目</strong>: 生成生产环境可用的文件。</li>\n<li><strong>配置</strong>: 配置数据库连接、API 地址、Web 服务器等。</li>\n<li><strong>部署文件</strong>: 将生成的文件复制到服务器。</li>\n<li><strong>运行与托管</strong>: 使用 Web 服务器 (如 Nginx, IIS) 或进程管理工具 (如 Systemd, Supervisor, Docker) 运行和托管应用。</li>\n</ol>\n<h2><a class=\"header-anchor\" href=\"#后端部署-lincms-net-core\"><span>后端部署 (</span></a><a href=\"http://LinCMS.NET\" target=\"_blank\" rel=\"noopener noreferrer\">LinCMS.NET</a> Core)</h2>\n<h3>1. 环境准备</h3>\n<ul>\n<li><strong>操作系统</strong>: Linux (推荐 CentOS, Ubuntu) 或 Windows Server。</li>\n<li><strong>.NET Runtime</strong>: 安装与项目匹配的 <a href=\"https://dotnet.microsoft.com/download/dotnet\" target=\"_blank\" rel=\"noopener noreferrer\">.NET Runtime</a> 和 <a href=\"https://dotnet.microsoft.com/download/dotnet/aspnetcore\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET Core Runtime</a>。</li>\n<li><strong>数据库</strong>: 安装和配置你选择的数据库 (MySQL, PostgreSQL, SQL Server, etc.)。</li>\n<li><strong>Web 服务器 (可选但推荐)</strong>: Nginx (Linux) 或 IIS (Windows)。</li>\n<li><strong>进程管理器 (Linux)</strong>: Systemd 或 Supervisor。</li>\n</ul>\n<h3>2. 发布项目</h3>\n<p>在你的开发机器或构建服务器上，进入后端项目根目录 (<code>lin-cms-dotnetcore</code>)，执行发布命令：</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 发布到 bin/Release/netX.0/publish 目录 (X 是 .NET 版本)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> publish</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> src/LinCms.Web/LinCms.Web.csproj</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -c</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Release</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -o</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> ./publish_output</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 如果需要指定运行时 (例如部署到不支持自包含部署的 Linux x64)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># dotnet publish src/LinCms.Web/LinCms.Web.csproj -c Release -r linux-x64 --self-contained false -o ./publish_output</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>这将生成包含所有依赖项的可执行文件和配置文件到 <code>publish_output</code> 目录。</p>\n<h3>3. 配置</h3>\n<ul>\n<li>将 <code>publish_output</code> 目录下的 <code>appsettings.json</code> 或创建 <code>appsettings.Production.json</code> 文件，修改其中的数据库连接字符串 (<code>ConnectionStrings</code>)、<code>DbType</code>、JWT 密钥 (<code>Jwt:SecretKey</code>)、文件存储路径 (<code>File:StoreDir</code>) 等生产环境配置。</li>\n<li><strong>确保 <code>ASPNETCORE_ENVIRONMENT</code> 环境变量在服务器上设置为 <code>Production</code></strong>，这样 <code>appsettings.Production.json</code> 才会生效。</li>\n</ul>\n<h3>4. 部署文件</h3>\n<p>将 <code>publish_output</code> 目录下的所有文件复制到服务器的目标部署目录 (例如 <code>/var/www/lincms-backend</code>)。</p>\n<h3>5. 运行与托管</h3>\n<p><strong>方式一: 使用 Nginx + Systemd (推荐用于 Linux)</strong></p>\n<ol>\n<li>\n<p><strong>创建 Systemd 服务单元文件</strong>: <code>/etc/systemd/system/lincms-backend.service</code></p>\n<div class=\"language-ini line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"ini\" data-title=\"ini\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">[Unit]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">Description</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#98C379\">LinCMS.NET Core Backend Service</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">After</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#98C379\">network.target</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">[Service]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">WorkingDirectory</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#98C379\">/var/www/lincms-backend </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 你的部署目录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">ExecStart</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#98C379\">/usr/bin/dotnet /var/www/lincms-backend/LinCms.Web.dll </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 确保 dotnet 路径正确</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">Restart</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#98C379\">always</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">RestartSec</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#98C379\">10 </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># Restart service after 10 seconds if dotnet service crashes</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">SyslogIdentifier</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#98C379\">lincms-backend</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">User</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#98C379\">www-data </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 建议使用非 root 用户运行</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">Environment</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">ASPNETCORE_ENVIRONMENT</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#98C379\">Production</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">Environment</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">DOTNET_PRINT_TELEMETRY_MESSAGE</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#98C379\">false</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">[Install]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">WantedBy</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#98C379\">multi-user.target</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></li>\n<li>\n<p><strong>启用并启动服务</strong>:</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> systemctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> enable</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-backend.service</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> systemctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> start</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-backend.service</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> systemctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> status</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-backend.service</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> # 查看状态</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></li>\n<li>\n<p><strong>配置 Nginx 反向代理</strong>: 编辑 Nginx 配置文件 (通常在 <code>/etc/nginx/sites-available/</code> 或 <code>/etc/nginx/conf.d/</code>)。</p>\n<div class=\"language-nginx line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"nginx\" data-title=\"nginx\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">server</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    listen </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">80</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    listen </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[::]:80;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    server_name </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">your_backend_domain.com; </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 替换为你的域名或 IP</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    # 可选：HTTP 到 HTTPS 跳转</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    # return 301 https://$host$request_uri;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    location</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> / </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        proxy_pass </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        http://localhost:5000; </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 指向你的 .NET Core 应用监听的地址和端口</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        proxy_http_version </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1.1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        proxy_set_header </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  Upgrade $</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">http_upgrade</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        proxy_set_header </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  Connection keep-alive;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        proxy_set_header </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  Host $</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">host</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        proxy_cache_bypass </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">$</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">http_upgrade</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        proxy_set_header </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  X-Forwarded-For $</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">proxy_add_x_forwarded_for</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        proxy_set_header </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  X-Forwarded-Proto $</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">scheme</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 如果启用了 HTTPS (需要 SSL 证书)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># server {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#     listen 443 ssl http2;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#     listen [::]:443 ssl http2;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#     server_name your_backend_domain.com;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#     ssl_certificate /path/to/your/fullchain.pem;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#     ssl_certificate_key /path/to/your/privkey.pem;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#     include /etc/nginx/snippets/ssl-params.conf; # 可选的 SSL 参数配置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#     location / {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#         proxy_pass         http://localhost:5000;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#         # ... 其他 proxy_set_header 同上 ...</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#     }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></li>\n<li>\n<p><strong>测试 Nginx 配置并重载</strong>:</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -t</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> systemctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> reload</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></li>\n</ol>\n<p><strong>方式二: 使用 Docker</strong></p>\n<ol>\n<li>\n<p><strong>创建 Dockerfile</strong>: 在后端项目根目录创建 <code>Dockerfile</code>。</p>\n<div class=\"language-dockerfile line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"dockerfile\" data-title=\"dockerfile\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">FROM</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> mcr.microsoft.com/dotnet/aspnet:6.0 </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">AS</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> base</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">WORKDIR</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /app</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">EXPOSE</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> 80</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">EXPOSE</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> 443</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">FROM</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> mcr.microsoft.com/dotnet/sdk:6.0 </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">AS</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> build</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">WORKDIR</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /src</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">COPY</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"src/LinCms.Web/LinCms.Web.csproj\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"src/LinCms.Web/\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">COPY</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"src/LinCms.Application/LinCms.Application.csproj\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"src/LinCms.Application/\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">COPY</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"src/LinCms.Application.Contracts/LinCms.Application.Contracts.csproj\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"src/LinCms.Application.Contracts/\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">COPY</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"src/LinCms.Infrastructure/LinCms.Infrastructure.csproj\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"src/LinCms.Infrastructure/\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">COPY</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"src/LinCms.Core/LinCms.Core.csproj\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"src/LinCms.Core/\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 根据你的项目结构调整 COPY 命令</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">RUN</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> dotnet restore </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"src/LinCms.Web/LinCms.Web.csproj\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">COPY</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> . .</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">WORKDIR</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"/src/src/LinCms.Web\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">RUN</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> dotnet build </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"LinCms.Web.csproj\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> -c Release -o /app/build</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">FROM</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> build </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">AS</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> publish</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">RUN</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> dotnet publish </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"LinCms.Web.csproj\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> -c Release -o /app/publish</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">FROM</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> base </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">AS</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> final</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">WORKDIR</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /app</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">COPY</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> --from=publish /app/publish .</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 确保 appsettings.Production.json 被包含或通过卷挂载</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">ENTRYPOINT</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"dotnet\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"LinCms.Web.dll\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></li>\n<li>\n<p><strong>构建 Docker 镜像</strong>:</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> build</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -t</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-backend:latest</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> .</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div></li>\n<li>\n<p><strong>运行 Docker 容器</strong>:</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 5000:80</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">       -e</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> ASPNETCORE_ENVIRONMENT=Production</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">       -v</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /path/on/host/appsettings.Production.json:/app/appsettings.Production.json</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">       # 可选：挂载文件存储目录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">       # -v /path/on/host/uploads:/app/uploads \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">       --name</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-backend-container</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">       lincms-backend:latest</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><em><code>-p 5000:80</code> 将容器的 80 端口映射到宿主机的 5000 端口。</em><br>\n<em><code>-v</code> 用于挂载生产配置文件和可能的持久化目录。</em></p>\n</li>\n<li>\n<p>(可选) 使用 Nginx 作为反向代理指向 Docker 容器暴露的端口 (如 5000)。</p>\n</li>\n</ol>\n<p><strong>方式三: 使用 IIS (Windows)</strong></p>\n<ol>\n<li>安装 <a href=\"https://dotnet.microsoft.com/download/dotnet/aspnetcore\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET Core Hosting Bundle</a>。</li>\n<li>在 IIS 管理器中创建新的网站。</li>\n<li>将物理路径指向你部署文件的目录。</li>\n<li>配置应用程序池的 .NET CLR 版本为 \"无托管代码\"。</li>\n<li>确保应用程序池用户具有部署目录的读取权限。</li>\n<li>配置绑定 (域名、IP、端口)。</li>\n</ol>\n<h2>前端部署 (LinCMS Vue 2)</h2>\n<p>前端项目是静态文件，需要部署到 Web 服务器上。</p>\n<h3>1. 环境准备</h3>\n<ul>\n<li><strong>Web 服务器</strong>: Nginx, Apache, IIS, 或其他可以托管静态文件的服务器。</li>\n<li><strong>Node.js 和 pnpm</strong>: 用于构建项目 (通常在开发或构建服务器上)。</li>\n</ul>\n<h3>2. 构建项目</h3>\n<p>在前端项目根目录 (<code>lin-cms-vue</code>) 执行构建命令：</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">pnpm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> build</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>这将生成静态文件到 <code>dist</code> 目录下。</p>\n<h3>3. 配置</h3>\n<ul>\n<li><strong>API 地址</strong>: 确保构建时使用的 <code>.env.production</code> 文件中的 <code>VITE_APP_BASE_URL</code> 指向你部署的后端 API 地址。</li>\n<li><strong>Web 服务器配置</strong>: 配置 Web 服务器以正确处理单页应用 (SPA) 的路由。</li>\n</ul>\n<h3>4. 部署文件</h3>\n<p>将 <code>dist</code> 目录下的所有文件复制到 Web 服务器的网站根目录或指定子目录 (例如 <code>/var/www/lincms-frontend</code>)。</p>\n<h3>5. 配置 Web 服务器 (Nginx 示例)</h3>\n<p>编辑 Nginx 配置文件，添加或修改 <code>server</code> 块：</p>\n<div class=\"language-nginx line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"nginx\" data-title=\"nginx\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">server</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    listen </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">80</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 或 443 (如果使用 HTTPS)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    server_name </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">your_frontend_domain.com; </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 替换为你的前端域名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    root </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">/var/www/lincms-frontend; </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 指向 dist 目录内容的位置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    index </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">index.html index.htm;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    # SSL 配置 (如果使用 HTTPS)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    # ssl_certificate /path/to/your/fullchain.pem;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    # ssl_certificate_key /path/to/your/privkey.pem;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    # include /etc/nginx/snippets/ssl-params.conf;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    location</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> / </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        try_files </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">$</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">uri</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> $</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">uri</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">/ /index.html;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        # try_files 指令是处理 SPA 路由的关键</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        # 它会尝试查找请求的文件或目录，如果找不到，则返回 /index.html</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    # 可选：配置 API 代理 (如果前端和后端部署在同一域名下不同路径)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    # location /api/ { # 假设 API 路径以 /api/ 开头</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    #     proxy_pass http://your_backend_domain.com; # 指向后端服务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    #     proxy_set_header Host $host;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    #     proxy_set_header X-Real-IP $remote_addr;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    #     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    #     proxy_set_header X-Forwarded-Proto $scheme;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    # }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    # 可选：配置 Gzip 压缩</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    gzip </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">on</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    gzip_vary </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">on</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    gzip_min_length </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1024</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    gzip_proxied </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">expired no-cache no-store private auth;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    gzip_types </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">text/plain text/css text/xml text/javascript application/x-javascript application/xml application/javascript application/json;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    gzip_disable </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"MSIE [1-6]\\.\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    # 可选：配置浏览器缓存</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    location</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> ~*</span><span style=\"--shiki-light:#032F62;--shiki-dark:#E06C75\"> \\.(?:css|js)$ </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        expires </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">1y;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        add_header </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">Cache-Control </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"public\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    location</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> ~*</span><span style=\"--shiki-light:#032F62;--shiki-dark:#E06C75\"> \\.(?:png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        expires </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1M</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        add_header </span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">Cache-Control </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"public\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><strong>关键配置</strong>: <code>try_files $uri $uri/ /index.html;</code> 确保了当用户直接访问或刷新非根路径 (如 <code>/user/list</code>) 时，Nginx 仍然返回 <code>index.html</code>，由前端 Vue Router 处理路由。</p>\n<p><strong>测试 Nginx 配置并重载</strong>:</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -t</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> systemctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> reload</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>自动化部署 (CI/CD)</h2>\n<p>考虑使用 GitHub Actions, GitLab CI, Jenkins 等工具实现自动化构建和部署流程，以提高效率和减少错误。</p>\n<ul>\n<li><strong>GitHub Actions 示例</strong>: 参考项目中的 <code>.github/workflows</code> 目录 (如果存在) 或查阅 <a href=\"https://docs.github.com/en/actions\" target=\"_blank\" rel=\"noopener noreferrer\">GitHub Actions 文档</a>。</li>\n<li><strong>文档站点部署脚本</strong>: 项目根目录下的 <a href=\"deploy.ps1\"><code>deploy.ps1</code></a> 是用于部署本文档站点的示例脚本。</li>\n</ul>\n",
      "date_published": "2025-04-28T17:00:03.000Z",
      "date_modified": "2025-04-28T17:00:03.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "开发指南示例：添加图书管理功能",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/development-guide.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/development-guide.html",
      "summary": "开发指南示例：添加图书管理功能 本指南将通过一个简单的示例——添加图书管理功能，来演示如何在 LinCMS.NET Core 项目中进行后端开发。 1. 定义实体 (Entity) 在 src/LinCms.Core/Entities 目录下创建一个新的实体类 Book.cs，用于映射数据库中的图书表。 2. 定义数据传输对象 (DTO) 在 src/...",
      "content_html": "\n<p>本指南将通过一个简单的示例——添加图书管理功能，来演示如何在 <a href=\"http://LinCMS.NET\" target=\"_blank\" rel=\"noopener noreferrer\">LinCMS.NET</a> Core 项目中进行后端开发。</p>\n<h2>1. 定义实体 (Entity)</h2>\n<p>在 <code>src/LinCms.Core/Entities</code> 目录下创建一个新的实体类 <code>Book.cs</code>，用于映射数据库中的图书表。</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// src/LinCms.Core/Entities/Book.cs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">DataAnnotations</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Core</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Entities</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Table</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">Name</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"book\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)] </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 指定数据库表名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Book</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FullAuditedEntity</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">long</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 继承 FullAuditedEntity 获取审计字段 (创建/修改时间/人, 删除标记)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Column</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">StringLength</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 50</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Title</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Column</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">StringLength</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 30</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Author</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Column</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">StringLength</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 1000</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Summary</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Column</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">StringLength</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 100</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Image</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // 可以在这里添加更多字段，如 PublishDate, ISBN 等</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>2. 定义数据传输对象 (DTO)</h2>\n<p>在 <code>src/LinCms.Application.Contracts/v1/Books</code> 目录下创建 DTO 文件。DTO 用于接口的数据输入和输出，避免直接暴露实体。</p>\n<p><strong><code>BookDto.cs</code> (输出 DTO):</strong></p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// src/LinCms.Application.Contracts/v1/Books/BookDto.cs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Contracts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">v1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Books</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> BookDto</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> long</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Title</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Author</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Summary</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Image</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> DateTime</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> CreateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><strong><code>CreateUpdateBookDto.cs</code> (输入 DTO):</strong></p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// src/LinCms.Application.Contracts/v1/Books/CreateUpdateBookDto.cs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ComponentModel</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">DataAnnotations</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Contracts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">v1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Books</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> CreateUpdateBookDto</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Required</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">ErrorMessage</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"必须传入图书标题\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">StringLength</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">50</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">ErrorMessage</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"图书标题长度不能超过50\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Title</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Required</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">ErrorMessage</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"必须传入图书作者\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">StringLength</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">30</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">ErrorMessage</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"图书作者长度不能超过30\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Author</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">StringLength</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1000</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">ErrorMessage</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"图书摘要长度不能超过1000\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Summary</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">StringLength</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">100</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">ErrorMessage</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"图书封面图片URL长度不能超过100\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Image</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><em>注意</em>: 我们使用了 <code>System.ComponentModel.DataAnnotations</code> 来进行基础的模型验证。更复杂的验证可以使用 FluentValidation。</p>\n<h2>3. 定义应用服务接口</h2>\n<p>在 <code>src/LinCms.Application.Contracts/v1/Books</code> 目录下定义图书服务的接口 <code>IBookService.cs</code>。</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// src/LinCms.Application.Contracts/v1/Books/IBookService.cs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Contracts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Base</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">BaseTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Contracts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Base</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Localizations</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Core</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Entities</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Threading</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Tasks</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Contracts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Base</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Contracts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">v1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Books</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> interface</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IBookService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ICrudAppService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">BookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">BookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">long</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">PageDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreateUpdateBookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreateUpdateBookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // ICrudAppService 已包含常用的 CRUD 方法声明:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // Task&lt;PagedResultDto&lt;BookDto&gt;&gt; GetListAsync(PageDto input);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // Task&lt;BookDto&gt; GetAsync(long id);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // Task&lt;BookDto&gt; CreateAsync(CreateUpdateBookDto createBookDto);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // Task&lt;BookDto&gt; UpdateAsync(long id, CreateUpdateBookDto updateBookDto);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // Task DeleteAsync(long id);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // 如果需要额外的业务方法，可以在这里添加声明</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // 例如: Task&lt;List&lt;BookDto&gt;&gt; GetBooksByAuthorAsync(string author);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><em>说明</em>: 我们继承了 <code>ICrudAppService</code>，它提供了标准的 CRUD 接口定义，简化了代码。泛型参数分别代表：列表输出 DTO、单个输出 DTO、主键类型、分页输入 DTO、创建输入 DTO、更新输入 DTO。</p>\n<h2>4. 实现应用服务</h2>\n<p>在 <code>src/LinCms.Application/v1/Books</code> 目录下创建图书服务的实现类 <code>BookService.cs</code>。</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// src/LinCms.Application/v1/Books/BookService.cs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AutoMapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 或者 Mapster</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Contracts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">v1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Books</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Core</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Entities</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Core</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Exceptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Core</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IRepositories</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Base</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 引入 CrudAppService</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Contracts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Base</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">BaseTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 引入 PageDto</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Contracts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Base</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 引入 ICrudAppService</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">v1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Books</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> BookService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CrudAppService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Book</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">BookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">BookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">long</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">PageDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreateUpdateBookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreateUpdateBookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IBookService</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IAuditBaseRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Book</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">long</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">_bookRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // 构造函数注入仓储和 Mapper</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> BookService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IAuditBaseRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Book</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">long</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">repository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IMapper</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            : </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\">base</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">repository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            _bookRepository</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> repository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // CrudAppService 已经实现了基础的 CRUD 方法</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // 如果需要覆盖或添加特定逻辑，可以在这里重写方法</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // 示例：覆盖 GetListAsync 添加自定义查询条件或排序</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // public override async Task&lt;PagedResultDto&lt;BookDto&gt;&gt; GetListAsync(PageDto input)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //     var (items, total) = await _bookRepository.Select</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //         .WhereIf(!string.IsNullOrEmpty(input.SearchText), b =&gt; b.Title.Contains(input.SearchText) || b.Author.Contains(input.SearchText)) // 假设 PageDto 有 SearchText 属性</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //         .OrderByDescending(b =&gt; b.CreateTime)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //         .ToPageListAsync(input.Page, input.Count);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //     var dtoList = Mapper.Map&lt;List&lt;BookDto&gt;&gt;(items);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //     return new PagedResultDto&lt;BookDto&gt;(total, dtoList);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // 示例：覆盖 CreateAsync 添加业务校验</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // public override async Task&lt;BookDto&gt; CreateAsync(CreateUpdateBookDto createBookDto)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //     // 检查是否存在同名书籍</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //     bool exist = await _bookRepository.Select.AnyAsync(b =&gt; b.Title == createBookDto.Title);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //     if (exist)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //     {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //         throw new LinCmsException($\"已存在标题为 {createBookDto.Title} 的图书\");</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //     }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //     return await base.CreateAsync(createBookDto);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // 如果在 IBookService 中添加了额外方法，在这里实现</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // public async Task&lt;List&lt;BookDto&gt;&gt; GetBooksByAuthorAsync(string author)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //     var books = await _bookRepository.Select.Where(b =&gt; b.Author == author).ToListAsync();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //     return Mapper.Map&lt;List&lt;BookDto&gt;&gt;(books);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><em>说明</em>:</p>\n<ul>\n<li>我们继承了 <code>CrudAppService</code>，它使用仓储和对象映射库 (AutoMapper/Mapster) 实现了 <code>ICrudAppService</code> 定义的大部分方法。</li>\n<li>通过构造函数注入了 <code>IAuditBaseRepository&lt;Book, long&gt;</code> (或 <code>IBaseRepository</code>) 和 <code>IMapper</code>。</li>\n<li>你可以根据需要重写基类的方法，添加自定义的查询、排序、验证或业务逻辑。</li>\n</ul>\n<h2>5. 配置对象映射 (AutoMapper / Mapster)</h2>\n<p>你需要配置实体 <code>Book</code> 和 DTO (<code>BookDto</code>, <code>CreateUpdateBookDto</code>) 之间的映射关系。</p>\n<p><strong>使用 AutoMapper:</strong><br>\n在 <code>src/LinCms.Application/AutoMapper/BookProfile.cs</code> (如果不存在则创建) 中添加映射配置：</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// src/LinCms.Application/AutoMapper/BookProfile.cs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AutoMapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Contracts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">v1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Books</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Core</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Entities</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AutoMapper</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> BookProfile</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Profile</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> BookProfile</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            // 创建映射: Book -&gt; BookDto</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">            CreateMap</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Book</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">BookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            // 创建映射: CreateUpdateBookDto -&gt; Book</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">            CreateMap</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreateUpdateBookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Book</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><em>确保这个 Profile 被添加到 AutoMapper 的配置中 (通常在 <code>Startup.cs</code> 或扩展方法里)</em>。</p>\n<p><strong>使用 Mapster:</strong><br>\nMapster 通常不需要显式配置简单映射，但如果需要自定义，可以在服务的配置阶段进行。</p>\n<h2>6. 创建控制器 (Controller)</h2>\n<p>在 <code>src/LinCms.Web/Controllers/v1</code> 目录下创建 <code>BookController.cs</code>，用于暴露 API 接口。</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// src/LinCms.Web/Controllers/v1/BookController.cs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Contracts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">v1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Books</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Core</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Aop</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// For LinCmsAuthorize</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Core</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Entities</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Microsoft</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AspNetCore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Mvc</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Threading</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Tasks</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Contracts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Base</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">BaseTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// For PageDto</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Application</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Contracts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Base</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// For ICrudAppService</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Web</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Controllers</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">v1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ApiExplorerSettings</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">GroupName</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"v1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)] </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// Swagger 分组</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Route</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"v1/book\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ApiController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"图书管理\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"图书\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)] </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 添加权限控制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> BookController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ControllerBase</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IBookService</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _bookService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> BookController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IBookService</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> bookService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            _bookService</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> bookService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"获取所有图书\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">PagedResultDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">BookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetListAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromQuery</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">PageDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> pageDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _bookService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetListAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">pageDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"{id}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"获取图书详情\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">BookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">long</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _bookService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpPost</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"新建图书\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">BookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromBody</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreateUpdateBookDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> createBookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _bookService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">createBookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpPut</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"{id}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"更新图书\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">BookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UpdateAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">long</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromBody</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreateUpdateBookDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> updateBookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _bookService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UpdateAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">updateBookDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpDelete</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"{id}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"删除图书\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> DeleteAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">long</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">            await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _bookService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">DeleteAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // 如果 IBookService 有额外方法，在这里添加对应的 Action</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // [HttpGet(\"author/{author}\")]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // [LinCmsAuthorize(\"按作者查询图书\")]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // public async Task&lt;List&lt;BookDto&gt;&gt; GetBooksByAuthorAsync(string author)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //     return await _bookService.GetBooksByAuthorAsync(author);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><em>说明</em>:</p>\n<ul>\n<li>使用 <code>[Route]</code> 定义路由前缀。</li>\n<li>使用 <code>[ApiController]</code> 启用 API 行为。</li>\n<li>使用 <code>[LinCmsAuthorize]</code> 特性来定义接口所需的权限。第一个参数是权限模块，第二个参数是权限名称。系统启动时会自动扫描这些特性并注册权限。</li>\n<li>通过构造函数注入 <code>IBookService</code>。</li>\n<li>每个 Action 方法对应一个 HTTP 谓词和路由，并调用相应的服务层方法。</li>\n<li><code>[FromQuery]</code> 和 <code>[FromBody]</code> 指定参数来源。</li>\n</ul>\n<h2>7. 数据库迁移</h2>\n<p>由于我们添加了新的实体 <code>Book</code>，需要更新数据库结构。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 进入 Web 项目目录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> src/LinCms.Web</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 执行</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>或者直接运行 Web 项目，如果配置了自动迁移，它会自动创建 <code>book</code> 表。</p>\n<h2>8. (可选) 添加权限到分组</h2>\n<ol>\n<li>运行项目，访问 Swagger UI (<code>/swagger</code>)。</li>\n<li>使用管理员账号登录前端界面。</li>\n<li>进入 <strong>管理员 -&gt; 权限管理</strong>。</li>\n<li>你应该能看到新添加的 \"图书管理\" 模块和其下的权限 (\"获取所有图书\", \"新建图书\" 等)。</li>\n<li>进入 <strong>管理员 -&gt; 分组管理</strong>。</li>\n<li>选择一个分组 (如 \"普通用户\" 或 \"管理员\")，点击 \"分配权限\"。</li>\n<li>在弹出的权限列表中勾选你想要分配给该分组的图书管理权限。</li>\n<li>保存。</li>\n</ol>\n<p>现在，属于该分组的用户就拥有了操作图书的相应权限。</p>\n<h2>总结</h2>\n<p>通过以上步骤，我们完成了一个简单的图书管理功能的后端开发，包括：</p>\n<ul>\n<li>定义数据库实体</li>\n<li>定义 DTO</li>\n<li>定义应用服务接口</li>\n<li>实现应用服务逻辑 (利用了 CrudAppService 基类)</li>\n<li>配置对象映射</li>\n<li>创建 API 控制器并添加权限控制</li>\n<li>更新数据库结构</li>\n<li>(可选) 在前端界面分配权限</li>\n</ul>\n<p>这个流程展示了 <a href=\"http://LinCMS.NET\" target=\"_blank\" rel=\"noopener noreferrer\">LinCMS.NET</a> Core 项目分层架构的基本开发模式。你可以基于此模式开发更复杂的业务功能。</p>\n",
      "date_published": "2025-04-28T17:00:03.000Z",
      "date_modified": "2025-04-28T17:00:03.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "常见问题解答 (FAQ)",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/faq.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/faq.html",
      "summary": "常见问题解答 (FAQ) 后端 (LinCMS.NET Core) Q1: 如何切换数据库类型？ A1: 修改 src/LinCms.Web/appsettings.json (或 appsettings.Production.json) 中的 ConnectionStrings 和 DbType 节点。例如，要切换到 MySQL，你需要： 提供 My...",
      "content_html": "\n<h2><a class=\"header-anchor\" href=\"#后端-lincms-net-core\"><span>后端 (</span></a><a href=\"http://LinCMS.NET\" target=\"_blank\" rel=\"noopener noreferrer\">LinCMS.NET</a> Core)</h2>\n<p><strong>Q1: 如何切换数据库类型？</strong></p>\n<p>A1: 修改 <code>src/LinCms.Web/appsettings.json</code> (或 <code>appsettings.Production.json</code>) 中的 <code>ConnectionStrings</code> 和 <code>DbType</code> 节点。例如，要切换到 MySQL，你需要：</p>\n<ol>\n<li>提供 MySQL 的连接字符串。</li>\n<li>将 <code>DbType</code> 的值改为 <code>MySql</code>。<br>\n详细配置请参考 <a href=\"/igeekfan-docs/dotnetcore/lin-cms/backend-quickstart.html#%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE\" target=\"_blank\">后端快速入门 - 数据库配置</a>。</li>\n</ol>\n<p>**Q2: 运行 <code>dotnet run</code></p>\n<p>A2:</p>\n<ul>\n<li>确保 <code>src/LinCms.Web</code> 是当前的启动项目。</li>\n<li>检查 <code>appsettings.json</code> 中的数据库连接字符串和 <code>DbType</code> 是否正确配置。</li>\n<li>确保数据库服务正在运行，并且网络连接正常。</li>\n<li>检查数据库用户是否具有创建/修改表结构以及插入数据的权限。</li>\n<li>查看控制台输出的详细错误信息，根据具体错误进行排查。</li>\n</ul>\n<p><strong>Q3: API 返回 401 Unauthorized？</strong></p>\n<p>A3:</p>\n<ul>\n<li>确认请求的 Header 中是否包含了有效的 <code>Authorization: Bearer &lt;your_token&gt;</code>。</li>\n<li>检查 Token 是否过期。</li>\n<li>确认 <code>appsettings.json</code> 中的 <code>Jwt:SecretKey</code> 配置与生成 Token 时使用的密钥一致。</li>\n<li>确认 <code>Jwt:Issuer</code> 和 <code>Jwt:Audience</code> 配置是否正确 (如果启用了验证)。</li>\n</ul>\n<p><strong>Q4: API 返回 403 Forbidden？</strong></p>\n<p>A4:</p>\n<ul>\n<li>表示用户已认证但没有访问该接口所需的权限。</li>\n<li>登录前端管理界面，检查当前用户所属的分组是否已被分配了访问该接口所需的权限。</li>\n<li>检查后端 Controller Action 上的 <code>[LinCmsAuthorize]</code> 特性定义的权限是否正确。</li>\n</ul>\n<p><strong>Q5: 如何添加新的权限？</strong></p>\n<p>A5:</p>\n<ol>\n<li>在需要权限控制的 Controller 或 Action 方法上添加 <code>[LinCmsAuthorize(\"模块名\", \"权限名\")]</code> 特性。</li>\n<li>重新启动后端服务，系统会自动扫描并注册新的权限。</li>\n<li>登录前端管理界面，在 \"管理员\" -&gt; \"权限管理\" 中可以看到新权限。</li>\n<li>在 \"管理员\" -&gt; \"分组管理\" 中，为相应的分组分配新权限。</li>\n</ol>\n<p><strong>Q6: 文件上传失败？</strong></p>\n<p>A6:</p>\n<ul>\n<li>检查 <code>appsettings.json</code> 中的 <code>File</code> 配置节点，特别是 <code>StoreDir</code> (存储目录) 是否存在且具有写入权限。</li>\n<li>检查 <code>SingleLimit</code> (单个文件大小限制) 和 <code>TotalLimit</code> (总大小限制) 是否足够。</li>\n<li>检查 Nginx 或其他反向代理是否配置了 <code>client_max_body_size</code> 以允许足够大的请求体。</li>\n</ul>\n<h2>前端 (LinCMS Vue 2)</h2>\n<p><strong>Q1: 运行 <code>pnpm run serve</code> 后无法访问页面？</strong></p>\n<p>A1:</p>\n<ul>\n<li>检查控制台输出，确认 Vite 开发服务器是否成功启动，并查看监听的端口号 (默认为 8080)。</li>\n<li>确保没有其他程序占用了该端口。</li>\n<li>检查防火墙设置是否允许访问该端口。</li>\n<li>清除浏览器缓存或尝试使用无痕模式访问。</li>\n</ul>\n<p><strong>Q2: 页面显示空白或报错？</strong></p>\n<p>A2:</p>\n<ul>\n<li>打开浏览器开发者工具 (按 F12)，查看控制台 (Console) 和网络 (Network) 选项卡。</li>\n<li><strong>控制台错误</strong>: 查看是否有 JavaScript 运行时错误，根据错误信息定位问题。</li>\n<li><strong>网络错误</strong>: 检查 API 请求是否成功 (状态码 2xx)。\n<ul>\n<li>如果 API 请求失败 (4xx, 5xx)，检查后端服务是否正常运行，API 地址 (<code>.env</code> 文件中的 <code>VITE_APP_BASE_URL</code>) 是否配置正确。</li>\n<li>如果 API 请求出现跨域错误 (CORS)，检查后端是否正确配置了跨域策略，或者在 <code>vite.config.ts</code> 中配置 <code>server.proxy</code> 进行开发环境代理。</li>\n</ul>\n</li>\n</ul>\n<p><strong>Q3: 登录失败？</strong></p>\n<p>A3:</p>\n<ul>\n<li>确认输入的用户名和密码是否正确 (默认管理员：super / 123456)。</li>\n<li>打开浏览器开发者工具，检查登录接口 (<code>/cms/user/login</code>) 的请求和响应。</li>\n<li>确认后端服务运行正常且前端配置的 API 地址正确。</li>\n</ul>\n<p><strong>Q4: 如何修改前端访问端口？</strong></p>\n<p>A4: 修改 <code>vite.config.ts</code> 文件中的 <code>server.port</code> 配置项。</p>\n<div class=\"language-typescript line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"typescript\" data-title=\"typescript\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// vite.config.ts</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">import</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">defineConfig</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> } </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">from</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 'vite'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">export</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> default</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> defineConfig</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">({</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  // ... 其他配置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">  server</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">    host</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">'0.0.0.0'</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 允许外部访问</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">    port</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">8081</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 修改为你想要的端口</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // proxy: { ... } // 代理配置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">})</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><strong>Q5: 如何配置开发环境的 API 代理以解决跨域问题？</strong></p>\n<p>A5: 修改 <code>vite.config.ts</code> 文件，配置 <code>server.proxy</code>。</p>\n<div class=\"language-typescript line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"typescript\" data-title=\"typescript\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// vite.config.ts</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">import</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">defineConfig</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> } </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">from</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 'vite'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">export</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> default</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> defineConfig</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">({</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  // ... 其他配置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">  server</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // ... 其他 server 配置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">    proxy</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">      // 字符串简写写法</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">      // '/foo': 'http://localhost:4567/foo',</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">      // 带选项写法：/api/user -&gt; http://localhost:5000/user</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">      '/api'</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        target</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">'http://localhost:5000'</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 你的后端 API 地址</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        changeOrigin</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">        rewrite</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: (</span><span style=\"--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">path</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> path</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">replace</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#E06C75\">/</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">^</span><span style=\"--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#56B6C2;--shiki-dark-font-weight:inherit\">\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#E06C75\">api/</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">''</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 可选：如果后端 API 没有 /api 前缀</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">      // ... 可以配置多个代理</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">})</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>配置代理后，前端代码中请求 API 时，可以直接写代理路径，例如请求 <code>/api/cms/user/info</code>，Vite 会将其代理到 <code>http://localhost:5000/cms/user/info</code>。</p>\n",
      "date_published": "2025-04-28T17:00:03.000Z",
      "date_modified": "2025-04-28T17:00:03.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "前端快速入门",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/frontend-quickstart.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/frontend-quickstart.html",
      "summary": "前端快速入门 本文档将指导你如何在本地运行 LinCMS Vue 2 前端项目。 环境要求 Node.js (建议使用 LTS 版本，如 16.x 或 18.x) pnpm (推荐的包管理器) 获取源码 安装依赖 配置 主要的配置文件是根目录下的 .env 系列文件： .env: 基础配置，所有环境都会加载。 .env.development: 开发环...",
      "content_html": "\n<p>本文档将指导你如何在本地运行 LinCMS Vue 2 前端项目。</p>\n<h2>环境要求</h2>\n<ul>\n<li><a href=\"https://nodejs.org/\" target=\"_blank\" rel=\"noopener noreferrer\">Node.js</a> (建议使用 LTS 版本，如 16.x 或 18.x)</li>\n<li><a href=\"https://pnpm.io/\" target=\"_blank\" rel=\"noopener noreferrer\">pnpm</a> (推荐的包管理器)</li>\n</ul>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 安装 pnpm (如果尚未安装)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">npm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> install</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -g</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> pnpm</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>获取源码</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">git</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> clone</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> https://github.com/luoyunchong/lin-cms-vue.git</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lin-cms-vue</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>安装依赖</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">pnpm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> install</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2>配置</h2>\n<p>主要的配置文件是根目录下的 <code>.env</code> 系列文件：</p>\n<ul>\n<li><code>.env</code>: 基础配置，所有环境都会加载。</li>\n<li><code>.env.development</code>: 开发环境配置。</li>\n<li><code>.env.production</code>: 生产环境配置。</li>\n</ul>\n<p><strong>关键配置项:</strong></p>\n<ul>\n<li><code>VITE_APP_BASE_URL</code>: 后端 API 的基础地址。在开发环境中，通常需要配置为你的本地后端服务地址，例如 <code>http://localhost:5000</code>。</li>\n<li><code>VITE_APP_TITLE</code>: 网站标题。</li>\n</ul>\n<p><strong>示例 <code>.env.development</code>:</strong></p>\n<div class=\"language-env line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"env\" data-title=\"env\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span># 开发环境配置</span></span>\n<span class=\"line\"><span>NODE_ENV = 'development'</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span># API 基础路径 (指向你的本地后端服务)</span></span>\n<span class=\"line\"><span>VITE_APP_BASE_URL = 'http://localhost:5000'</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span># 网站标题</span></span>\n<span class=\"line\"><span>VITE_APP_TITLE = 'Lin CMS Vue3 Dev'</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><strong>注意</strong>: 如果你的后端 API 部署在不同的域或端口，并且遇到了跨域问题，你可能需要在 <code>vite.config.ts</code> 中配置 <code>server.proxy</code> 来解决开发环境的跨域请求。</p>\n<h2>运行开发服务器</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">pnpm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> serve</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 或者</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">pnpm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> dev</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>此命令会启动一个本地开发服务器，通常监听在 <code>http://localhost:8080</code> (具体端口可在 <code>vite.config.ts</code> 中配置)。在浏览器中打开该地址即可访问前端页面。</p>\n<h2>项目结构 (简述)</h2>\n<p>前端代码主要位于 <code>src</code> 目录下：</p>\n<ul>\n<li><code>api/</code>: 存放 API 请求模块。</li>\n<li><code>assets/</code>: 存放静态资源，如图片、字体。</li>\n<li><code>components/</code>: 存放全局或可复用的 UI 组件。</li>\n<li><code>config/</code>: 存放项目配置，如网站设置、路由白名单等。</li>\n<li><code>directive/</code>: 存放自定义 Vue 指令。</li>\n<li><code>layout/</code>: 存放布局组件 (如基础布局、页面容器)。</li>\n<li><code>plugins/</code>: 存放 Vue 插件。</li>\n<li><code>router/</code>: 存放路由配置。</li>\n<li><code>store/</code>: 存放 Pinia 状态管理模块。</li>\n<li><code>styles/</code>: 存放全局样式和变量。</li>\n<li><code>utils/</code>: 存放工具函数。</li>\n<li><code>views/</code>: 存放页面级组件。</li>\n<li><code>App.vue</code>: 根组件。</li>\n<li><code>main.ts</code>: 应用入口文件。</li>\n</ul>\n<p>更详细的结构说明请参考 <a href=\"/igeekfan-docs/dotnetcore/lin-cms/project-structure.html\" target=\"_blank\">项目结构</a>。</p>\n<h2>构建项目</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">pnpm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> build</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>此命令会将项目打包到 <code>dist</code> 目录下，生成用于生产环境部署的静态文件。</p>\n<h2>下一步</h2>\n<ul>\n<li>查看 <a href=\"/igeekfan-docs/dotnetcore/lin-cms/project-structure.html\" target=\"_blank\">项目结构</a> 了解代码组织方式。</li>\n<li>学习如何 <a href=\"/igeekfan-docs/dotnetcore/lin-cms/deployment.html\" target=\"_blank\">部署项目</a>。</li>\n<li>查看 <a href=\"/igeekfan-docs/dotnetcore/lin-cms/faq.html\" target=\"_blank\">常见问题</a>。</li>\n</ul>\n",
      "date_published": "2025-04-28T17:00:03.000Z",
      "date_modified": "2025-04-28T17:00:03.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "项目结构",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/project-structure.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/project-structure.html",
      "summary": "项目结构 本文档介绍 LinCMS.NET Core (后端) 和 LinCMS Vue 2 (前端) 的项目结构。 后端 (lin-cms-dotnetcore) 后端项目遵循领域驱动设计 (DDD) 的分层思想，但进行了简化以适应 Web API 开发。 分层职责: Core: 定义核心业务规则、实体、仓储接口和领域事件。不依赖其他层。 Appli...",
      "content_html": "\n<p>本文档介绍 <a href=\"http://LinCMS.NET\" target=\"_blank\" rel=\"noopener noreferrer\">LinCMS.NET</a> Core (后端) 和 LinCMS Vue 2 (前端) 的项目结构。</p>\n<h2>后端 (lin-cms-dotnetcore)</h2>\n<p>后端项目遵循领域驱动设计 (DDD) 的分层思想，但进行了简化以适应 Web API 开发。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>lin-cms-dotnetcore/</span></span>\n<span class=\"line\"><span>├── src/</span></span>\n<span class=\"line\"><span>│   ├── LinCms.Application/             # 应用服务层 (Application Layer)</span></span>\n<span class=\"line\"><span>│   │   ├── v1/                         # API 版本 v1</span></span>\n<span class=\"line\"><span>│   │   │   ├── Books/                  # 示例：图书管理服务实现</span></span>\n<span class=\"line\"><span>│   │   │   ├── Files/                  # 文件服务实现</span></span>\n<span class=\"line\"><span>│   │   │   ├── Logs/                   # 日志服务实现</span></span>\n<span class=\"line\"><span>│   │   │   └── ...                     # 其他业务模块</span></span>\n<span class=\"line\"><span>│   │   ├── AutoMapper/                 # AutoMapper 配置</span></span>\n<span class=\"line\"><span>│   │   ├── Base/                       # 应用层基类 (如 CrudAppService)</span></span>\n<span class=\"line\"><span>│   │   └── LinCmsAppModule.cs          # 应用层模块定义 (Autofac)</span></span>\n<span class=\"line\"><span>│   │</span></span>\n<span class=\"line\"><span>│   ├── LinCms.Application.Contracts/   # 应用服务接口与DTO层 (Contracts Layer)</span></span>\n<span class=\"line\"><span>│   │   ├── v1/                         # API 版本 v1</span></span>\n<span class=\"line\"><span>│   │   │   ├── Books/                  # 示例：图书管理 DTO 和服务接口</span></span>\n<span class=\"line\"><span>│   │   │   └── ...                     # 其他业务模块接口和 DTO</span></span>\n<span class=\"line\"><span>│   │   ├── Base/                       # 基础 DTO 和接口 (分页, 结果等)</span></span>\n<span class=\"line\"><span>│   │   └── LinCmsApplicationContractsModule.cs # 契约层模块定义</span></span>\n<span class=\"line\"><span>│   │</span></span>\n<span class=\"line\"><span>│   ├── LinCms.Core/                    # 核心层 (Domain Layer)</span></span>\n<span class=\"line\"><span>│   │   ├── Aop/                        # AOP 相关 (如权限、日志切面)</span></span>\n<span class=\"line\"><span>│   │   ├── Common/                     # 通用常量、枚举等</span></span>\n<span class=\"line\"><span>│   │   ├── Entities/                   # 数据库实体定义</span></span>\n<span class=\"line\"><span>│   │   │   ├── Base/                   # 基础实体 (审计字段等)</span></span>\n<span class=\"line\"><span>│   │   │   └── ...                     # 各模块实体</span></span>\n<span class=\"line\"><span>│   │   ├── Exceptions/                 # 自定义异常</span></span>\n<span class=\"line\"><span>│   │   ├── Extensions/                 # 扩展方法</span></span>\n<span class=\"line\"><span>│   │   ├── IRenderers/                 # (特定功能，如模板渲染)</span></span>\n<span class=\"line\"><span>│   │   ├── IRepositories/              # 仓储接口定义</span></span>\n<span class=\"line\"><span>│   │   ├── Security/                   # 安全相关 (如 CurrentUser)</span></span>\n<span class=\"line\"><span>│   │   └── LinCmsCoreModule.cs         # 核心层模块定义</span></span>\n<span class=\"line\"><span>│   │</span></span>\n<span class=\"line\"><span>│   ├── LinCms.Infrastructure/          # 基础设施层 (Infrastructure Layer)</span></span>\n<span class=\"line\"><span>│   │   ├── Data/                       # FreeSql 配置、种子数据等</span></span>\n<span class=\"line\"><span>│   │   ├── Middleware/                 # 中间件</span></span>\n<span class=\"line\"><span>│   │   ├── Repositories/               # 仓储实现 (基于 FreeSql)</span></span>\n<span class=\"line\"><span>│   │   │   └── Base/                   # 基础仓储实现</span></span>\n<span class=\"line\"><span>│   │   └── LinCmsInfrastructureModule.cs # 基础设施层模块定义</span></span>\n<span class=\"line\"><span>│   │</span></span>\n<span class=\"line\"><span>│   ├── LinCms.Web/                     # Web API 层 (Presentation Layer)</span></span>\n<span class=\"line\"><span>│   │   ├── Controllers/                # API 控制器</span></span>\n<span class=\"line\"><span>│   │   │   ├── cms/                    # CMS 管理相关 API</span></span>\n<span class=\"line\"><span>│   │   │   └── v1/                     # 业务 API (版本 v1)</span></span>\n<span class=\"line\"><span>│   │   ├── Filter/                     # Web API 过滤器</span></span>\n<span class=\"line\"><span>│   │   ├── Middleware/                 # Web 中间件</span></span>\n<span class=\"line\"><span>│   │   ├── Models/                     # Web 层特定模型</span></span>\n<span class=\"line\"><span>│   │   ├── Services/                   # Web 层特定服务 (如启动配置)</span></span>\n<span class=\"line\"><span>│   │   ├── appsettings.json            # 配置文件</span></span>\n<span class=\"line\"><span>│   │   ├── lin-cms.db                  # Sqlite 数据库文件 (默认)</span></span>\n<span class=\"line\"><span>│   │   ├── Program.cs                  # 应用启动入口 (.NET 9+)</span></span>\n<span class=\"line\"><span>│   │   └── LinCmsWebModule.cs          # Web 层模块定义</span></span>\n<span class=\"line\"><span>│   │</span></span>\n<span class=\"line\"><span>│   └── LinCms.WorkerService/           # (可选) 后台任务服务</span></span>\n<span class=\"line\"><span>│</span></span>\n<span class=\"line\"><span>├── test/                               # 测试项目</span></span>\n<span class=\"line\"><span>│   └── LinCms.Test/                    # 单元测试/集成测试</span></span>\n<span class=\"line\"><span>│</span></span>\n<span class=\"line\"><span>└── lin-cms-dotnetcore.sln              # 解决方案文件</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><strong>分层职责:</strong></p>\n<ul>\n<li><strong>Core</strong>: 定义核心业务规则、实体、仓储接口和领域事件。不依赖其他层。</li>\n<li><strong>Application.Contracts</strong>: 定义应用服务的接口 (Interface) 和数据传输对象 (DTO)。用于层间解耦。</li>\n<li><strong>Application</strong>: 实现应用服务接口，编排领域逻辑，处理 DTO 与实体的转换。依赖 Core 和 Contracts。</li>\n<li><strong>Infrastructure</strong>: 提供具体的技术实现，如数据库访问 (仓储实现)、缓存、消息队列、第三方服务集成等。依赖 Core。</li>\n<li><strong>Web</strong>: 处理 HTTP 请求，调用应用服务，处理用户认证授权，配置 API 路由和过滤器。依赖 Application, Application.Contracts, Infrastructure。</li>\n</ul>\n<h2>前端 (lin-cms-vue)</h2>\n<p>前端项目使用 Vite 构建，基于 Vue 2 和 Element Plus。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>lin-cms-vue/</span></span>\n<span class=\"line\"><span>├── public/</span></span>\n<span class=\"line\"><span>│   └── favicon.ico             # 网站图标</span></span>\n<span class=\"line\"><span>├── src/</span></span>\n<span class=\"line\"><span>│   ├── api/                    # API 请求模块 (按业务划分)</span></span>\n<span class=\"line\"><span>│   ├── assets/                 # 静态资源 (图片, 字体等)</span></span>\n<span class=\"line\"><span>│   ├── components/             # 全局/可复用 UI 组件</span></span>\n<span class=\"line\"><span>│   │   ├── Lin/                # Lin CMS 风格的基础组件</span></span>\n<span class=\"line\"><span>│   │   └── ...</span></span>\n<span class=\"line\"><span>│   ├── config/                 # 项目配置 (网站设置, 路由白名单等)</span></span>\n<span class=\"line\"><span>│   ├── directive/              # 自定义 Vue 指令</span></span>\n<span class=\"line\"><span>│   ├── hooks/                  # Composition API Hooks</span></span>\n<span class=\"line\"><span>│   ├── layout/                 # 布局组件 (基础布局, 页面容器)</span></span>\n<span class=\"line\"><span>│   ├── plugins/                # Vue 插件 (Element Plus, Pinia 等)</span></span>\n<span class=\"line\"><span>│   ├── router/                 # Vue Router 配置 (路由表, 导航守卫)</span></span>\n<span class=\"line\"><span>│   ├── store/                  # Pinia 状态管理 (按模块划分)</span></span>\n<span class=\"line\"><span>│   ├── styles/                 # 全局样式, SCSS 变量, Mixins</span></span>\n<span class=\"line\"><span>│   ├── utils/                  # 工具函数 (请求封装, 日期处理等)</span></span>\n<span class=\"line\"><span>│   ├── views/                  # 页面级组件 (按路由/功能划分)</span></span>\n<span class=\"line\"><span>│   │   ├── about/</span></span>\n<span class=\"line\"><span>│   │   ├── admin/</span></span>\n<span class=\"line\"><span>│   │   ├── book/</span></span>\n<span class=\"line\"><span>│   │   └── ...</span></span>\n<span class=\"line\"><span>│   ├── App.vue                 # 根组件</span></span>\n<span class=\"line\"><span>│   ├── main.ts                 # 应用入口文件 (初始化 Vue, Router, Pinia)</span></span>\n<span class=\"line\"><span>│   └── vite-env.d.ts           # Vite 环境变量类型定义</span></span>\n<span class=\"line\"><span>├── tests/                    # 测试目录 (单元测试, E2E 测试)</span></span>\n<span class=\"line\"><span>├── .env                      # 基础环境变量</span></span>\n<span class=\"line\"><span>├── .env.development          # 开发环境变量</span></span>\n<span class=\"line\"><span>├── .env.production           # 生产环境变量</span></span>\n<span class=\"line\"><span>├── .eslintrc.js              # ESLint 配置</span></span>\n<span class=\"line\"><span>├── .gitignore                # Git 忽略配置</span></span>\n<span class=\"line\"><span>├── .prettierrc.js            # Prettier 配置</span></span>\n<span class=\"line\"><span>├── index.html                # HTML 入口文件</span></span>\n<span class=\"line\"><span>├── package.json              # 项目依赖和脚本</span></span>\n<span class=\"line\"><span>├── pnpm-lock.yaml            # pnpm 锁定文件</span></span>\n<span class=\"line\"><span>├── tsconfig.json             # TypeScript 配置</span></span>\n<span class=\"line\"><span>└── vite.config.ts            # Vite 配置文件 (构建, 代理, 插件)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><strong>主要目录职责:</strong></p>\n<ul>\n<li><strong><code>src/api</code></strong>: 封装对后端接口的调用。</li>\n<li><strong><code>src/components</code></strong>: 存放可以在多个页面复用的 UI 组件。</li>\n<li><strong><code>src/layout</code></strong>: 定义应用的基本页面结构，如包含导航栏、侧边栏的布局。</li>\n<li><strong><code>src/router</code></strong>: 配置页面路由和访问权限控制。</li>\n<li><strong><code>src/store</code></strong>: 使用 Pinia 管理全局或模块化的状态。</li>\n<li><strong><code>src/views</code></strong>: 存放与特定路由对应的页面组件。</li>\n<li><strong><code>src/styles</code></strong>: 定义全局 CSS 样式、变量和主题。</li>\n<li><strong><code>src/utils</code></strong>: 存放通用的辅助函数。</li>\n<li><strong><code>vite.config.ts</code></strong>: 配置开发服务器、构建选项、代理等。</li>\n<li><strong><code>.env*</code></strong>: 配置不同环境下的环境变量，如 API 地址。</li>\n</ul>\n",
      "date_published": "2025-04-28T17:00:03.000Z",
      "date_modified": "2025-04-28T17:01:11.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "技术栈",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/technology-stack.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/technology-stack.html",
      "summary": "技术栈 后端 (.NET Core) 开发框架: .NET 9 / .NET 7 ORM: FreeSql - 支持 CodeFirst 模式，灵活强大的国产 ORM。 数据库支持: MySQL (5.7+) PostgreSQL (12+) SQL Server (2012+) Sqlite3 (默认) Oracle Firebird ClickHo...",
      "content_html": "\n<h2>后端 (.NET Core)</h2>\n<ul>\n<li><strong>开发框架</strong>: <a href=\"https://dotnet.microsoft.com/zh-cn/download/dotnet/6.0\" target=\"_blank\" rel=\"noopener noreferrer\">.NET 9</a> / <a href=\"https://dotnet.microsoft.com/zh-cn/download/dotnet/7.0\" target=\"_blank\" rel=\"noopener noreferrer\">.NET 7</a></li>\n<li><strong>ORM</strong>: <a href=\"https://github.com/dotnetcore/FreeSql\" target=\"_blank\" rel=\"noopener noreferrer\">FreeSql</a> - 支持 CodeFirst 模式，灵活强大的国产 ORM。</li>\n<li><strong>数据库支持</strong>:\n<ul>\n<li>MySQL (5.7+)</li>\n<li>PostgreSQL (12+)</li>\n<li>SQL Server (2012+)</li>\n<li>Sqlite3 (默认)</li>\n<li>Oracle</li>\n<li>Firebird</li>\n<li>ClickHouse</li>\n<li>QuestDB</li>\n<li>... (更多请参考 FreeSql 文档)</li>\n</ul>\n</li>\n<li><strong>API 文档</strong>: <a href=\"https://github.com/domaindrivendev/Swashbuckle.AspNetCore\" target=\"_blank\" rel=\"noopener noreferrer\">Swagger (Swashbuckle.AspNetCore)</a> - 自动生成交互式 API 文档。</li>\n<li><strong>对象映射</strong>: <a href=\"https://github.com/MapsterMapper/Mapster\" target=\"_blank\" rel=\"noopener noreferrer\">Mapster</a> - 高性能的对象映射库。</li>\n<li><strong>日志</strong>: <a href=\"https://github.com/serilog/serilog\" target=\"_blank\" rel=\"noopener noreferrer\">Serilog</a> - 结构化日志框架。</li>\n<li><strong>身份认证</strong>: <a href=\"https://jwt.io/\" target=\"_blank\" rel=\"noopener noreferrer\">JWT (JSON Web Tokens)</a> - 用于 API 认证。</li>\n<li><strong>访问控制</strong>: 基于策略 (Policy-Based) 和角色 (Role-Based) 的授权。</li>\n<li><strong>缓存</strong>:\n<ul>\n<li><code>MemoryCache</code> (内存缓存)</li>\n<li><code>DistributedMemoryCache</code> (分布式内存缓存)</li>\n<li><code>Redis</code> (通过 <code>FreeRedis</code> 或 <code>StackExchange.Redis</code>)</li>\n</ul>\n</li>\n<li><strong>消息队列</strong>: <a href=\"https://www.rabbitmq.com/\" target=\"_blank\" rel=\"noopener noreferrer\">RabbitMQ</a> (通过 <code>RabbitMQ.Client</code>) - 可选，用于异步任务处理。</li>\n<li><strong>依赖注入</strong>: .NET Core 内建 DI 容器。</li>\n<li><strong>后台任务</strong>: <a href=\"https://docs.microsoft.com/zh-cn/dotnet/core/extensions/workers\" target=\"_blank\" rel=\"noopener noreferrer\">BackgroundService</a> / <a href=\"https://www.quartz-scheduler.net/\" target=\"_blank\" rel=\"noopener noreferrer\">Quartz.NET</a> (可选)</li>\n<li><strong>单元测试</strong>: <a href=\"https://xunit.net/\" target=\"_blank\" rel=\"noopener noreferrer\">xUnit</a> / <a href=\"https://nsubstitute.github.io/\" target=\"_blank\" rel=\"noopener noreferrer\">NSubstitute</a></li>\n<li><strong>代码校验</strong>: <a href=\"https://github.com/FluentValidation/FluentValidation\" target=\"_blank\" rel=\"noopener noreferrer\">FluentValidation</a> - 用于 DTO 模型验证。</li>\n<li><strong>跨域处理</strong>: .NET Core 内建 CORS 支持。</li>\n</ul>\n<h2>开发工具</h2>\n<ul>\n<li><strong>IDE</strong>:\n<ul>\n<li>Visual Studio 2022+ (推荐用于 .NET 开发)</li>\n<li>JetBrains Rider (跨平台 .NET IDE)</li>\n<li>Visual Studio Code (前端和 .NET Core 开发)</li>\n</ul>\n</li>\n<li><strong>数据库管理</strong>:\n<ul>\n<li>DBeaver</li>\n<li>Navicat</li>\n<li>pgAdmin (PostgreSQL)</li>\n<li>SQL Server Management Studio (SSMS)</li>\n</ul>\n</li>\n<li><strong>API 测试</strong>:\n<ul>\n<li>Postman</li>\n<li>Insomnia</li>\n<li>Swagger UI (内置)</li>\n</ul>\n</li>\n<li><strong>版本控制</strong>: Git</li>\n</ul>\n",
      "date_published": "2025-04-28T17:00:03.000Z",
      "date_modified": "2025-04-28T17:01:11.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Fluent Emoji MS",
      "url": "https://igeekfan.cn/igeekfan-docs/blogs/fluent-emoji-ms.html",
      "id": "https://igeekfan.cn/igeekfan-docs/blogs/fluent-emoji-ms.html",
      "summary": "Fluent Emoji MS 关于 Fluent Emoji Fluent Emoji MS Emoji 表情是风靡全球的表情包，通用性很强，包含大量的人物和食物等各种形象，俗称黄豆表情。随着 Windows 11 操作系统的新版本发布，微软对内置的 Emoji 表情进行更新，支持 3D 风格，看上去更加具有立体活泼感。微软宣布开源了这套表情包，让更...",
      "content_html": "\n<h2>关于 Fluent Emoji</h2>\n<p></p>\n<p>Emoji 表情是风靡全球的表情包，通用性很强，包含大量的人物和食物等各种形象，俗称黄豆表情。随着 Windows 11 操作系统的新版本发布，微软对内置的 Emoji 表情进行更新，支持 3D 风格，看上去更加具有立体活泼感。微软宣布开源了这套表情包，让更多的创作者可以使用 <code>Fluent Emoji</code></p>\n<h2>fluent-emoji-ms</h2>\n<p>它是一个Vue 3 组件库，集成了微软 Fluent UI 表情符号，提供易用的表情选择器组件，支持多种风格和丰富的自定义配置。</p>\n<h2>特性</h2>\n<ul>\n<li>🎨 三种表情风格：现代风格 (modern)、扁平风格 (flat) 和高对比度风格 (high-contrast)</li>\n<li>🔍 内置表情搜索功能</li>\n<li>📂 按分类浏览表情</li>\n<li>📱 响应式设计，适配不同屏幕尺寸</li>\n<li>⚙️ 高度可定制的界面和样式</li>\n<li>🧩 支持表情分类排序</li>\n<li>🔄 智能图片加载错误处理</li>\n<li>💡 轻量级设计，零依赖</li>\n</ul>\n<h2>示例</h2>\n<ul>\n<li><a href=\"https://igeekfan.github.io/fluent-emoji-ms/\" target=\"_blank\" rel=\"noopener noreferrer\">https://igeekfan.github.io/fluent-emoji-ms/</a></li>\n</ul>\n<p><br>\n<br>\n</p>\n<h2>安装</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># npm</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">npm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> install</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> fluent-emoji-ms</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># yarn</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">yarn</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> add</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> fluent-emoji-ms</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># pnpm</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">pnpm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> add</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> fluent-emoji-ms</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>快速开始</h2>\n<h3>导入和注册</h3>\n<div class=\"language-js line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"js\" data-title=\"js\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 方式1：直接导入组件</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">import</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">FluentEmojiPicker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> } </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">from</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 'fluent-emoji-ms'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">import</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 'fluent-emoji-ms/style.css'</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  // 别忘记导入样式！</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 方式2：全局注册</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">import</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">FluentEmojiPicker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> } </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">from</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 'fluent-emoji-ms'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">import</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 'fluent-emoji-ms/style.css'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">const</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\"> app</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> createApp</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">App</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">use</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">FluentEmojiMS</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mount</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">'#app'</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>基本使用</h3>\n<div class=\"language-vue line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"vue\" data-title=\"vue\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">template</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  &lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">div</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    &lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">FluentEmojiPicker</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> @select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"handleSelectEmoji\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    &lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">div</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> v-if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"selectedEmoji\"</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> class</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"selected-emoji-info\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      &lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">img</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">        :src</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"`https://cdn.jsdelivr.net/npm/fluentui-emoji@1.1.1/icons/${selectedEmoji.style}/${selectedEmoji.path}`\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">        width</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"32\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">        :alt</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"selectedEmoji.name\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      &lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">span</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;{{ selectedEmoji.name }}&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">span</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    &lt;/</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">div</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  &lt;/</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">div</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">template</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">script</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> setup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">import</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">ref</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> } </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">from</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 'vue'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">import</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">FluentEmojiPicker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> } </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">from</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 'fluent-emoji-ms'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">import</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 'fluent-emoji-ms/style.css'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">const</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\"> selectedEmoji</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ref</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">null</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">function</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> handleSelectEmoji</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">emoji</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">  selectedEmoji</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">value</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> emoji</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">  console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">log</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">'Selected emoji:'</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">emoji</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  // emoji 对象包含: { name, category, path, style }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">script</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>配置选项</h2>\n<h3>表情风格</h3>\n<p>支持三种不同的表情风格，可以通过 <code>initialStyle</code> 属性设置默认风格:</p>\n<div class=\"language-vue line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"vue\" data-title=\"vue\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">template</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  &lt;!-- 设置默认为扁平风格 --&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  &lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">FluentEmojiPicker</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> initialStyle</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"flat\"</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> @select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"handleSelectEmoji\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">template</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>可选风格:</p>\n<ul>\n<li><code>\"modern\"</code> - 现代风格（默认）</li>\n<li><code>\"flat\"</code> - 扁平风格</li>\n<li><code>\"high-contrast\"</code> - 高对比度风格</li>\n</ul>\n<h3>自定义按钮</h3>\n<div class=\"language-vue line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"vue\" data-title=\"vue\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">template</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  &lt;!-- 自定义按钮文本 --&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  &lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">FluentEmojiPicker</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> buttonText</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"插入表情\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /&gt;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  &lt;!-- 使用插槽自定义按钮 --&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  &lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">FluentEmojiPicker</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> @select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"handleSelectEmoji\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    &lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">button</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> class</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"custom-button\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;😊 选择表情&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">button</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  &lt;/</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">FluentEmojiPicker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">template</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>完整配置示例</h3>\n<div class=\"language-vue line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"vue\" data-title=\"vue\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">template</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  &lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">FluentEmojiPicker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">    :disabled</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"false\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">    initialStyle</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"modern\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">    defaultCategory</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"all\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">    buttonText</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"选择表情\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">    :baseUrl</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"cdnUrl\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">    :width</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"320\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">    :columns</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"6\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">    :categories</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"['smileys', 'people-body', 'animals-nature']\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">    :closeOnSelect</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"true\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">    :showSelectedEmoji</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"true\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">    :autoFill</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"true\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">    :emojiSize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"28\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">    @select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"handleSelectEmoji\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\">    @clear</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"handleClear\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">template</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">script</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> setup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">const</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\"> cdnUrl</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 'https://cdn.jsdelivr.net/npm/fluentui-emoji@1.1.1'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">script</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>API 参考</h2>\n<h3>FluentEmojiPicker</h3>\n<h4>Props</h4>\n<p>| 属性名 | 类型 | 默认值 | 描述 |<br>\n|</p>\n",
      "date_published": "2025-03-30T16:42:42.000Z",
      "date_modified": "2025-03-30T16:42:42.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Elasticsearch.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Elasticsearch.html",
      "summary": "拉取 Elasticsearch 镜像 启动 Elasticsearch 容器",
      "content_html": "<ul>\n<li>拉取 Elasticsearch 镜像</li>\n</ul>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> pull</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> docker.elastic.co/elasticsearch/elasticsearch:7.11.2</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><ul>\n<li>启动 Elasticsearch 容器</li>\n</ul>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-p </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">9200:9200</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--name </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">elasticsearch</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-p </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">9300:9300</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-d </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-e </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"discovery.type=single-node\"</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">docker.elastic.co/elasticsearch/elasticsearch:7.11.2</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2024-10-01T08:10:29.000Z",
      "date_modified": "2024-10-01T08:10:29.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Docker 国内镜像源/加速列表",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/DockerHub.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/DockerHub.html",
      "summary": "Docker 国内镜像源/加速列表 https://dockerproxy.cn https://dislabaiot.xyz https://ginger20240704.asia https://doublezonline.cloud",
      "content_html": "\n<ul>\n<li><a href=\"https://dockerproxy.cn\" target=\"_blank\" rel=\"noopener noreferrer\">https://dockerproxy.cn</a></li>\n<li><a href=\"https://dislabaiot.xyz\" target=\"_blank\" rel=\"noopener noreferrer\">https://dislabaiot.xyz</a></li>\n<li><a href=\"https://ginger20240704.asia\" target=\"_blank\" rel=\"noopener noreferrer\">https://ginger20240704.asia</a></li>\n<li><a href=\"https://doublezonline.cloud\" target=\"_blank\" rel=\"noopener noreferrer\">https://doublezonline.cloud</a></li>\n</ul>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mkdir</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/docker</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> tee</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/docker/daemon.json</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> &lt;&lt;</span><span style=\"--shiki-light:#032F62;--shiki-dark:#ABB2BF\">EOF</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">    \"registry-mirrors\": [</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">        \"https://hub.uuuadc.top\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">        \"https://docker.anyhub.us.kg\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">        \"https://dockerhub.jobcher.com\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">        \"https://dockerhub.icu\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">        \"https://docker.ckyl.me\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">        \"https://docker.awsl9527.cn\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">    ]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">sudo systemctl daemon-reload</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">sudo systemctl restart docker</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2024-10-01T08:10:29.000Z",
      "date_modified": "2024-10-01T08:10:29.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "HuggingFace 安装本地模型",
      "url": "https://igeekfan.cn/igeekfan-docs/ai/HuggingFace.html",
      "id": "https://igeekfan.cn/igeekfan-docs/ai/HuggingFace.html",
      "summary": "HuggingFace 安装本地模型 https://hf-mirror.com/ 镜像站点 https://huggingface.co 官网 https://huggingface.co/shenzhi-wang/Llama3-8B-Chinese-Chat 支持中文的 Llama3-8B 模型 安装相关依赖 设置环境变量 HF_ENDPOINT:...",
      "content_html": "\n<ul>\n<li><a href=\"https://hf-mirror.com/\" target=\"_blank\" rel=\"noopener noreferrer\">https://hf-mirror.com/</a> 镜像站点</li>\n<li><a href=\"https://huggingface.co\" target=\"_blank\" rel=\"noopener noreferrer\">https://huggingface.co</a> 官网</li>\n<li><a href=\"https://huggingface.co/shenzhi-wang/Llama3-8B-Chinese-Chat\" target=\"_blank\" rel=\"noopener noreferrer\">https://huggingface.co/shenzhi-wang/Llama3-8B-Chinese-Chat</a> 支持中文的 Llama3-8B 模型</li>\n</ul>\n<ol>\n<li>安装相关依赖</li>\n</ol>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">pip</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> install</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -U</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> huggingface_hub</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><ol start=\"2\">\n<li>设置环境变量</li>\n</ol>\n<ul>\n<li>HF_ENDPOINT: 设置为 <a href=\"https://hf-mirror.com\" target=\"_blank\" rel=\"noopener noreferrer\">https://hf-mirror.com</a> 解决下载速度慢的问题</li>\n<li>HF_HOME: 设置为本地目录（如 E:\\data\\huggingface） 解决安装目录默认 C 盘，会导致磁盘空间不足的问题</li>\n</ul>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">export</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> HF_ENDPOINT</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">https</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">://</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">hf-mirror</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">export</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> HF_HOME</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">/</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">var</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">/</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">huggingface</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ol start=\"3\">\n<li>安装 Llama3-8B-Chinese-Chat 模型</li>\n</ol>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">huggingface-cli</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> download</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --resume-download</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --local-dir-use-symlinks</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> False</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> shenzhi-wang/Llama3-8B-Chinese-Chat</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div>",
      "date_published": "2024-07-10T15:03:54.000Z",
      "date_modified": "2024-07-10T15:03:54.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "ASP.NET Core+Supervisord部署至Ubuntu",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/ASPNETCore-Supervisord-Ubuntu.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/ASPNETCore-Supervisord-Ubuntu.html",
      "summary": "ASP.NET Core+Supervisord部署至Ubuntu ASP.NET Core+Supervisord部署至Ubuntu asp.netcore中内置了kestrel,如果不通过代理工具，如IIS，Nginx,Apache，HTTP请求内容如下 前提条件 ubuntu服务器 安装nginx 服务器已安装.net sdk 6 安装守护进程 ...",
      "content_html": "\n<h1><a class=\"header-anchor\" href=\"#asp-net-core-supervisord部署至ubuntu-1\"><span></span></a><a href=\"http://ASP.NET\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET</a> Core+Supervisord部署至Ubuntu</h1>\n<p>asp.netcore中内置了kestrel,如果不通过代理工具，如IIS，Nginx,Apache，HTTP请求内容如下</p>\n<h2>前提条件</h2>\n<ul>\n<li>ubuntu服务器</li>\n<li>安装nginx</li>\n<li><a href=\"http://xn--zfru1gtwfryc62q5j3c.net\" target=\"_blank\" rel=\"noopener noreferrer\">服务器已安装.net</a> sdk 6</li>\n<li>安装守护进程 supervisor</li>\n</ul>\n<h2>supervisor 守护进程</h2>\n<ul>\n<li>官网 <a href=\"http://supervisord.org/\" target=\"_blank\" rel=\"noopener noreferrer\">http://supervisord.org/</a></li>\n</ul>\n<p>什么是守护进程</p>\n<p>守护进程(Daemon)是一个运行在后台的特殊进程，它独立于终端，并且以周期性地执行某些任务,在linux中，由于在linux中，每个系统与用户进行交流的界面称为终端，每一个从此终端开始运行的进程都会依附于这个终端，这个终端被称为这些进程的控制终端，当控制终端被关闭的时候，相应的进程都会自动关闭。但是守护进程却能突破这种限制，它脱离于终端并且在后台运行，并且它脱离终端的目的是为了避免进程在运行的过程中的信息在任何终端中显示并且进程也不会被任何终端所产生的终端信息所打断。它从被执行的时候开始运转，直到整个系统关闭才退出。在 Linux 上有很多可以管理进程的工具，我们使用 Supervisor 来做这个事情。</p>\n<p>为什么部署asp.netcore项目需要一个守护进程</p>\n<p>因为asp.netcore项目部署后，服务器可能存在关机，断开终端，无法保证web程序自启动。</p>\n<h2>Ubuntu安装supervisor</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> apt-get</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> install</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> supervisor</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  # 安装 守护进程 supervisor</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/supervisor/conf.d/</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">     # 进入配置目录 </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">vim</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> devops_api.conf</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        # 新建 一个配置文件 ，只要以 .conf结尾即可。</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>配置devops_api.conf</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[program:devops_api]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">command</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">dotnet</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> DevOps.Api.dll</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --urls=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"http://*:7000\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">directory</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/home/igeekfan/code/devops_api</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">environment</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">ASPNETCORE__ENVIRONMENT</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">Production</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">user</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">www-data</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">stopsignal</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">INT</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">autostart</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">autorestart</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">startsecs</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">stderr_logfile</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/home/igeekfan/code/devops_api/DevOps_Api.err.log</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">stdout_logfile</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/home/igeekfan/code/devops_api/DevOps_Api.out.log</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>把linux的发布包放到了/home/igeekfan/code/devops_api目录中</p>\n<p>有相应注释的，conf不能有注释，虽然没有任何异常，但无法启动服务。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[program:devops_api]##程序名称，终端控制时需要的标识</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">command</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">dotnet</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> DevOps.Api.dll</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --urls=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"http://*:7000\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  #要执行的命令</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">directory</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/home/igeekfan/code/devops_api</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> #命令执行的目录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">environment</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">ASPNETCORE__ENVIRONMENT</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">Production</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> #环境变量</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">user</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">www-data</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  #进程执行的用户身份</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">stopsignal</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">INT</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">autostart</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">true</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> #是否自动启动</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">autorestart</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">true</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> #是否自动重启</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">startsecs</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">1</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> #自动重启间隔</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">stderr_logfile</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/home/igeekfan/code/devops_api/DevOps_Api.err.log</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> #标准错误日志</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">stdout_logfile</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/home/igeekfan/code/devops_api/DevOps_Api.out.log</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> #标准输出日志</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>重启守护进程</h3>\n<p>（重新发布后，或服务崩溃后）</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#重启守护进程</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/init.d/supervisor</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> restart</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> service</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> supervisor</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> restart</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 暂停服务supervisor</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> service</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> supervisor</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> stop</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 启动服务supervisor</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> service</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> supervisor</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> start</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>supervisorctl 常用的相关命令</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 查看所有任务状态</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">supervisorctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> status</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 关闭所有任务 </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">supervisorctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> shutdown</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#重启指定应用</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">supervisorctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> restart</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> &lt;</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">application</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nam</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">e</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#停止指定应用</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">supervisorctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> stop</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> &lt;</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">application</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nam</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">e</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#启动指定应用</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">supervisorctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> start</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> &lt;</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">application</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nam</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">e</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#重启所有应用</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">supervisorctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> restart</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> all</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#停止所有应用</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">supervisorctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> stop</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> all</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#启动所有应用</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">supervisorctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> start</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> all</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 修改配置文件可用</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> supervisorctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">  reload</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>查看日志</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 查看日志</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">tail</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -f</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">  /home/igeekfan/code/devops_api/DevOps_Api.err.log</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>查看devops_api进程</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ps</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -ef</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> |</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> grep</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> devops_api</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">www-data</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">    38</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">    31</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">  0</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 02:57</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> ?</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">        00:00:00</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /home/igeekfan/code/devops_api/DevOps.Api.dll</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --urls=http://</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">*</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">:7000</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">igeekfan</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">   124</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">     9</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">  0</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 03:00</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> pts/0</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">    00:00:00</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> grep</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --color=auto</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> devops_api</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>supervisor设置开机</h2>\n<p>设置<code>ubuntu</code>下的supervisor开机 自启动</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> vim</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/rc.local</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>在exit 0 之前加入以下命令</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">/usr/local/bin/supervisord</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2>Supervisor UI 管理台</h2>\n<p>Supervisor 默认给我们提供了一个图形界面来供我们管理进程和任务，linux下需要我们手动开启</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> vim</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/supervisor/supervisord.conf</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>增加配置,我们就能直接访问localhost:7002</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[inet_http_server]</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">port</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">0.0.0.0:</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">7002username</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">userpassword</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">123</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>如果有防火墙</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">firewall-cmd</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --zone=public</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --add-port=7002/tcp</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --permanent</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">firewall-cmd</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --reload</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>Nginx反向代理</h2>\n<p>一般情况下，我们建议使用nginx进行代理</p>\n<p></p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> apt-get</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> install</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>安装好以后，定位到 /etc/nginx/sites-available/default 文件。更改server 节点如下</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">server</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">    listen</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 80</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">    location</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">        proxy_pass</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> http://localhost:7000</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">        proxy_http_version</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 1.1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">        proxy_set_header</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Upgrade</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> $http_upgrade</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">        proxy_set_header</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Connection</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> keep-alive</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">        proxy_set_header</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Host</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> $host</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">        proxy_cache_bypass</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> $http_upgrade</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>然后重新启动 Nginx</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> service</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> restart</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -s</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> reload　</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  #也可以使用这条命令重新加载配置项</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2024-01-05T14:23:40.000Z",
      "date_modified": "2024-01-05T14:28:28.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "ASP.NET Core+Systemd部署至Ubuntu",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/ASPNETCore-Systemd-Ubuntu.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/ASPNETCore-Systemd-Ubuntu.html",
      "summary": "ASP.NET Core+Systemd部署至Ubuntu Systemd部署至Ubuntu 本指南介绍如何在 Ubuntu 16.04 服务器上设置生产就绪 ASP.NET Core 环境。 这些说明可能适用于较新版本的 Ubunt 对于 Ubuntu 14.04，建议使用 supervisord 作为监视 Kestrel 进程的解决方案。 syst...",
      "content_html": "\n<h1>Systemd部署至Ubuntu</h1>\n<p>本指南介绍如何在 Ubuntu 16.04 服务器上设置生产就绪 <a href=\"http://asp.net/\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET</a> Core 环境。 这些说明可能适用于较新版本的 Ubunt</p>\n<blockquote>\n<p>对于 Ubuntu 14.04，建议使用 supervisord 作为监视 Kestrel 进程的解决方案。 systemd 不适用于 Ubuntu 14.04。</p>\n</blockquote>\n<p>有关 Ubuntu 14.04 的说明，请参阅<a href=\"https://github.com/dotnet/AspNetCore.Docs/blob/e9c1419175c4dd7e152df3746ba1df5935aaafd5/aspnetcore/publishing/linuxproduction.md\" target=\"_blank\" rel=\"noopener noreferrer\">本主题的以前版本</a>。</p>\n<h2>下载源码</h2>\n<p>部署devops/Devops.Api.csproj，打包，将所有文件上传至linux的 <code>/var/www/devops_api</code> 目录中</p>\n<p><a href=\"https://github.com/luoyunchong/devops\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/devops</a></p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> e:/code:/devops/DevOps.Api</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> publish</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --configuration</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Release</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>Systemd</h2>\n<p>服务器设置为将对 <code>http://&lt;serveraddress&gt;:80</code> 发起的请求转发到在 <code>http://127.0.0.1:5000</code> 中的 Kestrel 上运行的 <a href=\"http://asp.net/\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET</a> Core 应用。 但是，未将 Nginx 设置为管理 Kestrel 进程。 <code>systemd</code> 可用于创建服务文件以启动和监视基础 Web 应用。 <code>systemd</code> 是一个初始系统，可以提供启动、停止和管理进程的许多强大的功能。</p>\n<p>创建服务定义文件：</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> vim</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/systemd/system/kestrel-devops-api.service</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>下示例是应用的一个 <code>.ini</code> 服务文件：</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[Unit]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Description</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">Example</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> .NET</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Web</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> API</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> App</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> running</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> on</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Ubuntu</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">After</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">network.target</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[Service]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">WorkingDirectory</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/var/www/devops_api</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">ExecStart</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/usr/bin/dotnet</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> /var/www/devops_api/DevOps.Api.dll</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --urls=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"http://*:7000\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Restart</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">always</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># Restart service after 10 seconds if the dotnet service crashes:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">RestartSec</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">10</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">KillSignal</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">SIGINT</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">SyslogIdentifier</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">devops-api</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">User</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">www-data</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Environment</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">ASPNETCORE_ENVIRONMENT</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">Production</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Environment</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">DOTNET_PRINT_TELEMETRY_MESSAGE</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">false</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[Install]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">WantedBy</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">multi-user.target</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>在前面的示例中，管理服务的用户由 <code>User</code> 选项指定。 用户 (<code>www-data</code>) 必须存在并且拥有正确应用文件的所有权。</p>\n<p>使用 <code>TimeoutStopSec</code> 配置在收到初始中断信号后等待应用程序关闭的持续时间。 如果应用程序在此时间段内未关闭，则将发出 SIGKILL 以终止该应用程序。 提供作为无单位秒数的值（例如，<code>150</code>）、时间跨度值（例如，<code>2min 30s</code>）或 <code>infinity</code> 以禁用超时。 <code>TimeoutStopSec</code> 默认为管理器配置文件 (<code>systemd-system.conf</code>, <code>system.conf.d</code>, <code>systemd-user.conf</code>, <code>user.conf.d</code>) 中 <code>DefaultTimeoutStopSec</code> 的值。 大多数分发版的默认超时时间为 90 秒。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># The default value is 90 seconds for most distributions.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">TimeoutStopSec</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">90</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>Linux 具有区分大小写的文件系统。 将 <code>ASPNETCORE_ENVIRONMENT</code> 设置为 <code>Production</code> 时，将搜索配置文件 <code>appsettings.Production.json</code>，而不搜索 <code>appsettings.production.json</code>。</p>\n<p>必须转义某些值（例如，SQL 连接字符串）以供配置提供程序读取环境变量。 使用以下命令生成适当的转义值以供在配置文件中使用：</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">systemd-escape</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"&lt;value-to-escape&gt;\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>环境变量名不支持冒号 (<code>:</code>) 分隔符。 使用双下划线 (<code>__</code>) 代替冒号。 环境变量读入配置时，<a href=\"https://docs.microsoft.com/zh-cn/aspnet/core/fundamentals/configuration/?view=aspnetcore-6.0#environment-variables\" target=\"_blank\" rel=\"noopener noreferrer\">环境变量配置提供程序</a>将双下划线转换为冒号。 以下示例中，连接字符串密钥 <code>ConnectionStrings:DefaultConnection</code> 以 <code>ConnectionStrings__DefaultConnection</code> 形式设置到服务定义文件中：</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Environment</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">ConnectionStrings__DefaultConnection</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Connection</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> String}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p><code>After=network.target</code> 是systemd服务单元文件中的一个设置，它指定了服务单元应该在哪个系统目标（target）之后启动。在这种情况下，<code>network.target</code> 指的是网络服务的启动。这个设置确保了在网络服务启动之后，才会启动你的服务单元。这是因为在某些情况下，你的服务可能需要依赖于网络服务。这个设置可以确保你的服务在网络服务可用时启动，避免了启动服务时出现问题的可能性。</p>\n<p>保存该文件并启用该服务。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> systemctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> enable</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> kestrel-devops-api.service</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>启用该服务，并确认它正在运行</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> systemctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> start</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> kestrel-devops-api.service</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> systemctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> status</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> kestrel-devops-api.service</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> systemctl</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> stop</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> kestrel-devops-api.service</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">●</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> kestrel-devops-api.service</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> -</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Example</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> .NET</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Web</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> API</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> App</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> running</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> on</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Ubuntu</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">     Loaded:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> loaded</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (/etc/systemd/system/kestrel-devops-api.service; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">enabled</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">vendor</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> preset:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> enabled</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">     Active:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> active</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (running) since Sun 2022-06-12 01:41:00 CST; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">2min</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 2s</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> ago</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">   Main</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> PID:</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 2395006</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (dotnet)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">      Tasks:</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 14</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (limit: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">4612</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">     Memory:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 26.8M</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">     CGroup:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /system.slice/kestrel-devops-api.service</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">             └─2395006</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /usr/bin/dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /var/www/devops_api/DevOps.Api.dll</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --urls=http://</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">*</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">:7000</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Jun</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 12</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 01:41:00</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> hecs-x-large-2-linux-20200616150407</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> dotnet-example[2395006]:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> info:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Microsoft.Hosting.Lifetime[14]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Jun</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 12</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 01:41:00</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> hecs-x-large-2-linux-20200616150407</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> dotnet-example[2395006]:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">       Now</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> listening</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> on:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> http://[::]:7000</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Jun</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 12</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 01:41:00</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> hecs-x-large-2-linux-20200616150407</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> dotnet-example[2395006]:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> info:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Microsoft.Hosting.Lifetime[0]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Jun</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 12</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 01:41:00</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> hecs-x-large-2-linux-20200616150407</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> dotnet-example[2395006]:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">       Application</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> started.</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Press</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Ctrl+C</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> to</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> shut</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> down.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Jun</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 12</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 01:41:00</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> hecs-x-large-2-linux-20200616150407</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> dotnet-example[2395006]:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> info:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Microsoft.Hosting.Lifetime[0]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Jun</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 12</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 01:41:00</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> hecs-x-large-2-linux-20200616150407</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> dotnet-example[2395006]:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">       Hosting</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> environment:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Production</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Jun</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 12</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 01:41:00</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> hecs-x-large-2-linux-20200616150407</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> dotnet-example[2395006]:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> info:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Microsoft.Hosting.Lifetime[0]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Jun</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 12</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 01:41:00</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> hecs-x-large-2-linux-20200616150407</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> dotnet-example[2395006]:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">       Content</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> root</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> path:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /var/www/devops_api/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Jun</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 12</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 01:41:12</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> hecs-x-large-2-linux-20200616150407</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> dotnet-example[2395006]:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> warn:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware[3]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Jun</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 12</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 01:41:12</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> hecs-x-large-2-linux-20200616150407</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> dotnet-example[2395006]:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">       Failed</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> to</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> determine</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> the</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> https</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> port</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> for</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> redirect.</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>查看日志</h2>\n<p>使用 Kestrel 的 Web 应用是通过 <code>systemd</code> 进行管理的，因此所有事件和进程都被记录到集中日志。 但是，此日志包含由 <code>systemd</code> 管理的所有服务和进程的全部条目。 若要查看特定于 <code>kestrel-helloapp.service</code> 的项，请使用以下命令：</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> journalctl</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -fu</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> kestrel-devops-api.service</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>有关进一步筛选，使用时间选项（如 <code>--since today</code>、<code>--until 1 hour ago</code>）或这些选项的组合可以减少返回的条目数。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> journalctl</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -fu</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> kestrel-devops-api.service</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --since</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"2016-10-18\"</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --until</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"2016-10-18 04:00\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p><a href=\"https://docs.microsoft.com/zh-cn/aspnet/core/host-and-deploy/linux-nginx?view=aspnetcore-6.0\" target=\"_blank\" rel=\"noopener noreferrer\">使用 Nginx 在 Linux 上托管 ASP.NET Core | Microsoft Docs</a></p>\n<p><a href=\"https://github.com/luoyunchong/devops\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/devops</a></p>\n",
      "date_published": "2024-01-05T14:23:40.000Z",
      "date_modified": "2024-01-05T14:23:40.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "ASP.NET Core+Docker+AliYun  部署",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-ASPNETCore.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-ASPNETCore.html",
      "summary": "ASP.NET Core+Docker+AliYun 部署 ASP.NET Core+Docker 部署 ubuntu 安装了docker 本地.net sdk 工具:xshell、xftp 开通阿里的容器镜像服务 (aliyun.com)：用于私有镜像上传 部署分为几种方式 本地生成aspnetcore的发布包，在服务器上生成docker镜像，直接在...",
      "content_html": "\n<h2><a class=\"header-anchor\" href=\"#asp-net-core-docker-部署\"><span></span></a><a href=\"http://ASP.NET\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET</a> Core+Docker 部署</h2>\n<ul>\n<li>ubuntu 安装了docker</li>\n<li><a href=\"http://xn--cesv58a.net\" target=\"_blank\" rel=\"noopener noreferrer\">本地.net</a> sdk</li>\n<li>工具:xshell、xftp</li>\n<li>开通阿里的<a href=\"https://cr.console.aliyun.com/cn-hangzhou/instances\" target=\"_blank\" rel=\"noopener noreferrer\">容器镜像服务 (aliyun.com)</a>：用于私有镜像上传</li>\n</ul>\n<h2>部署分为几种方式</h2>\n<ul>\n<li>本地生成aspnetcore的发布包，在服务器上生成docker镜像，直接在服务器运行</li>\n<li>本地构建Docker镜像，推送Aliyun容器镜像，服务器拉取镜像并运行</li>\n<li>Jenkins、Aliyun容器镜像、自动化脚本（跨服务器）</li>\n</ul>\n<h2>方式1.本地生成部署包+服务器Docker 部署</h2>\n<p>1.本地如果没有安装Docker for Windows，可在服务器，如ubuntu安装了Docker</p>\n<p><a href=\"https://docs.docker.com/engine/install/ubuntu/\" target=\"_blank\" rel=\"noopener noreferrer\">Install Docker Engine on Ubuntu | Docker Documentation</a></p>\n<p><a href=\"http://xn--ASP-p18doh57tg0j29pomr.NET\" target=\"_blank\" rel=\"noopener noreferrer\">本地创建一个ASP.NET</a> Core项目<code>DevOps.Api</code>，项目源码已上传至github</p>\n<p><a href=\"https://github.com/luoyunchong/devops\" target=\"_blank\" rel=\"noopener noreferrer\">luoyunchong/devops: Azure DevOps Pipelines Release Aliyun 阿里云 Docker CI/CD 持续集成 (github.com)</a></p>\n<p>创建配置Dockerfile文件，替换如下内容，右键属性配置，复制到输出目录：如果较新则复制</p>\n<div class=\"language-docker line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"docker\" data-title=\"docker\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">FROM</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> mcr.microsoft.com/dotnet/aspnet:7.0 </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">AS</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> base</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">COPY</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> . /app</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">WORKDIR</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /app</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">EXPOSE</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> 80</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">ENTRYPOINT</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"dotnet\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"DevOps.Api.dll\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>生成.NET项目包</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> e:/code/devops/DevOps.Api</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> publish</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --configuration</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Release</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>将在此目录生成部署的文件</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">e:/code/devops/DevOps.Api/bin/Release/net7.0/publish</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>在ubuntu创建一个目录 devops_api，将生成文件内容，使用xftp上传至ubuntu文件夹中</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mkdir</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /var/www/devops_api</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /var/www/devops_api</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p></p>\n<h3>Docker打包</h3>\n<p>ubuntu上安装好了docker，并且正常运行。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /var/www/devops_api</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> # 先cd的项目目录 </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> build</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -t</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> igeekfan/devops_api</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> .</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">     #生成images</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 7007:80</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> igeekfan/devops_api</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">   # 生成 container 并运行在5000端口</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li><strong>d</strong> 代表后台运行</li>\n<li>p 此时将对外显露7007端口运行，7007是运行后，docker对外的端口，80是这个服务对外的端口，其中Dockerfile 存在语句EXPOSE 80</li>\n</ul>\n<p>此时打开 浏览器， ip+端口7007即可访问服务。</p>\n<p><a href=\"http://127.0.0.1:7007/swagger/index.html\" target=\"_blank\" rel=\"noopener noreferrer\">http://127.0.0.1:7007/swagger/index.html</a></p>\n<h2>方式二.Docker 打包并部署</h2>\n<ul>\n<li>此方法必须在本地安装docker</li>\n</ul>\n<h3>创建Dockerfile时</h3>\n<p>直接使用默认创建的文件内容即可，不需要修改任何内容</p>\n<div class=\"language-docker line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"docker\" data-title=\"docker\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#See https://aka.ms/containerfastmode to understand how Visual Studio uses this Dockerfile to build your images for faster debugging.</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">FROM</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> mcr.microsoft.com/dotnet/aspnet:7.0 </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">AS</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> base</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">WORKDIR</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /app</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">EXPOSE</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> 80</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">EXPOSE</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> 443</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">FROM</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> mcr.microsoft.com/dotnet/sdk:7.0 </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">AS</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> build</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">WORKDIR</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /src</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">COPY</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"DevOps.Api/DevOps.Api.csproj\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"DevOps.Api/\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">RUN</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> dotnet restore </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"DevOps.Api/DevOps.Api.csproj\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">COPY</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> . .</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">WORKDIR</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"/src/DevOps.Api\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">RUN</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> dotnet build </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"DevOps.Api.csproj\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> -c Release -o /app/build</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">FROM</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> build </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">AS</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> publish</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">RUN</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> dotnet publish </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"DevOps.Api.csproj\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> -c Release -o /app/publish /p:UseAppHost=false</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">FROM</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> base </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">AS</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> final</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">WORKDIR</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /app</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">COPY</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> --from=publish /app/publish .</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#61AFEF\">ENTRYPOINT</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"dotnet\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"DevOps.Api.dll\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>上传至阿里云</h3>\n<p>先登录</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#登录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> login</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --username=[账号]</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#密码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#输入密码 xxxxx</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#或使用此命令</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">echo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [密码]</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">|</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> login</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --username=[账号]</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --password-stdin</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>打包并推到阿里云镜像</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#进入项目根目录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> e:/code/devops</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#build 镜像</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> build</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -f</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> DevOps.Api/Dockerfile</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">  -t</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> devops_api</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> .</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#打包tag</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> tag</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> devops_api</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/devops_api</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#推送阿里云</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> push</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/devops_api</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>启动服务</h3>\n<p>(服务器上必须安装docker、在linux服务器上执行)</p>\n<h3>登录阿里容器镜像</h3>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">echo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [密码]</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">|</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> login</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --username=[账号]</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --password-stdin</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h3>判断是否存在容器（镜像），如果存在则删除</h3>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#判断是否存在-devops_api容器</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> ps</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> |</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> grep</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> devops_api</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> &amp;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /dev/null</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#如果不存在，则Remove</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [ </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\">$?</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> -ne</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> ]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">then</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">    echo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"devops_api container not exist continue.. \"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">else</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">    echo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"remove devops_api container\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">    docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> devops_api</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -f</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">fi</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> images</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> |</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> grep</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/devops_api</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> &amp;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /dev/null</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#如果不存在，不做操作</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [ </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\">$?</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> -ne</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> ]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">then</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">    echo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"image does not exist , continue...\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">else</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">    echo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"image exists !!! remove it\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">    docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rmi</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --force</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/devops_api</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">fi</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>拉取镜像</h3>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> pull</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/devops_api:latest</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h3>方式1.直接启动</h3>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> unless-stopped</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 5015:80</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">  --privileged=true</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --name</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">devops_api</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/devops_api</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>方式2.使用映射目录启动</h3>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mkdir</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /var/www/devops_api/wwwroot</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> unless-stopped</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 5014:80</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/var/www/devops_api/wwwroot:/app/wwwroot:rw</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/var/www/devops_api/appsettings.json:/app/appsettings.json</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--privileged=true </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--name </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">devops_api</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-d </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">registry.cn-hangzhou.aliyuncs.com/igeekfan/devops_api</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>源码</h2>\n<p><a href=\"https://github.com/luoyunchong/devops\" target=\"_blank\" rel=\"noopener noreferrer\">luoyunchong/devops: Azure DevOps Pipelines Release Aliyun 阿里云 Docker CI/CD 持续集成 (github.com)</a></p>\n<h2>参考</h2>\n<p><a href=\"https://www.cnblogs.com/zxtceq/p/7403953.html\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET Core开发Docker部署</a></p>\n",
      "date_published": "2023-03-13T06:20:58.000Z",
      "date_modified": "2023-03-13T06:20:58.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Docker配置 Nginx",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Nginx.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Nginx.html",
      "summary": "Docker配置 Nginx 拉取nginx镜像 启动nginx 直接启动一个nginx容器，端口映射到本地80端口，然后将容器的配置文件拷贝到本地，然后停止并移除容器，最后启动容器并挂载本地目录 因为nginx需要经常需要变更配置并需要发布静态文件，需要最好通过文件映射出来 本地创建管理目录 copy到刚创建的管理目录 停止并移除容器 启动容器并目录...",
      "content_html": "\n<h2>拉取nginx镜像</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> pull</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2>启动nginx</h2>\n<p>直接启动一个nginx容器，端口映射到本地80端口，然后将容器的配置文件拷贝到本地，然后停止并移除容器，最后启动容器并挂载本地目录</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --name</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 80:80</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> ps</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>因为nginx需要经常需要变更配置并需要发布静态文件，需要最好通过文件映射出来</p>\n<h2>本地创建管理目录</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mkdir</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/nginx</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mkdir</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/nginx/www</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mkdir</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /var/www/html</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mkdir</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/nginx/conf</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mkdir</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/nginx/logs</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>copy到刚创建的管理目录</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> cp</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx:/etc/nginx/nginx.conf</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/nginx/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> cp</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx:/etc/nginx/conf.d</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/nginx/conf/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> cp</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx:/usr/share/nginx/html/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/nginx/www/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> cp</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx:/var/log/nginx/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/nginx/logs/</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>停止并移除容器</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> stop</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>启动容器并目录挂载</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --name</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 80:80</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/etc/nginx/nginx.conf:/etc/nginx/nginx.conf</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/etc/nginx/www/:/usr/share/nginx/html/</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/var/www/html/:/var/www/html/</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/etc/nginx/logs/:/var/log/nginx/</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/etc/nginx/conf/:/etc/nginx/conf.d</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--privileged=true </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">-d</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nginx</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li><code>--name</code> 容器名称</li>\n<li><code>-p</code> 端口映射</li>\n<li><code>-v</code> 目录映射</li>\n<li><code>--privileged=true</code> 以root权限运行</li>\n<li><code>-d</code> 后台运行</li>\n</ul>\n",
      "date_published": "2023-03-12T13:50:00.000Z",
      "date_modified": "2023-03-13T06:20:58.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Docker配置 RabbitMQ",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-RabbitMQ.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-RabbitMQ.html",
      "summary": "Docker配置 RabbitMQ 创建本地目录 运行容器 映射路径需要加privileged的配置 参数说明 -d 后台模式 -p：表示端口映射，冒号左面的是我们的服务器的端口，右侧则表示的是容器内rabbimt的端口,多个 -p 支持多个端口映射 --name：指定容器的名字（非必填） --hostname 自定义Docker容器的 hostnam...",
      "content_html": "\n<h2>创建本地目录</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mkdir</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /usr/local/rabbitmq/1/lib</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mkdir</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /usr/local/rabbitmq/1/log</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">chmod</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -R</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 777</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /usr/local/rabbitmq/1/log</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>运行容器</h2>\n<ul>\n<li>映射路径需要加privileged的配置</li>\n</ul>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--hostname </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">rabbitmq</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--name </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">rabbitmq</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-p </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">15672:15672</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-p </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">5672:5672</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-e </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">RABBITMQ_DEFAULT_USER=admin</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-e </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">RABBITMQ_DEFAULT_PASS=123qwe</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-e </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">RABBITMQ_ERLANG_COOKIE='rabbitmq_cookie'</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--privileged=true </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/usr/local/rabbitmq/1/lib:/var/lib/rabbitmq</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/usr/local/rabbitmq/1/log:/var/log/rabbitmq</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">rabbitmq:management</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>参数说明</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">-i:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 交互式操作</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">-t:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 终端</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">-d:参数默认不会进入容器</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li><code>-d</code> 后台模式</li>\n<li><code>-p</code>：表示端口映射，冒号左面的是我们的服务器的端口，右侧则表示的是容器内rabbimt的端口,多个 <code>-p</code> 支持多个端口映射</li>\n<li><code>--name</code>：指定容器的名字（非必填）</li>\n<li><code>--hostname</code> 自定义Docker容器的 hostname</li>\n<li><code>--privileged=true</code> 使用该参数，container内的root拥有真正的root权限，否则容器出现permission denied</li>\n<li><code>-v</code> <strong><strong>Volumes 卷</strong></strong></li>\n</ul>\n<p>打开网站</p>\n<ul>\n<li><code>http://localhost:15672</code></li>\n<li>账号：admin</li>\n<li>密码 123qwe</li>\n</ul>\n",
      "date_published": "2023-03-12T13:50:00.000Z",
      "date_modified": "2023-03-12T13:50:00.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "C#委托的介绍",
      "url": "https://igeekfan.cn/igeekfan-docs/blogs/delegate.html",
      "id": "https://igeekfan.cn/igeekfan-docs/blogs/delegate.html",
      "summary": "C#委托的介绍 C#委托的介绍(delegate、Action、Func、predicate) 委托是一个类，它定义了方法的类型，使得可以将方法当作另一个方法的参数来进行传递。事件是一种特殊的委托。 类似 c++的函数指针，但是他是类型安全的， 允许将方法作为参数传递。 可用于定义回调方法。 委托可以链接在一起。例如，可以对一个事件调用多个方法。 de...",
      "content_html": "\n<h2>C#委托的介绍(delegate、Action、Func、predicate)</h2>\n<p>委托是一个类，它定义了方法的类型，使得可以将方法当作另一个方法的参数来进行传递。事件是一种特殊的委托。</p>\n<p>类似 c++的函数指针，但是他是类型安全的，</p>\n<ol>\n<li>允许将方法作为参数传递。</li>\n<li>可用于定义回调方法。</li>\n<li>委托可以链接在一起。例如，可以对一个事件调用多个方法。</li>\n</ol>\n<h2>delegate</h2>\n<p>委托的关键字是 <strong>delegate</strong>,一个委托相当于一个新的类，可使用访问修饰符 public、private、protected 等，作用域同类的修饰符.</p>\n<p>定义了委托类型与参数,使得可以将方法当作另一个方法参数来传递。事件是一种特殊的委托。</p>\n<p>Delegate 至少 0 个参数，至多 32 个参数，可以无返回值，也可以指定返回值类型。</p>\n<p>定义一个委托，有二个参数，并返回 Int 类型的值。</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    delegate</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> CalculateMethodInvoker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> a</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> b</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>定义方法,方法参数与返回值与委托保持一致</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> CalculateHelper</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Sum</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> x</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> y</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> x</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> y</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Multiply</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> x</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> y</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> x</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> *</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> y</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>调用</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Program</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Main</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">args</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        CalculateMethodInvoker</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> calculateSumInvoker</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> CalculateHelper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Sum</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        CalculateMethodInvoker</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> calculateSumInvoker2</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> CalculateMethodInvoker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CalculateHelper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Sum</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//实例化一个委托</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        CalculateMethodInvoker</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> calculateMultiplyInvoker</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> CalculateHelper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Multiply</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> x</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 20</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">y</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 10</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> addResult</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> calculateSumInvoker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">x</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">y</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> addResult2</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> calculateSumInvoker2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">x</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">y</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> invokeResult</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> calculateSumInvoker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Invoke</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">x</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">y</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">$\"x,y相加，得到{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">addResult</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">},{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">addResult2</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">},{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">invokeResult</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">$\"x,y相乘，得到{</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">calculateMultiplyInvoker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">x</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">,</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">y</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">)}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ReadKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>一个委托可以将多个方法链接在一起。也可以移除某个方法</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ContactDelegate</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    CalculateMethodInvoker</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> calculateInvoker</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> CalculateHelper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Sum</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">    calculateInvoker</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> +=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> CalculateHelper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Multiply</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> r1</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> calculateInvoker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">10</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">20</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">$\"ContactDelegate:{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">r1</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">    calculateInvoker</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> -=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> CalculateHelper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Multiply</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> r2</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> calculateInvoker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">10</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">20</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">$\"ContactDelegate:{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">r2</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>Action</h2>\n<p>Action 是无返回值的泛型委托。特点是：至少 0 个参数，至多 16 个参数，无返回值。</p>\n<ol>\n<li>调用方法、可以传入参数</li>\n</ol>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ActionParams</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    Action</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">action</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Action</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Sum</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">    action</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Sum</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> x</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> y</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">$\"x+y={</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">x</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> y</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ol start=\"2\">\n<li>使用 lambda 表达式</li>\n</ol>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ActionLambda</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    Action</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">action</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">x</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">y</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">$\"x+y={</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">x</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> y</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">    action</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>Func</h2>\n<p>Func 是有返回值的泛型委托，Func 特点：至少 0 个参数，至多 16 个参数，根据返回值泛型返回。必须有返回值，不可 void</p>\n<p><code>Func&lt;int</code>&gt; 表示无参，返回值为 int 的委托</p>\n<p><code>Func&lt;int, int, string&gt;</code> 表示传入参数为 int, int。 返回值为 string 的委托</p>\n<p>1.调用方法，传入参数</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> FuncMethod</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    Func</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">fc1</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Func</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CalculateHelper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Sum</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> result</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> fc1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//调用委托</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">result</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>2.使用 lambda</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> FuncLambda</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    Func</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">fc</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">x</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">y</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">x</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> y</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(); };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> fc</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>Predicate</h2>\n<p>predicate 是返回 bool 型的泛型委托</p>\n<p><code>predicate&lt;int&gt;</code> 表示传入参数为 int 返回 bool 的委托</p>\n<p>Predicate 有且只有一个参数，返回值固定为 bool</p>\n<p>1、使用单行 lambda,带括号的 lambda（可多行代码），独立的方法。都返回 bool 类型的值。</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> PredicateBoolean</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    Point</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">points</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">                new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Point</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">100</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">200</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">                new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Point</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">150</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">250</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">                new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Point</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">250</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">375</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">                new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Point</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">275</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">395</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">                new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Point</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">295</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">450</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    Predicate</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Point</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">predicate1</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> p</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> p</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">X</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> *</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> p</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Y</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> &gt;</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 100000</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    Predicate</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Point</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">predicate2</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> p</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">p</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">X</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> *</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> p</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Y</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> &gt;</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 100000</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        else</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> false</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    Point</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> first</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Array</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Find</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">points</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">ProductGT10</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    Point</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> p1</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Array</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Find</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">points</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">predicate1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    Point</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> p2</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Array</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Find</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">points</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">predicate2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Found: X = {0}, Y = {1}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">first</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">X</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">first</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Y</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Found: X = {0}, Y = {1}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">p1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">X</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">p1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Y</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Found: X = {0}, Y = {1}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">p2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">X</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">p2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Y</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ReadKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> bool</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ProductGT10</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Point</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> p</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">p</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">X</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> *</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> p</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Y</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> &gt;</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 100000</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    else</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> false</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>Array.Find 方法，使用 Predicate 委托搜索 Point 结构的数组，只有是 x 和 y 字段的乘积大于 100000,方法 ProductGT10 返回 true,找到符合要求的元素后停止。</p>\n<h2>事件</h2>\n<p><strong>事件自身就是委托类型</strong>，由于委托可以绑定调用多个方法，这会给事件的处理带来方便 。类只需要对外公开事件，就可以与外部的其他地方关联，从而实现事件订阅。</p>\n<p>1.由于不同的事件要传递的参数不同，我们通过继承 EventArgs，</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> KeyPressEventArgs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">EventArgs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ConsoleKey</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> PressdKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> KeyPressEventArgs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ConsoleKey</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> consoleKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\">        this</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">PressdKey</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> consoleKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>2.带有泛型参数的事件处理委托。</p>\n<p>系统函数内置如下委托</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> delegate</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> EventHandler</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TEventArgs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">object</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> sender</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TEventArgs</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> e</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);   </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">TEventArgs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> 是一个泛型参数</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> App</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> event</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> EventHandler</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">KeyPressEventArgs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">KeyPressed</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    protected</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> virtual</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> OnSpaceKeyPressed</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">KeyPressEventArgs</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> e</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        KeyPressed</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">?</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Invoke</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\">this</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">e</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> StartRun</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        while</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            ConsoleKeyInfo</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> keyInfo</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ReadKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">keyInfo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Key</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> ConsoleKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Spacebar</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">                OnSpaceKeyPressed</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> KeyPressEventArgs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">keyInfo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Key</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">keyInfo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Key</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> ConsoleKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Escape</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">                break</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Program</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Main</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">args</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"空格：输入当前时间\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"ESC:退出系统\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        App</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> app</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> App</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">KeyPressed</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> +=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> MyApp_SpaceKeyPressed</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">StartRun</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> MyApp_SpaceKeyPressed</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">object</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> sender</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">KeyPressEventArgs</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> e</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">$\"{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DateTime</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Now</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToLongTimeString</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">()}按下空格键,{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">e</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">PressdKey</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToString</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">()}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>参考</h2>\n<ul>\n<li><a href=\"https://www.cnblogs.com/akwwl/p/3232679.html\" target=\"_blank\" rel=\"noopener noreferrer\">C#委托的介绍(delegate、Action、Func、predicate)</a></li>\n<li><a href=\"https://www.cnblogs.com/hjxzjp/p/7667536.html\" target=\"_blank\" rel=\"noopener noreferrer\">c# 定义委托和使用委托（事件的使用）</a></li>\n</ul>\n",
      "date_published": "2022-08-01T13:27:15.000Z",
      "date_modified": "2022-08-01T13:27:15.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "多个 IFreeSql实例，如何注入使用",
      "url": "https://igeekfan.cn/igeekfan-docs/blogs/idlebus-freesql.html",
      "id": "https://igeekfan.cn/igeekfan-docs/blogs/idlebus-freesql.html",
      "summary": "多个 IFreeSql实例，如何注入使用 多库切换，动态切库，动态注册数据库 一、定义多个 IFreeSql 该方法适用于固定数据库，固定配置项 1、定义两个标识类： 2、在 Startup.cs 中单例注入 3、在 Controller 中使用 二、利用 IdleBus 重写 IFreeSql 在 asp.net core 利用 IdleBus 重写...",
      "content_html": "\n<p>多库切换，动态切库，动态注册数据库</p>\n<h2>一、定义多个 IFreeSql</h2>\n<p>该方法适用于固定数据库，固定配置项</p>\n<p>1、定义两个标识类：</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> MySqlFlag</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> {}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SqlServerFlag</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> {}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>2、在 Startup.cs 中单例注入</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ConfigureServices</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IServiceCollection</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> fsql1</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSqlBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseConnectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DataType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">MySql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"str1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">MySqlFlag</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> fsql2</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSqlBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseConnectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DataType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">MySql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"str1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SqlServerFlag</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddSingleton</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">MySqlFlag</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">fsql1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddSingleton</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SqlServerFlag</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">fsql2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>3、在 Controller 中使用</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Route</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"api/[controller]\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ApiController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ValuesController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ControllerBase</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ValuesController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">MySqlFlag</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">mysql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SqlServerFlag</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">sqlserver</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>二、利用 IdleBus 重写 IFreeSql</h2>\n<p>在 <a href=\"http://asp.net\" target=\"_blank\" rel=\"noopener noreferrer\">asp.net</a> core 利用 IdleBus 重写 IFreeSql 支持多库操作，支持多库动态配置</p>\n<div class=\"language-xml line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"xml\" data-title=\"xml\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">ItemGroup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    &lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">PackageReference</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> Include</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"FreeSql\"</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> Version</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"3.2.664\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    &lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">PackageReference</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> Include</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"IdleBus\"</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> Version</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"1.5.2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    &lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">PackageReference</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> Include</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"FreeSql.Provider.Sqlite\"</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> Version</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"3.2.664\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">ItemGroup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>1、MultiFreeSql.cs 代码定义</h3>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Threading</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Internal</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Internal</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CommonProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSql</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> MultiFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">MultiFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> MultiFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TimeSpan</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> timeSpan</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) : </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\">base</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">timeSpan</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> MultiFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IdleBus</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">idleBus</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) : </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\">base</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">idleBus</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> MultiFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">BaseDbProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        internal</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> TDBKey</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _dbkeyMaster</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        internal</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AsyncLocal</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">_dbkeyCurrent</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AsyncLocal</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        BaseDbProvider</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> _ormMaster</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _ib</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">_dbkeyMaster</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">as</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> BaseDbProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        BaseDbProvider</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> _ormCurrent</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _ib</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Equals</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">_dbkeyCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Value</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">default</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">?</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> _dbkeyMaster</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">_dbkeyCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Value</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">as</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> BaseDbProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        internal</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IdleBus</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">_ib</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> MultiFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TimeSpan</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> timeSpan</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            _ib</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IdleBus</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">timeSpan</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            _ib</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Notice</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> +=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">_</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">__</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> MultiFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IdleBus</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">idleBus</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            _ib</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> idleBus</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IAdo</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Ado</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _ormCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Ado</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IAop</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Aop</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _ormCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Aop</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ICodeFirst</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> CodeFirst</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _ormCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CodeFirst</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IDbFirst</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> DbFirst</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _ormCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DbFirst</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> GlobalFilter</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> GlobalFilter</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _ormCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">GlobalFilter</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Dispose</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">() </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _ib</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Dispose</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> CommonExpression</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> InternalCommonExpression</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _ormCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">InternalCommonExpression</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> CommonUtils</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> InternalCommonUtils</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _ormCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">InternalCommonUtils</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ISelect</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateSelectProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">object</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> dywhere</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _ormCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateSelectProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">dywhere</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IDelete</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateDeleteProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">object</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> dywhere</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _ormCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateDeleteProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">dywhere</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IUpdate</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateUpdateProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">object</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> dywhere</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _ormCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateUpdateProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">dywhere</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IInsert</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateInsertProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;() </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _ormCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateInsertProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IInsertOrUpdate</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateInsertOrUpdateProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;() </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _ormCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateInsertOrUpdateProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>所以 MultiFreeSql 支持外部定义IdleBus,用于配置 Idlebus的Notice事件</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> //可传递IdleBus</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    IdleBus</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> idlebus</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">  =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IdleBus</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">TimeSpan</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">FromHours</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    idlebus</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Notice</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> +=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">_</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">__</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> MultiFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">idlebus</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>2、MultiFreeSqlExtensions</h3>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSql</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> MultiFreeSqlExtensions</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ChangeDatabaseByKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">this</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> dbkey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> multiFsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> as</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> MultiFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">multiFsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> null</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">throw</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Exception</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"fsql 类型不是 MultiFreeSql&lt;TDBKey&gt;\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            multiFsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">_dbkeyCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Value</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> dbkey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> multiFsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IDisposable</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Change</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">this</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> dbkey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> multiFsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> as</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> MultiFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">multiFsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> null</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">throw</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Exception</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"fsql 类型不是 MultiFreeSql&lt;TDBKey&gt;\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> olddbkey</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> multiFsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">_dbkeyCurrent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Value</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            multiFsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ChangeDatabaseByKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">dbkey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> DBChangeDisposable</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(() </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> multiFsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ChangeDatabaseByKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">olddbkey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Register</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">this</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> dbkey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Func</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">create</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> multiFsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> as</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> MultiFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TDBKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">multiFsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> null</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">throw</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Exception</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"fsql 类型不是 MultiFreeSql&lt;TDBKey&gt;\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">multiFsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">_ib</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">TryRegister</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">dbkey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">create</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">                if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">multiFsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">_ib</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetKeys</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Length</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">                    multiFsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">_dbkeyMaster</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> dbkey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> multiFsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> DBChangeDisposable</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IDisposable</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        Action</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _cancel</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> DBChangeDisposable</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Action</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> cancel</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> _cancel</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> cancel</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Dispose</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">() </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _cancel</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">?</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Invoke</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>3、定义和注入,其中MultiFreeSql.cs</h3>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IServiceCollection</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> AddMultiFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">this</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IServiceCollection</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> MultiFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">TimeSpan</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">FromHours</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Register</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"db1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, () </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">    new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSqlBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseAutoSyncStructure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseConnectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DataType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Sqlite</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Data Source=|DataDirectory|</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\\</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">SampleApp1.db;\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    );</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Register</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"db2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, () </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">    new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSqlBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseAutoSyncStructure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseConnectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DataType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Sqlite</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Data Source=|DataDirectory|</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\\</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">SampleApp2.db;\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    );</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddSingleton</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>4、如何使用</h3>\n<blockquote>\n<p>额外增加 Register/Change 两个扩展方法，其他跟 IFreeSql 用法几乎一样</p>\n</blockquote>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//查db1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> db1_list</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//切换 db2 数据库，一旦切换之后 fsql 操作都是针对 db2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Change</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"db2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> db2_list</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Change</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"db1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //查询 db1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b3</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //插入到 db1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Insert</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> T</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{ </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">UserName</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"db1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> }).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrows</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//还是查db2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> db2</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">T</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>示例</p>\n<ul>\n<li>定义SysUser</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SysUser</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Column</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">IsPrimary</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">IsIdentity</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> UserName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>创建HomeController</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> HomeController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">( </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">    _fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>获取db1,db2的数据库信息，插入db1,db2数据</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// 获取db1,db2，插入db1,db2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"get1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IEnumerable</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Get1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //查询 db1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b0</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b1</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Change</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"db2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //查询 db2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b2</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //插入到 db2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> c0</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Insert</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">UserName</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"db2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> }).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrows</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    using</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">_fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Change</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"db1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //查询 db1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b3</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //插入到 db1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Insert</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">UserName</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"db1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> }).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrows</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //查询 db2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> db2</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Change</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"db2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> db2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>默认从第一个数据库中获取</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"getdb1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IEnumerable</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetDB1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //查询 db1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b0</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> b0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>注册第3个数据库</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"register\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Register</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Register</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"db3\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, () </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSqlBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseAutoSyncStructure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseMonitorCommand</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        cmd</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Trace</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\r\\n</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">线程\"</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Thread</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CurrentThread</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ManagedThreadId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \": \"</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> cmd</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CommandText</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        )</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseConnectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DataType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Sqlite</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Data Source=|DataDirectory|</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\\</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">SampleApp3.db;\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    });</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>根据dbname change，但只对本次请求有效</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"change\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Change</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> dbname</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  //仅对本次请求有效</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">  _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Change</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">dbname</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">  return</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>获取DB3，在未注册前，会报错</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"getdb3\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IEnumerable</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Get3</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Change</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"db3\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //查询 db1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b0</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> b0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><blockquote>\n<p>如果需要分布多事务 TCC/Saga 请移步到：<a href=\"https://github.com/dotnetcore/FreeSql.Cloud\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/dotnetcore/FreeSql.Cloud</a></p>\n</blockquote>\n<h2>三、静态类管理多数据库？</h2>\n<p>基于第二种方法 MultiFreeSql 增加静态类如下：</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSql</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">  public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> StaticDB</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">StaticDB</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; { }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">  public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> abstract</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> StaticDB</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">DBKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">      protected</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Lazy</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">multiFreeSql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Lazy</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(() </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> MultiFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">TimeSpan</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">FromHours</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      );</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">      public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Instance</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> multiFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Value</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>根据静态类</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">#</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">region</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 1.静态类的注册方式</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> db</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> StaticDB</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Instance</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">db</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Register</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"db1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, () </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    return</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSqlBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseAutoSyncStructure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseMonitorCommand</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        cmd</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Trace</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\r\\n</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">线程\"</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Thread</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CurrentThread</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ManagedThreadId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \": \"</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> cmd</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CommandText</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        )</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseConnectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DataType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Sqlite</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Data Source=|DataDirectory|</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\\</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">SampleApp1.db;\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">});</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">db</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Register</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"db2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, () </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    return</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSqlBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseAutoSyncStructure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseMonitorCommand</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        cmd</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Trace</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\r\\n</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">线程\"</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Thread</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CurrentThread</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ManagedThreadId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \": \"</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> cmd</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CommandText</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        )</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseConnectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DataType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Sqlite</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Data Source=|DataDirectory|</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\\</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">SampleApp2.db;\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">});</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">#</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">endregion</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>创建StaticDBController，可以直接使用静态方法，不使用DI，但使用方式和注入方式相同</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">   private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> StaticDB</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Instance</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// 获取db1,db2，插入db1,db2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"get1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IEnumerable</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Get1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //查询 db1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b0</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b1</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Change</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"db2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //查询 db2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b2</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //插入到 db2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> c0</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Insert</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">UserName</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"db2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> }).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrows</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        using</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">_fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Change</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"db1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //查询 db1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b3</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //插入到 db1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Insert</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">UserName</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"db1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> }).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrows</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //查询 db2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> db2</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SysUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Change</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"db2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> db2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>参考</h2>\n<p><a href=\"https://github.com/luoyunchong/SampleApp/blob/master/SampleApi/Controllers/HomeController.cs\" target=\"_blank\" rel=\"noopener noreferrer\">SampleApp/HomeController.cs at master · luoyunchong/SampleApp (github.com)</a></p>\n<p><a href=\"https://github.com/luoyunchong/SampleApp/blob/master/SampleCore/MultiFreeSql.cs\" target=\"_blank\" rel=\"noopener noreferrer\">SampleApp/MultiFreeSql.cs at master · luoyunchong/SampleApp (github.com)</a></p>\n<p><a href=\"https://github.com/dotnetcore/FreeSql/issues/44\" target=\"_blank\" rel=\"noopener noreferrer\">多个 IFreeSql 实例，如何注入使用？ · Issue #44 · dotnetcore/FreeSql (github.com)</a></p>\n<blockquote>\n<p>与此文章有点区别，增加了一些配置项和静态方法的理解，把<code>Change</code> 下放到<code>MultiFreeSqlExtensions</code>扩展中，从而保持简单，静态方法和DI保持一致的写法</p>\n</blockquote>\n",
      "date_published": "2022-08-01T13:27:15.000Z",
      "date_modified": "2022-10-20T16:01:01.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Docker 配置 Baget",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Baget.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Baget.html",
      "summary": "Docker 配置 Baget 创建一个名为baget.env存储BaGet的配置： baget.env 有关配置的完整列表，请参阅Configuration - BaGet (loic-sharma.github.io)的配置指北。 Docker 在baget.env同目录创建一个baget-data 的目录 拉取baget最新的镜像 运行BaGet...",
      "content_html": "\n<p>创建一个名为baget.env存储BaGet的配置：</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /var</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mkdir</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> baget</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /var/baget</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">vim</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> baget.env</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>baget.env</li>\n</ul>\n<div class=\"language-text line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"text\" data-title=\"text\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span># 以下配置是用于发布包的API密钥,您应该将其更改ApiKey的值以保护服务器。</span></span>\n<span class=\"line\"><span>ApiKey=Your-API-Key</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>Storage__Type=FileSystem</span></span>\n<span class=\"line\"><span>Storage__Path=/var/baget/packages</span></span>\n<span class=\"line\"><span>Database__Type=Sqlite</span></span>\n<span class=\"line\"><span>Database__ConnectionString=Data Source=/var/baget/baget.db</span></span>\n<span class=\"line\"><span>Search__Type=Database</span></span>\n<span class=\"line\"><span>Mirror__Enabled=true</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>有关配置的完整列表，请参阅<a href=\"https://loic-sharma.github.io/BaGet/configuration/\" target=\"_blank\" rel=\"noopener noreferrer\">Configuration - BaGet (loic-sharma.github.io)</a>的配置指北。</p>\n<h2>Docker</h2>\n<p>在baget.env同目录创建一个<code>baget-data</code> 的目录</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mkdir</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> baget-data</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>拉取baget最新的镜像</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> pull</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> loicsharma/baget</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>运行BaGet</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /var/baget</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --name</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nuget-server</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart=always</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 5555:80</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --env-file</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> baget.env</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -v</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"$(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">pwd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">)/baget-data:/var/baget\"</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> loicsharma/baget:latest</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>发布包</h2>\n<p>发布第一个nuget包</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nuget</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> push</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -s</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> http://localhost:5555/v3/index.json</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -k</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Your-API-Key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">package.1.0.0.nupkg</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>发布第一个symbol  package</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nuget</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> push</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -s</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> http://localhost:5555/v3/index.json</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -k</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Your-API-Key</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> package.1.0.0.snupkg</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>示例</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nuget</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> push</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -s</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> http://124.70.130.97:5555/v3/index.json</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> src/IGeekFan.Localization.FreeSql/bin/Debug/IGeekFan.Localization.FreeSql.0.0.3.nupkg</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -k</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Your-API-Key</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nuget</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> push</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -s</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> http://124.70.130.97:5555/v3/index.json</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> src/IGeekFan.Localization.FreeSql/bin/Debug/IGeekFan.Localization.FreeSql.0.0.3.snupkg</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -k</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Your-API-Key</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>还原包</h2>\n<p>你可以通过以下源还原包</p>\n<div class=\"language-text line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"text\" data-title=\"text\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>http://localhost:5555/v3/index.json</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>可以通过打开URL来浏览包<a href=\"http://localhost:5555/\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost:5555/</a>在浏览器中。</p>\n<h2>Symbol server</h2>\n<p>可以使用以下符号位置加载符号：</p>\n<div class=\"language-text line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"text\" data-title=\"text\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>http://localhost:5555/api/download/symbols</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h3><a class=\"header-anchor\" href=\"#https-loic-sharma-github-io-baget-installation-docker\"><span></span></a><a href=\"https://loic-sharma.github.io/BaGet/installation/docker/\" target=\"_blank\" rel=\"noopener noreferrer\">https://loic-sharma.github.io/BaGet/installation/docker/</a></h3>\n",
      "date_published": "2022-06-29T19:17:23.000Z",
      "date_modified": "2022-08-15T16:21:26.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Docker部署CMS命令",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-CMS.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-CMS.html",
      "summary": "Docker部署CMS命令 部署docker nuget api key",
      "content_html": "\n<h2>部署docker</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#判断是否存在webnotebook容器</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> ps</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> |</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> grep</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-web-1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> &amp;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /dev/null</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#如果不存在，则Remove</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [ </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\">$?</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> -ne</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> ]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">then</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">    echo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"lincms-web container not exist continue.. \"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">else</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">    echo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"remove lincms-web-1 container\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">    docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-web-1</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -f</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">fi</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> images</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> |</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> grep</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/lincms-web</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> &amp;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /dev/null</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [ </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\">$?</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> -ne</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> ]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">then</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">    echo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"image does not exist , continue...\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">else</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">    echo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"image exists !!! remove it\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">    docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rmi</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --force</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/lincms-web</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">fi</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#从阿里云拉取刚刚push的镜像</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> pull</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/lincms-web</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> unless-stopped</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 5011:80</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --name</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-web-1</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/lincms-web</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-web-2</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -f</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-web-3</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -f</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-web-4</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -f</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> unless-stopped</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 5012:80</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --name</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-web-2</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/lincms-web</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> unless-stopped</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 5020:80</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --name</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-web-3</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/lincms-web</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> unless-stopped</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 5021:80</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --name</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-web-4</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/lincms-web</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>nuget api key</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Your-API-Key</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">nuget</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> SetApiKey</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Your-API-Key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nuget</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> push</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> IGeekFan.AspNetCore.Knife4jUI.0.0.11.nupkg</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --api-key</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Your-API-Key</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --source</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> https://api.nuget.org/v3/index.json</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  //\"DefaultConnection\": \"Data Source=|DataDirectory|\\\\SampleApp.db;\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"Sqlite1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Data Source=d:</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\\</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">SampleApp1.db\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"Sqlite2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Data Source=d:</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\\</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">SampleApp2.db\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"Oracle\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"user id=test;password=123qwe; data source=//127.0.0.1:1521/ORCL;Pooling=true;Min Pool Size=1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"MySql\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Data Source=127.0.0.1;Port=3306;User ID=root;Password=root; Initial Catalog=cccddd;Charset=utf8; SslMode=none;Min pool size=1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"SqlServer\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Data Source=(localdb)</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\\</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">MSSQLLocalDB;Initial Catalog=cccddd;Pooling=true;Min Pool Size=1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"PostgreSQL\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Host=127.0.0.1;Port=5432;Username=postgres;Password=postgresql; Database=postgres;Pooling=true;Minimum Pool Size=1\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2022-06-29T19:17:23.000Z",
      "date_modified": "2022-06-29T19:17:23.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Docker 命令行",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Command.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Command.html",
      "summary": "Docker 命令行 Command-Line Interfaces https://docs.docker.com/engine/reference/run/ 我们如果想将Docker 放置到其他机器运行，很简单。 我们如果想将Docker 放置到其他机器运行，很简单。 Docker删除",
      "content_html": "\n<ul>\n<li>Command-Line Interfaces <a href=\"https://docs.docker.com/engine/reference/run/\" title=\"https://docs.docker.com/engine/reference/run/\" target=\"_blank\" rel=\"noopener noreferrer\">https://docs.docker.com/engine/reference/run/</a></li>\n</ul>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> images</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  # 查看所有镜像</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> ps</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -a</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> #显示所有的容器，包括未运行的。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> ps</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -l</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> #最后启动的容器</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 容器id</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">   #删除容器</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rm</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> $(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> ps</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -q</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -a</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#一次性删除所有的容器</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rmi</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 镜像id/镜像名称</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  #删除镜像</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rmi</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> $(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> images</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -q</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#一次性删除所有的镜像。</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> build</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -t</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> igeekfan/demo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> .</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  #运行构建命令,构建Docker 镜像。 </span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 镜像</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> #运行</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -it</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 5000:80</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> igeekfan/demo</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#5000是运行后，docker对外的端口，80是这个服务对外的端口，其中Dockerfile 存在语句EXPOSE 80</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 5000:80</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> igeekfan/demo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">-d</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 参数后台运行</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> start</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 容器id</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> restart</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 容器id</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> stop</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 容器id</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> #终止容器。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> logs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> $CONTAINER_ID</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> ##在container外面查看它的输出 </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> attach</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> $CONTAINER_ID</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> ##连接上容器实时查看：</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> pull</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> microsoft/dotnet</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  #单独安装某一镜像</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> save</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 镜像id</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> &gt;</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 文件</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> #持久化镜像</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> load</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> &lt;</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 文件</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>我们如果想将Docker 放置到其他机器运行，很简单。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#直接保存镜像，然后复制镜像到其他机器，然后使用docker 命令load 既可。</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> save</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> igeekfan/demo</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> &gt;</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> demo.tar</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#然后加载命令</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> load</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> &lt;</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> demo.tar</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>我们如果想将Docker 放置到其他机器运行，很简单。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#直接保存镜像，然后复制镜像到其他机器，然后使用docker 命令load 既可。</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> save</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> igeekfan/demo</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> &gt;</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> demo.tar</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#然后加载命令</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> load</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> &lt;</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> demo.tar</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>Docker删除</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 查询相关软件包</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dpkg</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -l</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> |</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> grep</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> docker</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 删除这个包 上面查到什么，删除什么</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> apt</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> remove</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --purge</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> docker.io</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2022-06-29T19:17:23.000Z",
      "date_modified": "2022-06-29T19:17:23.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Docker 配置 Jenkins",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Jenkins.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Jenkins.html",
      "summary": "Docker 配置 Jenkins docker安装jenkins - hanease - 博客园 (cnblogs.com) 配置 Docker 镜像 Docker拉取镜像 配置本地存储目录 启动Jenkins容器 Docker 运行aspnetcore项目 构建项目 IGeekFan.Freekit.Service bash脚本 aspnetcor...",
      "content_html": "\n<p><a href=\"https://www.cnblogs.com/hanease/p/15690225.html\" target=\"_blank\" rel=\"noopener noreferrer\">docker安装jenkins - hanease - 博客园 (cnblogs.com)</a></p>\n<h2>配置 Docker 镜像</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">curl</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -sSL</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> https://get.daocloud.io/daotools/set_mirror.sh</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> |</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> sh</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -s</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> http://f1361db2.m.daocloud.io</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2>Docker拉取镜像</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> pull</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> jenkins/jenkins:lts</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2>配置本地存储目录</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mkdir</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /apps/devops/jenkins</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">chmod</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 777</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /apps/devops/jenkins</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>启动Jenkins容器</h3>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> stop</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> jenkins</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rmi</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> jenkins</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> usermod</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -a</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -G</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> root</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> chmod</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 666</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /var/run/docker.sock</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -itd</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 9003:8080</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 9004:50000</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--restart </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">always</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/apps/devops/jenkins:/var/jenkins_home</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--name </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">jenkins</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--volume </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/var/run/docker.sock:/var/run/docker.sock</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v $(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">which</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> docker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">:/usr/bin/docker</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v $(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">which</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> docker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">:/usr/bin/com.docker.cli</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">jenkins/jenkins:lts</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>Docker 运行aspnetcore项目</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -it</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 7000:80</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --name</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> aspnetcoredemo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> aspnetcoredemo</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2>构建项目</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> build</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -f</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> src/aspnetcoredemo/Dockerfile</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -t</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> aspnetcoredemo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> .</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">GITHASH</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">`</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">git</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rev-parse </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">--short</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> HEAD`</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> build</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -f</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> src/aspnetcoredemo/Dockerfile</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -t</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> aspnetcoredemo:</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">$GITHASH</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> .</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> tag</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> aspnetcoredemo:</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">$GITHASH</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> aspnetcoredemo:latest</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> build</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -f</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> src/Services/ToDo/IGeekFan.FreeKit.Todos.API/Dockerfile</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -t</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> igeekfan.freekit.todos.api</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> .</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>IGeekFan.Freekit.Service bash脚本</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#!/bin/bash</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 获取短版本号</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">GITHASH</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">`</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">git</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rev-parse </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">--short</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> HEAD`</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> stop</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> igeekfan.freekit.todos.api</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> igeekfan.freekit.todos.api</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">echo</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2022-06-29T19:17:23.000Z",
      "date_modified": "2022-06-29T19:17:23.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Docker 配置 MySql",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-MySql.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-MySql.html",
      "summary": "Docker 配置 MySql 1.拉取镜像 2不指定目录映射 -p 端口配置 主机3306/容器3306 -name 容器名，此处为mysql -e 配置信息 MYSQL_ROOT_PASSWORD=123456 指定密码为123456 -d 指定镜像 sudo docker run -p 3306:3306 --name mysql -e MYSQ...",
      "content_html": "\n<h2>1.拉取镜像</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> pull</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql:5.7</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">   # 拉取 mysql 5.7</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> pull</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">       # 拉取最新版mysql镜像</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>2不指定目录映射</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 3306:3306</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --name</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -e</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> MYSQL_ROOT_PASSWORD=</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">123456</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>-p 端口配置 主机3306/容器3306<br>\n-name 容器名，此处为mysql<br>\n-e 配置信息 MYSQL_ROOT_PASSWORD=123456 指定密码为123456<br>\n-d 指定镜像<br>\nsudo docker run -p 3306:3306 --name mysql -e MYSQL_ROOT_PASSWORD=123456 -d mysql</p>\n<blockquote>\n<p>默认的配置文件是：/etc/mysql/my.cnf<br>\n默认的数据目录是：/var/lib/mysql</p>\n</blockquote>\n<p>我们进入mysql容器中，查看my.cnf.</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> exec</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -it</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> bash</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">cat</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/mysql/my.cnf</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>my.cnf 加载了 /etc/mysql/conf.d目录中所有以后缀为.cnf的配置文件，所以我们映射目录，只需要映射conf.d目录即可。</p>\n<p>先在linux上创建目录</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mkdir</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /usr/local/docker/mysql/conf.d</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> vim</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql-docker.cnf</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>保存内容</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[mysqld]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">server-id</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 1</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> #服务Id唯一</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">port</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 3306</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">log-error</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">    =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /var/log/mysql/error.log</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#只能用IP地址</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">skip_name_resolve</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#数据库默认字符集</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">character-set-server</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> utf8mb4</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#数据库字符集对应一些排序等规则 </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">collation-server</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> utf8mb4_general_ci</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#设置client连接mysql时的字符集,防止乱码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">init_connect</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">'SET NAMES utf8mb4'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#最大连接数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">max_connections</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 300</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#如果遇到这个错就执行下权限</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#mysqld: [Warning] World-writable config file '/etc/mysql/conf.d/mysql-docker.cnf' is ignored</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> chmod</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 644</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql-docker.cnf</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>3.建立目录映射</h2>\n<p>在linux上创建目录，用于存放mysql的日志和数据。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mkdir</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /usr/local/docker/mysql/logs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mkdir</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /usr/local/docker/mysql/data</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 3310:3306</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --name</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/usr/local/docker/mysql/conf.d:/etc/mysql/conf.d</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/usr/local/docker/mysql/logs:/var/log/mysql</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/usr/local/docker/mysql/data:/var/lib/mysql</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-e </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">MYSQL_ROOT_PASSWORD=</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">123456</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--restart=always </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-d </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">mysql</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#查看docker 下进程，mysql是否启动</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> ps</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#由于 mysql /var/log/mysql 默认情况下查看</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> exec</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> chown</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql:root</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /var/log/mysql</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>-p 端口配置 linux主机3310/容器3306</li>\n<li>-name 容器名，此处为mysql</li>\n<li>-v 指定容器及其挂载的卷，此外为 宿主机文件目录:容器文件目录，可指定多个数据文件目录</li>\n<li>-e 配置信息 MYSQL_ROOT_PASSWORD=123456 设置 MySql服务的root密码为123456</li>\n<li>--restart=always 容器退出时总是重启</li>\n<li>-d 后台运行。</li>\n<li>镜像名</li>\n</ul>\n<h2>Docker相关命令</h2>\n<p>其中mysql为容器的name或id</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#重启容器</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> restart</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#暂停容器</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> stop</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#删除容器</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> rm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#启动容器</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> start</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">#更新容器 开机也能重启</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> update</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart=always</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>配置远程Navicat可访问</h3>\n<p>如果遇到无法访问时，可以使用此方式</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> exec</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -it</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /bin/bash</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mysql</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -uroot</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p123456</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">use</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ALTER</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> USER</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 'root'@'%'</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> IDENTIFIED</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> WITH</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql_native_password</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> BY</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> '123456'</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">flush</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> privileges</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>Restart参数</h3>\n<p>Docker 中restart参数用于指定自动重启docker容器策略，包含3个选项：no，on-failure[:times]，always，unless-stopped</p>\n<p>no 默认值，表示容器退出时，docker不自动重启容器</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart=no</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [容器名]</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>on-failure 若容器的退出状态非0，则docker自动重启容器，还可以指定重启次数，若超过指定次数未能启动容器则放弃**</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart=on-failure:3</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [容器名]</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>always 容器退出时总是重启**</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart=always</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [容器名]</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>unless-stopped 容器退出时总是重启，但不考虑Docker守护进程启动时就已经停止的容器**</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart=unless-stopped</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [容器名]</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>如果容器启动时没有设置–restart参数，则通过下面命令进行更新：* *</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> update</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart=always</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [容器名]</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div>",
      "date_published": "2022-06-29T19:17:23.000Z",
      "date_modified": "2022-06-29T19:17:23.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Docker 配置 Nacos",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Nacos.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Nacos.html",
      "summary": "Docker 配置 Nacos 1、创建本地的映射文件 创建目录 配置数据库 application.properties application.properties 下面通过配置来暴露除了/shutdown之外的所有端点。下面通过配置来暴露除了/shutdown之外的所有端点 2、运行容器 使用standalone(单机)模式并开放8848端口，并...",
      "content_html": "\n<h2>1、创建本地的映射文件</h2>\n<p>创建目录</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mkdir</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">  /usr/local/docker/nacos/logs</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /usr/local/docker/nacos/conf</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>配置数据库 application.properties</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">vim</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /usr/local/docker/nacos/conf/application.properties</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><ul>\n<li>application.properties</li>\n</ul>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">spring.datasource.platform</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">=mysql</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">db.num</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">=1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">db.url.0</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">=jdbc:mysql://localhost:3310/nacos_config?characterEncoding=utf8</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&amp;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">connectTimeout</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">1000</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&amp;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">socketTimeout</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">3000</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&amp;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">autoReconnect</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">db.user</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">=user</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">db.password</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">=password</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>下面通过配置来暴露除了/shutdown之外的所有端点。下面通过配置来暴露除了/shutdown之外的所有端点</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">management.endpoints.web.exposure.include</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">=*</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2>2、运行容器</h2>\n<p>使用<code>standalone</code>(单机)模式并开放8848端口，并映射配置文件和日志目录，数据库在application.properties中配置</p>\n<p>其中 <code>\\</code>(空格+反斜杠)来支持命令行换行</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-p </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">8848:8848</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 9848:9848</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 9555:9555</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-e </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">MODE=standalone</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-e </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">TZ=\"Asia/Shanghai\"</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-e </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">PREFER_HOST_MODE=hostname</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/usr/local/docker/nacos/logs:/home/nacos/logs</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/usr/local/docker/nacos/conf/application.properties:/home/nacos/conf/application.properties</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--restart </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">always</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--name </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">nacos</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">nacos/nacos-server</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>其中-v 指定映射配置。左侧为linux文件，右侧为docker目录</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> network</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> create</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql-net</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 创建桥接网络 mysql-net</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> network</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> connect</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql-net</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 容器 mysql 连入 mysql-net</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> network</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> connect</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql-net</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> nacos</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 同上，nacos</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> network</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> inspect</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> mysql-net</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 配置完后容器运行起来使用该命令查看该桥接网络下容器信息</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2022-06-29T19:17:23.000Z",
      "date_modified": "2022-08-24T20:14:02.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Docker 配置 Portainer",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Portainer.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Portainer.html",
      "summary": "Docker 配置 Portainer Docker 可视化管 portainer 默认9000端口 -d 后台运行 -p 端口映射 主机端口9000:容器端口9000 --restart=always 容器退出时总是重启 -v 本地docker.sock --name指定容器名 -d 指定镜像名",
      "content_html": "\n<h2>Docker 可视化管</h2>\n<ul>\n<li>portainer 默认9000端口</li>\n</ul>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> pull</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> portainer/portainer</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">sudo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 9000:9000</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--restart=always </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/var/run/docker.sock:/var/run/docker.sock</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">portainer_data:/data</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--name </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">portainer</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-d </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">portainer/portainer</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>-d 后台运行</li>\n<li>-p 端口映射 主机端口9000:容器端口9000</li>\n<li>--restart=always 容器退出时总是重启</li>\n<li>-v 本地docker.sock</li>\n<li><code>--</code>name指定容器名</li>\n<li>-d 指定镜像名</li>\n</ul>\n",
      "date_published": "2022-06-29T19:17:23.000Z",
      "date_modified": "2022-07-23T09:18:51.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Docker 配置 Redis",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Redis.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/Docker-Redis.html",
      "summary": "Docker 配置 Redis 目录 Docker 配置 Redis 目录 2.本地配置文件映射 3.启动Docker 2.本地配置文件映射 创建/etc/redis/conf/redis.conf文件，并且daemonize=no。一定要是非后台模式，如果 是YES,会导致redis无法启动，因为后台会导致docker无任务可做而退出 3.启动Doc...",
      "content_html": "\n<h2>目录</h2>\n<ul>\n<li><a href=\"#docker-%E9%85%8D%E7%BD%AE-redis\">Docker 配置 Redis</a>\n<ul>\n<li><a href=\"#%E7%9B%AE%E5%BD%95\">目录</a></li>\n<li><a href=\"#2%E6%9C%AC%E5%9C%B0%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%98%A0%E5%B0%84\">2.本地配置文件映射</a></li>\n<li><a href=\"#3%E5%90%AF%E5%8A%A8docker\">3.启动Docker</a></li>\n</ul>\n</li>\n</ul>\n<h2>2.本地配置文件映射</h2>\n<p>创建/etc/redis/conf/redis.conf文件，并且daemonize=no。一定要是非后台模式，如果 是YES,会导致redis无法启动，因为后台会导致docker无任务可做而退出</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">mkdir</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/redis/conf/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /etc/redis/conf/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">vim</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> redis.conf</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">##redis.conf文件内容</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">daemonize</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> no</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">port</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 6379</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">requirepass</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 123456</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">bind</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 0.0.0.0</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>3.启动Docker</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-p </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">6379:6379</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--name </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">redis</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/etc/redis/conf/redis.conf:/etc/redis/redis.conf</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-v </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/etc/redis/data:/data</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">-d </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">redis</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">redis-server </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">/etc/redis/redis.conf</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--requirepass </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">'123456'</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">--appendonly </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">yes</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><strong>docker 镜像reids 默认 无配置文件启动</strong></p>\n<ul>\n<li>-p：表示端口映射，冒号左面的是我们的服务器的端口，右侧则表示的是容器内mysql的端口</li>\n<li><code>--</code>name：是我们给redis容器取的名字</li>\n<li>-v：表示挂载路径\\映射配置文件</li>\n</ul>\n<p>/etc/redis/conf/redis.conf左侧，代表linux上的路径，映射到容器上的/etc/redis/redis.conf。</p>\n<p>/etc/redis/data代现linux上的redis的数据路径，映射到窗口中的/data目录</p>\n<ul>\n<li>-d redis  后台模式启动 redis</li>\n<li>redis-server /etc/redis/redis.conf    redis 将以 /etc/redis/redis.conf 为配置文件启动</li>\n<li>--appendonly yes  开启redis 持久化</li>\n<li>--requirepass '123456' 指定密码为123456</li>\n<li>--appendonly yes：开启持久化</li>\n</ul>\n<p>后续可通过修改linux上的/etc/redis/conf/redis.conf文件来修改容器的redis服务，如密码requireapss+ 密码</p>\n",
      "date_published": "2022-06-29T19:17:23.000Z",
      "date_modified": "2022-06-29T19:17:23.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Docker",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/docker/",
      "summary": "Docker Docker 中的三个概念，镜像（Image)、容器（Container)、仓库（Repository） 一个Image可有多个Container，我们可以把Image发布至Dokcer Hub提供的Repository中或阿里云Docker镜像仓库（Docker Registry），供他人使用。 Docker 安装 Ubuntu Doc...",
      "content_html": "\n<p>Docker 中的三个概念，镜像（Image)、容器（Container)、仓库（Repository）</p>\n<p>一个Image可有多个Container，我们可以把Image发布至Dokcer Hub提供的Repository中或阿里云Docker镜像仓库（Docker Registry），供他人使用。</p>\n<h2>Docker 安装</h2>\n<p><a href=\"https://cloud.tencent.com/developer/article/1853467\" title=\"Ubuntu Docker 安装 - 云+社区 - 腾讯云 (tencent.com)\" target=\"_blank\" rel=\"noopener noreferrer\">Ubuntu Docker 安装 - 云+社区 - 腾讯云 (tencent.com)</a></p>\n<h2>Docker 理论到实战</h2>\n<p><a href=\"https://www.cnblogs.com/codelove/p/10030439.html\" title=\"Docker最全教程——从理论到实战(一)\" target=\"_blank\" rel=\"noopener noreferrer\">Docker最全教程——从理论到实战(一)</a></p>\n<p><a href=\"http://dockone.io/article/126\" title=\"八个Docker的真实应用场景\" target=\"_blank\" rel=\"noopener noreferrer\">八个Docker的真实应用场景</a></p>\n<p><a href=\"https://blog.csdn.net/julien71/article/details/79760919\" title=\"docker pull很慢解决办法、配置阿里镜像\" target=\"_blank\" rel=\"noopener noreferrer\">docker pull很慢解决办法、配置阿里镜像</a></p>\n<p><a href=\"https://www.cnblogs.com/zxtceq/p/7403953.html\" title=\"ASP.NET Core开发Docker部署\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET Core开发Docker部署</a></p>\n<h2>Docker学习记录</h2>\n<p>Docker Desktop 在windows 10下安装正常，Hyper-V也正常安装，但Hyper-V下无法打开虚拟交换机管理器，提示“尝试检索虚拟交换列表时出错”，也无法快速创建虚拟机，提示“xx异常”。事件查看器-&gt;Windows日志-&gt;系统中，Hyper-V-VmSwitch 一直提示 类似\"VMSwitch driver due to error\"</p>\n<p><a href=\"https://www.cnblogs.com/GeDiao/p/7975667.html\" title=\"Hyper-V管理器无法打开虚拟交换机管理，别人的方法，但无济于事\" target=\"_blank\" rel=\"noopener noreferrer\">Hyper-V管理器无法打开虚拟交换机管理，别人的方法，但无济于事</a></p>\n<p>别人都是说去在windows功能上打开Hyper-v即可，而我开启了一直不行，我这个主要是Hyper-V问题，导致Docker服务一直无法正常启动。微软的论坛也找了，没人能解决，说重装系统？这只能终极解决方案。下面这个链接，我也回答了一下。</p>\n<p><a href=\"https://social.msdn.microsoft.com/Forums/healthvault/zh-CN/cf5c267b-1ca0-40dd-9959-5ecb3475a06c/hyperv?forum=window10app\" title=\"hyperv 无法打开虚拟交换机管理器，报错“尝试检索虚拟交换机列表时出错\" target=\"_blank\" rel=\"noopener noreferrer\">hyperv 无法打开虚拟交换机管理器，报错“尝试检索虚拟交换机列表时出错</a></p>\n<p>后来找到解决办法，在设置-更新和安全-Windows预览体验计划，先去官网申请，申请后，升级系统，他会帮我修复Hyper-V.</p>\n<p>AMD 启用了虚拟化也无法使用,命令行设置hyper-v参数.管理员模式下的命令提示符中输入</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">bcdedit</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /set</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> hypervisorlaunchtype</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Auto</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>然后重启电脑，启动docker</p>\n<h2>docker运行aspnetcore项目</h2>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> unless-stopped</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 5020:80</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --name</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-web-1</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/lincms-web</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> unless-stopped</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 5021:80</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --name</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-web-2</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/lincms-web</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">docker</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --restart</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> unless-stopped</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -p</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> 5022:80</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> --name</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lincms-web-3</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -d</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> registry.cn-hangzhou.aliyuncs.com/igeekfan/lincms-web</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>docker 提示hype-v冲突，以管理员身份运行命令提示符 执行命令</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">bcdedit</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /set</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> hypervisorlaunchtype</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> off</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>重启，运行vm即可。</p>\n<p>如果想要恢复hyper启动</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">bcdedit</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> /set</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> hypervisorlaunchtype</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> auto</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div>",
      "date_published": "2022-06-29T19:17:23.000Z",
      "date_modified": "2022-06-29T19:17:23.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "在 ASP.NET Core 6 中添加Startup.cs的整洁方式",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/ASPNETCore6-Add-Startup-Clean.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/ASPNETCore6-Add-Startup-Clean.html",
      "summary": "https://www.talkingdotnet.com/clean-way-to-add-startup-class-in-asp-net-core-6-project/ 作者: Talking Dotnet 如果您关注ASP.NET Core 6，那么您可能发现，对于ASP.NET Core 6项目，没有Startup.cs文件。我发布了关于如何...",
      "content_html": "<blockquote>\n<ul>\n<li><a href=\"https://www.talkingdotnet.com/clean-way-to-add-startup-class-in-asp-net-core-6-project/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.talkingdotnet.com/clean-way-to-add-startup-class-in-asp-net-core-6-project/</a></li>\n<li>作者: Talking Dotnet</li>\n</ul>\n</blockquote>\n<p>如果您关注<code>ASP.NET Core 6</code>，那么您可能发现，对于<code>ASP.NET Core 6</code>项目，没有<code>Startup.cs</code>文件。我发布了关于<a href=\"https://igeekfan.cn/dotnetcore/examples/NET6Startup.html\" target=\"_blank\" rel=\"noopener noreferrer\">如何在ASP.NETCore 6项目中添加Startup.cs</a>，这种方法以传统的方式将类引入到项目中，这是我们今天使用的<code>ASP.NET Core 5</code>及其早期版本。但是，如果我们能够改进，让它变得更好呢。好的，在这篇文章中，让我们看一看在<code>ASP.NET Core6</code>中添加<code>Startup</code>类的整洁方法</p>\n<p>为了以整洁的方式实现，我们将利用<a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/extension-methods\" target=\"_blank\" rel=\"noopener noreferrer\">扩展方法</a>。扩展方法允许您向现有类型“添加”方法，而无需创建新的派生类型、重新编译或以其他方式修改原始类型。<code>ASP.NET Core 6.0</code>使用和来引导<code>ASP.NET Core应用程序</code>。因此，我们将为这二个(<code>WebApplicationBuilder</code>、<code>WebApplication</code>)类创建扩展方法</p>\n<p>记住，这2个是<code>ASP.NET Core 6.0</code>新引入的。阅读<a href=\"https://andrewlock.net/exploring-dotnet-6-part-2-comparing-webapplicationbuilder-to-the-generic-host/\" target=\"_blank\" rel=\"noopener noreferrer\">Comparing WebApplicationBuilder to the Generic Host</a>，并<a href=\"https://andrewlock.net/exploring-dotnet-6-part-3-exploring-the-code-behind-webapplicationbuilder/\" target=\"_blank\" rel=\"noopener noreferrer\">Exploring the code behind WebApplicationBuilder</a>以了解有关此新引导模型的更多信息。</p>\n<p>该类用于注册/配置服务或依赖项。由于扩展方法是静态方法，所以请使用名为的静态方法创建一个静态类。现在，将依赖项注册代码从移动到这里。如下</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RegisterStartupServices</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> WebApplicationBuilder</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> RegisterServices</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">this</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> WebApplicationBuilder</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddControllers</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // Learn more about configuring Swagger/OpenAPI at https://aka.ms/aspnetcore/swashbuckle</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddEndpointsApiExplorer</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddSwaggerGen</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>现在，让我们创建另一个静态类<code>RegisterStartupMiddlewares</code>，它扩展了用于中间件注册的类<code>WebApplication</code>。在这个类中，从中移动中间件注册码并将其引入方法。Program.cs中的<code>SetupMiddleware</code></p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RegisterStartupMiddlewares</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> WebApplication</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> SetupMiddleware</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">this</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> WebApplication</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // Configure the HTTP request pipeline.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Environment</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">IsDevelopment</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">())</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseSwagger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseSwaggerUI</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseHttpsRedirection</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseAuthorization</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">MapControllers</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>完成后，让我们返回到<code>Program.cs</code>中更新代码并使用这些扩展方法。如下</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> builder</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> WebApplication</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">args</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">             .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterServices</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> app</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SetupMiddleware</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Run</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>或者，我们可以让他更加整洁，并将其排成一行，如下</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">WebApplication</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">args</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterServices</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SetupMiddleware</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Run</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>现在，这看起来更加清晰、可读和易于管理。就是这么简单。</p>\n<h2>源码</h2>\n<ul>\n<li><a href=\"https://github.com/luoyunchong/dotnetcore-examples/blob/master/999-Others/NET6/NET6Extensions/Program.cs\" target=\"_blank\" rel=\"noopener noreferrer\">dotnetcore-examples/Program.cs at master · luoyunchong/dotnetcore-examples (github.com)</a></li>\n</ul>\n",
      "date_published": "2022-06-13T14:06:43.000Z",
      "date_modified": "2022-06-13T15:26:37.000Z",
      "authors": [
        {
          "name": "Talking Dotnet"
        }
      ],
      "tags": [
        "ASP.NET Core"
      ]
    },
    {
      "title": "在 ASP.NET Core 6 如何添加 Startup.cs",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/NET6Startup.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/NET6Startup.html",
      "summary": "原文：https://www.talkingdotnet.com/how-to-add-startup-cs-in-asp-net-core-6-project/#more-8202 作者: Talking Dotnet 使用 ASP.NET Core 6.0项目，您将找不到Startup.cs文件。默认情况下，此文件将被删除，并且是将注册依赖项和中间...",
      "content_html": "<blockquote>\n<ul>\n<li>原文：<a href=\"https://www.talkingdotnet.com/how-to-add-startup-cs-in-asp-net-core-6-project/#more-8202\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.talkingdotnet.com/how-to-add-startup-cs-in-asp-net-core-6-project/#more-8202</a></li>\n<li>作者: Talking Dotnet</li>\n</ul>\n</blockquote>\n<p>使用 <code>ASP.NET Core 6.0</code>项目，您将找不到<code>Startup.cs</code>文件。默认情况下，此文件将被删除，并且是将注册依赖项和中间件放到了<code>Program.cs</code>中。但是，如果您是 <code>Startup.cs</code> 的粉丝或将项目升级到 <code>ASP.NET Core 6.0</code>，你可能仍想要使用 <code>Startup.cs</code> 文件。因此，在这篇文章中，让我们将了解如何在 <code>ASP.NET Core 6</code> 项目中添加 <code>Startup.cs</code></p>\n<p>使用 <code>ASP.NET Core 6.0</code>项目时，您的<code>Program.cs</code>文件可能会这样。<code>Program.cs</code>是 <a href=\"http://ASP.NET\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET</a> Core Web 6应用模板的文件</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> builder</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> WebApplication</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">args</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// Add services to the container.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddRazorPages</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> app</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// Configure the HTTP request pipeline.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">!</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Environment</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">IsDevelopment</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">())</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseExceptionHandler</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"/Error\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseHsts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseHttpsRedirection</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseStaticFiles</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseRouting</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseAuthorization</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">MapRazorPages</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Run</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>正如您在此处看到的，服务和中间件注册现在是此文件的一部分。而 <code>Statup.cs</code> 有 2 个方法 <code>ConfigureServices()</code> 和 <code>Configure()</code>，我们在方法 <code>ConfigureServices</code> 中注册依赖关系/服务，在 <code>Configure</code> 中注册中间件。</p>\n<p>现在使用 <code>Program.cs</code>，您需要在第 4 行之后注册您的服务/依赖项<code>builder.Services.AddRazorPages();</code>，并在第 6 行之后注册中间件<code>var app = builder.Build();</code>。请记住，在管道中注册中间件时，顺序很重要。</p>\n<p>若要将 <code>Startup.cs</code> 添加到 <code>ASP.NET Core 6.0</code> 项目中 ，请添加一个名为<code>Startup.cs</code>的新文件 并添加以下代码。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Startup</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IConfiguration</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Configuration</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IConfiguration</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ConfigureServices</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IServiceCollection</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddRazorPages</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Configure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">WebApplication</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IWebHostEnvironment</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> env</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">!</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Environment</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">IsDevelopment</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">())</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseExceptionHandler</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"/Error\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseHsts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseHttpsRedirection</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseStaticFiles</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseRouting</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseAuthorization</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">MapRazorPages</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Run</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>构造函数和这两个方法中的代码是非常熟悉。从文件<code>Program.cs</code>中删除依赖项注册的代码并将其放入<code>ConfigureService()</code>方法中。同样，中间件注册码也从文件中删除并放入<code>Configure()</code> 方法中。</p>\n<p>接下来，我们需要介绍 <code>Program.cs</code> 如何调用 <code>Startup.cs</code> 。因此，请将文件代码更新为以下内容。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> builder</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> WebApplication</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">args</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> startup</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ConfigureServices</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> app</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Configure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Environment</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>Startup.cs 类所需的所有对象都存在于 builder 对象中，因此我们可以将所需的对象传递给<code>ConfigureService()</code>和<code>Configure()</code>方法。就是这样。您的项目应该正常运行</p>\n<h2>我们还能做什么？</h2>\n<p>这是添加<code>Startup.cs</code>的自定义方式，因此实际上我们不必遵循任何与该类相关的内置规则。我从不喜欢<code>ConfigureService()</code>和<code>Configure()</code>这两个名称，因为它们并没有确切定义它们的用途。以前，无法重命名这些名称，但现在我可以给出一个有意义的名称。类似地，<code>ConfigureService</code>变成<code>RegisterServices</code>，<code>Configure</code>变成<code>SetupMiddleware</code>。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> startup</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterServices</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> app</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SetupMiddlewares</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Environment</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>源码</h2>\n<ul>\n<li><a href=\"https://github.com/luoyunchong/dotnetcore-examples/blob/master/999-Others/NET6/NET6Startup/Program.cs\" target=\"_blank\" rel=\"noopener noreferrer\">dotnetcore-examples/Program.cs at master · luoyunchong/dotnetcore-examples (github.com)</a></li>\n</ul>\n",
      "date_published": "2022-06-11T09:01:13.000Z",
      "date_modified": "2022-06-13T15:26:37.000Z",
      "authors": [
        {
          "name": "Talking Dotnet"
        }
      ],
      "tags": [
        "ASP.NET Core"
      ]
    },
    {
      "title": "AspNetCore Identity FreeSql的实现",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/freekit/AspNetCore.Identity.FreeSql.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/freekit/AspNetCore.Identity.FreeSql.html",
      "summary": "AspNetCore Identity FreeSql的实现 IGeekFan.AspNetCore.Identity.FreeSql 是asp.net core 6 的identity的freesql存储的实现 支持.NET 9.0 安装包 新增 FreeSql的Provider 相关包 扩展用户、角色 配置用户、角色的FulentAPI appse...",
      "content_html": "\n<h2>IGeekFan.AspNetCore.Identity.FreeSql</h2>\n<p>是<code>asp.net core 6</code> 的<code>identity</code>的<code>freesql</code>存储的实现</p>\n<ul>\n<li><a href=\"http://xn--ruu81c.NET\" target=\"_blank\" rel=\"noopener noreferrer\">支持.NET</a> 9.0</li>\n<li>安装包</li>\n</ul>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> add</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> package</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> IGeekFan.AspNetCore.Identity.FreeSql</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><ul>\n<li>新增 FreeSql的Provider 相关包</li>\n</ul>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> add</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> package</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> FreeSql.Provider.MySqlConnector</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h3>扩展用户、角色</h3>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IdentityUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Guid</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> FirstName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> LastName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AppRole</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IdentityRole</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Guid</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AppIdentityDbContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IdentityDbContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppRole</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Guid</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> AppIdentityDbContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IdentityOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">identityOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">DbContextOptions</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> options</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    : </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\">base</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">identityOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Value</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">options</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    protected</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> OnConfiguring</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">DbContextOptionsBuilder</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //这里直接指定一个静态的 IFreeSql 对象即可，切勿重新 Build()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    protected</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> OnModelCreating</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ICodeFirst</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> codefirst</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\">        base</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">OnModelCreating</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">codefirst</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //批量</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //codefirst.ApplyConfigurationsFromAssembly(typeof(AppUserConfiguration).Assembly);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        codefirst</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ApplyConfiguration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AppUserConfiguration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        codefirst</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ApplyConfiguration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AppRoleConfiguration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>配置用户、角色的FulentAPI</h3>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AppUserConfiguration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IEntityTypeConfiguration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Configure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">EfCoreTableFluent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Property</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">x</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> x</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">FirstName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">HasMaxLength</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">50</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Property</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">x</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> x</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">LastName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">HasMaxLength</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">50</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AppRoleConfiguration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IEntityTypeConfiguration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppRole</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Configure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">EfCoreTableFluent</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppRole</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>appsettings.json<br>\n该配置通过方法<code>UseConnectionString</code>读取如下配置</li>\n</ul>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"ConnectionStrings\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"MySql\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Data Source=localhost;Port=3306;User ID=root;Password=root;Initial Catalog=aspnetcoreidentity;Charset=utf8mb4;SslMode=none;Max pool size=1;Connection LifeTime=20\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>配置 Identity+FreeSql</h3>\n<ul>\n<li>新增一个扩展方法，引用 aspnetcore identity 相关服务</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IServiceCollection</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> AddFreeSqlIdentity</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">this</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IServiceCollection</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IConfiguration</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    Func</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IServiceProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSqlBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseConnectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DataType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">MySql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"ConnectionStrings:MySql\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">               //.UseNameConvert(NameConvertType.PascalCaseToUnderscoreWithLower)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseAutoSyncStructure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//自动同步实体结构到数据库，FreeSql不会扫描程序集，只有CRUD时才会生成表。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseMappingPriority</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">MappingPriorityType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">FluentApi</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">MappingPriorityType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Attribute</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">MappingPriorityType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Aop</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseMonitorCommand</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">cmd</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">                    Trace</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">cmd</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CommandText</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \";\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                })</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //软删除</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">GlobalFilter</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Apply</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ISoftDelete</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"IsDeleted\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">a</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> a</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsDeleted</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> false</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);      </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddSingleton</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddFreeRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddScoped</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UnitOfWorkManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    using</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> scope</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">BuildServiceProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateScope</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">())</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> orm</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> scope</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ServiceProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetRequiredService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //只有实例化了AppIdentityDbContext，才能正常调用OnModelCreating，不然直接使用仓储，无法调用DbContext中的OnModelCreating方法，配置的TodoConfiguration 就会没有生效</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddFreeDbContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppIdentityDbContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">options</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> options</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">orm</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> DbContextOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">                        EnableCascadeSave</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                    }));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddAuthentication</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">o</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        o</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DefaultScheme</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> IdentityConstants</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ApplicationScheme</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        o</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DefaultSignInScheme</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> IdentityConstants</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ExternalScheme</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    })</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddIdentityCookies</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">o</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { });</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddIdentityCore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">o</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">                o</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">SignIn</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">RequireConfirmedEmail</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> false</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">                o</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Stores</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">MaxLengthForKeys</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 128</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            })</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddRoles</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppRole</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddSignInManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddFreeSqlStores</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppIdentityDbContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddDefaultTokenProviders</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // 如果是MVC 另外安装包 &lt;PackageReference Include=\"Microsoft.AspNetCore.Identity.UI\" Version=\"6.0.7\" /&gt; 使用AddDefaultIdentity方法</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // services.AddDefaultIdentity&lt;AppUser&gt;(options =&gt; options.SignIn.RequireConfirmedAccount = true).AddRoles&lt;AppRole&gt;()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //        .AddFreeSqlStores&lt;AppIdentityDbContext&gt;().AddDefaultTokenProviders();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>软删除</h3>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> interface</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ISoftDelete</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    bool</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> IsDeleted</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>因为FreeSql只有运行时才会生成表,我们增加定义一个扩展方法</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// 自定义Scope 的Serivce 执行 DbContext中的OnModelCreating</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"serviceProvider\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IServiceProvider</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> RunScopeService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">this</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IServiceProvider</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> serviceProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //在项目启动时，从容器中获取IFreeSql实例，并执行一些操作：同步表，种子数据,FluentAPI等</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    using</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IServiceScope</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> serviceScope</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> serviceProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateScope</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">())</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> freeSql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> serviceScope</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ServiceProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetRequiredService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        using</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> dbContext</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> serviceScope</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ServiceProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetRequiredService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppIdentityDbContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        freeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CodeFirst</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SyncStructure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppRole</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IdentityUserLogin</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Guid</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IdentityUserRole</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Guid</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IdentityUserClaim</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Guid</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IdentityRoleClaim</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Guid</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IdentityUserToken</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Guid</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            );</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> serviceProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>在<code>Program</code>中Build后，我们执行此方法，以保证DbContext中的OnModelCreating生效</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">WebApplicationBuilder</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> builder</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> WebApplication</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">args</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddFreeSqlIdentity</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">WebApplication</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> app</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//自定义Scope 的Serivce 执行 DbContext中的OnModelCreating</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RunScopeService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ApiController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Route</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"api/[controller]\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AppUserController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ControllerBase</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ILogger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUserController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">_logger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> UserManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">_userManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IUserStore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">_userStore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IUserEmailStore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">_emailStore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SignInManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">_signInManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> AppUserController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ILogger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUserController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">logger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UserManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">userManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SignInManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">signInManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IUserStore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">userStore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        _logger</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> logger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        _userManager</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> userManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        _signInManager</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> signInManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        _userStore</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> userStore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        _emailStore</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> GetEmailStore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    private</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IUserEmailStore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetEmailStore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">!</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">_userManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">SupportsUserEmail</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            throw</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> NotSupportedException</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"The default UI requires a user store with email support.\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IUserEmailStore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;)</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">_userStore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// 创建用户示例</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"createAppUser\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">exception</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> cref</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"ArgumentException\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">exception</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpPost</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateUserAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromBody</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreateAppUser</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> createAppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        AppUser</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> user</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            FirstName</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> createAppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">FirstName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            LastName</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> createAppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">LastName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            EmailConfirmed</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> //直接让邮件激活</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">        await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _userStore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SetUserNameAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">user</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">createAppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Email</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CancellationToken</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">None</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">        await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _emailStore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SetEmailAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">user</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">createAppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Email</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CancellationToken</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">None</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> identityResult</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _userManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">user</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">createAppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Password</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">identityResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Succeeded</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            _logger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">LogInformation</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"User created a new account with password.\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //获取userid</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> userId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _userManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetUserIdAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">user</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //生成邮件激活码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> code</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _userManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GenerateEmailConfirmationTokenAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">user</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            code</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> WebEncoders</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Base64UrlEncode</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Encoding</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">UTF8</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetBytes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">code</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Results</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Ok</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Register Success\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //如果邮件 EmailConfirmed 为false时，通过此方式发送激活邮件</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //await _emailSender.SendEmailAsync(Input.Email, \"Confirm your email\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //    $\"Please confirm your account by &lt;a href='{HtmlEncoder.Default.Encode(callbackUrl)}'&gt;clicking here&lt;/a&gt;.\");</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">identityResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Errors</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> null</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            throw</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ArgumentException</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"identityResult.Errors should not be null.\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> errorMsg</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Join</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">','</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">identityResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Errors</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Description</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        _logger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">LogInformation</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">errorMsg</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Results</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">BadRequest</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">errorMsg</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// 登录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"userLoginInfo\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpPost</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"login\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">LoginAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromBody</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UserLoginInput</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> userLoginInfo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        _logger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">LogInformation</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"JwtLogin Begin\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> result</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _signInManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">PasswordSignInAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">userLoginInfo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Email</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">userLoginInfo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Password</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">userLoginInfo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">RememberMe</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">lockoutOnFailure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">false</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">result</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Succeeded</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            AppUser</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> user</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _userManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">FindByEmailAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">userLoginInfo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Email</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //创建Token等等</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> token</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Guid</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">NewGuid</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            _logger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">LogInformation</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">$\"User {</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">userLoginInfo</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">},Login Success\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Results</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Ok</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">token</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        else</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Results</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">BadRequest</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">result</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// 创建用户实体</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"FirstName\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">姓</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"LastName\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">名</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"Email\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">邮件、登录名</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"Password\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">密码</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> record</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> CreateAppUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FirstName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LastName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Email</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Password</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"Email\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">邮件、登录名</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"Password\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">密码</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"RememberMe\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">记住密码</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> record</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> UserLoginInput</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Email</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Password</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">bool</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RememberMe</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2022-06-02T18:18:50.000Z",
      "date_modified": "2025-04-28T17:01:11.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "FreeKit 基础包",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/freekit/Core.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/freekit/Core.html",
      "summary": "FreeKit 基础包 安装 IGeekFan.FreeKit 该项目无任何依赖 实体审计类 仅包含一些基础的审计类 IEntity 主键Id IEntityDto ICreateAuditEntity 使用此接口可存储创建者信息（创建者id，创建人，创建时间） IUpdateAuditEntity 使用此接口可存储删除信息（删除人id，删除人，删除时...",
      "content_html": "\n<h2>安装 IGeekFan.FreeKit</h2>\n<p>该项目无任何依赖</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> add</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> package</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> IGeekFan.FreeKit</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h3>实体审计类</h3>\n<p>仅包含一些基础的审计类</p>\n<ul>\n<li>IEntity 主键Id</li>\n<li>IEntityDto</li>\n<li>ICreateAuditEntity 使用此接口可存储创建者信息（创建者id，创建人，创建时间）</li>\n<li>IUpdateAuditEntity 使用此接口可存储删除信息（删除人id，删除人，删除时间）</li>\n<li>IDeleteAuditEntity 使用此接口可存储最后更新信息（最后修改人Id，修改人，修改时间）</li>\n<li>ISoftDelete 软删除标志</li>\n<li><code>IFullAuditEntity&lt;TKey,UKey&gt;</code>继承<code>IEntity&lt;TKey&gt;</code>, <code>ICreateAuditEntity&lt;UKey&gt;</code>, <code>IUpdateAuditEntity&lt;UKey&gt;</code>, <code>IDeleteAuditEntity&lt;UKey&gt;</code></li>\n<li>ITenant 多租户Id</li>\n</ul>\n<h3>依赖注入接口</h3>\n<p>只是空接口</p>\n<ul>\n<li>ITransientDependency（瞬时）</li>\n<li>IScopedDependency（请求范围）</li>\n<li>ISingletonDependency（单例）</li>\n</ul>\n<h3>Attribute</h3>\n<ul>\n<li>DisableConventionalRegistrationAttribute 禁用默认的注册机制</li>\n</ul>\n",
      "date_published": "2022-06-02T18:18:50.000Z",
      "date_modified": "2022-08-15T16:21:26.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Email 邮件",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/freekit/Email.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/freekit/Email.html",
      "summary": "Email 邮件 IGeekFan.FreeKit.Email 该包是一个独立的开发包，内部由MailKit实现发送邮件。 安装包 1).通过配置文件配置Email服务 ConfigureServices方法 appsettings.json 2).或通过回调函数配置 业务逻辑 简单的实体，在发送之前应验证必填项、密码强度和邮件格式等",
      "content_html": "\n<h2>IGeekFan.FreeKit.Email</h2>\n<p>该包是一个独立的开发包，内部由MailKit实现发送邮件。</p>\n<ol>\n<li>安装包</li>\n</ol>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> add</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> package</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> IGeekFan.FreeKit.Email</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>1).通过配置文件配置Email服务</p>\n<ul>\n<li>ConfigureServices方法</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddEmailSender</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><ul>\n<li>appsettings.json</li>\n</ul>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">  \"MailKitOptions\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">:{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"Host\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"smtp.163.com\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"Port\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"25\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"EnableSsl\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"DisplayName\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"天上月官方账号\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"UserName\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"igeekfan@163.com\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"Password\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"Domain\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  },</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>2).或通过回调函数配置</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddEmailSender</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Host</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"smtp.163.com\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Port</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 25</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">EnableSsl</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DisplayName</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"天上月官方账号\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">UserName</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"igeekfan@163.com\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Password</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Domain</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    });</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>业务逻辑</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> interface</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IAccountService</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        Task</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> SendEmailCode</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">RegisterDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> registerDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AccountService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IAccountService</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IEmailSender</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _emailSender</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> MailKitOptions</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _mailKitOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> AccountService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            IEmailSender</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> emailSender</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            IOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">MailKitOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">options</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            _emailSender</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> emailSender</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            _mailKitOptions</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> options</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Value</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> SendEmailCode</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">RegisterDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> registerDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> message</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> MimeMessage</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            message</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">From</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Add</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> MailboxAddress</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">_mailKitOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">UserName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">_mailKitOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">UserName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            message</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">To</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Add</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> MailboxAddress</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">registerDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Nickname</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">registerDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Email</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            message</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Subject</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> $\"VVLOG-你的验证码是\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> uuid</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Guid</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">NewGuid</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">            await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> RedisHelper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SetAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"SendEmailCode-\"</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> registerDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Email</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">uuid</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">30</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> *</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 60</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> rand6Value</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Random</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Next</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">100000</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">999999</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            message</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Body</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> TextPart</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"html\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">                Text</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> $@\"{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">registerDto</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Nickname</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">},您好!&lt;/br&gt;你此次验证码如下，请在 30 分钟内输入验证码进行下一步操作。&lt;/br&gt;如非你本人操作，请忽略此邮件。&lt;/br&gt;{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">rand6Value</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">}\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">            await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _emailSender</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SendAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">message</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>简单的实体，在发送之前应验证必填项、密码强度和邮件格式等</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RegisterDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// 昵称</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Nickname</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// 密码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Password</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// 邮件</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Email</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; } </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">   }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2022-06-02T18:18:50.000Z",
      "date_modified": "2022-10-11T16:54:04.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "FreeKit Extras 扩展包",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/freekit/Extras.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/freekit/Extras.html",
      "summary": "FreeKit Extras 扩展包 该项目是基于 FreeSql 实现的一些扩展包、AOP 事务，当前用户，简化依赖注入 一些扩展包 审计类 简化 FreeSql 单库的配置：UseConnectionString 扩展方法 基于特性标签的 AOP 事务 基于接口的注入 ICurrentUser 当前登录人信息 批量注入以 Service 为后缀接口...",
      "content_html": "\n<p>该项目是基于 FreeSql 实现的一些扩展包、AOP 事务，当前用户，简化依赖注入</p>\n<h2>一些扩展包</h2>\n<ul>\n<li>审计类</li>\n<li>简化 FreeSql 单库的配置：UseConnectionString 扩展方法</li>\n<li>基于特性标签的 AOP 事务</li>\n<li>基于接口的注入</li>\n<li><code>ICurrentUser</code> 当前登录人信息</li>\n<li>批量注入以 Service 为后缀接口的服务，根据所在的程序集</li>\n<li>CaseQuery 支持 Get 请求参数 key，大小驼峰转换</li>\n<li>基于审计类的FreeSql仓储</li>\n<li>复合主键仓储</li>\n</ul>\n<h2>IGeekFan.FreeKit.Extras的依赖项</h2>\n<ul>\n<li>FreeSql.DbContext</li>\n<li>Autofac.Extensions.DependencyInjection</li>\n<li>Autofac.Extras.DynamicProxy</li>\n<li>Castle.Core.AsyncInterceptor</li>\n</ul>\n<p>根据自己访问数据库的不同，安装FreeSql对应的<a href=\"http://freesql.net/guide/install.html#packages\" target=\"_blank\" rel=\"noopener noreferrer\">Provider</a></p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> add</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> package</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> IGeekFan.FreeKit.Extras</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> add</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> package</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> FreeSql.Provider.Sqlite</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>统一注入服务</h2>\n<ul>\n<li>1.注入controller <code>UnitOfWorkActionFilter</code></li>\n<li>2.<code>IHttpContextAccessor</code>、及当前登录人（<code>ICurrentUser</code>）信息</li>\n<li>3.当前登录人上下文的accessor,方便中间件中获取当前登录人（<code>ICurrentUser</code>）信息</li>\n<li>4.审计仓储 <code>IAuditBaseRepository</code></li>\n<li>5.复合主键仓储 <code>IBaseRepository&lt;Entiy,TKey,UKey&gt;</code></li>\n<li>6 FreeSql中的<code>IBaseRepository</code>、<code>IBaseRepository&lt;,&gt;</code>、<code>UnitOfWorkManager</code></li>\n</ul>\n<ol start=\"0\">\n<li>注入MediatR</li>\n</ol>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>builder.Services.AddMediatR(cfg =&gt;</span></span>\n<span class=\"line\"><span>    cfg.RegisterServicesFromAssemblies(Assembly.GetExecutingAssembly(),typeof(Module1Startup).Assembly));</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>1.统一注入服务</p>\n<p>可指定用户主键类型，默认为Guid,支持TKey为<code>int,long,Guid</code>。比如：<code>typeof(long)</code></p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddFreeKitCore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>2.给controller 配置一个filtert,来支持controller级别的 <code>[Transactional]</code>特性事务</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddControllers</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">options</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    options</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Filters</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UnitOfWorkActionFilter</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">});</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>3.<code>UseCurrentUserAccessor</code>给ICurrentUserAccessor中的CurrentUser赋值,比如中间件租户Id的全局过滤器设置,在<code>UseAuthentication</code>后设置此中间件</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseAuthorization</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseAuthentication</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseCurrentUserAccessor</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>4 Autofac 配置</p>\n<ul>\n<li><code>UnitOfWorkModule</code>主要功能：自动注入以Service后缀的类，支持接口，类，并支持<code>[Transactional]</code>特性事务</li>\n<li><code>FreeKitModule</code>主要功能:继承三大接口<code>IScopedDependency</code> (范围)、<code>ISingletonDependency</code> (单例)、<code>ITransientDependency</code> (瞬时) 中任一接口，即可自动到容器中，支持接口，类</li>\n</ul>\n<p><code>IGeekFan.FreeKit.Web</code>,<code>Module1</code>,<code>Module2</code>为类库的名称</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Host</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseServiceProviderFactory</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AutofacServiceProviderFactory</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">())</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ConfigureContainer</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ContainerBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;((</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">webBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">containerBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">           Assembly</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">currentAssemblies</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> AppDomain</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CurrentDomain</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetAssemblies</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">FullName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Contains</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"IGeekFan.FreeKit.Web\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">||</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">FullName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Contains</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Module1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">||</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">FullName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Contains</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Module2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToArray</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        containerBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterModule</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> UnitOfWorkModule</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">currentAssemblies</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        containerBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterModule</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeKitModule</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">currentAssemblies</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    });</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>审计类</h3>\n<ul>\n<li><code>Entity&lt;T&gt;</code>、<code>Entity</code>，仅主键的实体类型,其中T为主键类型</li>\n<li><code>FullAuditEntity&lt;T, U&gt;</code> 包含审计实体基类,包含<strong>创建、修改、删除</strong>加主键等10个字段，其实T为当前主键类型，U为用户表主键类型</li>\n</ul>\n<h3>简化 FreeSql 单库的配置</h3>\n<p><code>UseConnectionString</code> 扩展方法，DefaultDB 配置 4 代表使用配置串 Sqlite。需要安装<code>FreeSql.Provider.Sqlite</code></p>\n<ul>\n<li>\n<p><code>DefaultDB</code>配置的值实际为<code>FreeSql.DataType</code>的枚举值,即0代表MySql，1代表SqlServer</p>\n</li>\n<li>\n<p><code>ProviderType</code>：同时安装同一种数据库provider时，通过设置ProviderType，指定具体要求的provider</p>\n</li>\n<li>\n<p>appsettings.json</p>\n</li>\n</ul>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"ConnectionStrings\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //\"ProviderType\": \"FreeSql.MySql.MySqlProvider`1,FreeSql.Provider.MySql\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //\"ProviderType\": \"FreeSql.MySql.MySqlProvider`1,FreeSql.Provider.MySqlConnector\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //\"ProviderType\": \"FreeSql.Odbc.MySql.OdbcMySqlProvider`1,FreeSql.Provider.Odbc\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //\"ProviderType\": \"FreeSql.SqlServer.SqlServerProvider`1,FreeSql.Provider.SqlServer\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //\"ProviderType\": \"FreeSql.SqlServer.SqlServerProvider`1,FreeSql.Provider.SqlServerForSystem\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //\"ProviderType\": \"FreeSql.Oracle.OracleProvider`1,FreeSql.Provider.Oracle\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //\"ProviderType\": \"FreeSql.Oracle.OracleProvider`1,FreeSql.Provider.OracleOledb\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //\"ProviderType\": \"FreeSql.Odbc.Oracle.OdbcOracleProvider`1,FreeSql.Provider.Odbc\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"DefaultDB\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"4\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"DataType\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">        \"MySql\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">        \"SqlServer\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">        \"PostgreSQL\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">        \"Oracle\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">3</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">        \"Sqlite\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">4</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">     },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"MySql\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Data Source=localhost;Port=3306;User ID=root;Password=root;Initial Catalog=freekit;Charset=utf8mb4;SslMode=none;Max pool size=1;Connection LifeTime=20\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"SqlServer\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Data Source=.;User ID=sa;Password=123456;Integrated Security=True;Initial Catalog=LinCMS;Pooling=true;Min Pool Size=1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"PostgreSQL\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Host=localhost;Port=5432;Username=postgres;Password=123456; Database=lincms;Pooling=true;Minimum Pool Size=1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"Oracle\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"user id=user1;password=123456; data source=//127.0.0.1:1521/ORCL;Pooling=true;Min Pool Size=1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"Sqlite\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Data Source=|DataDirectory|/freekit.db; Attachs=freekit.db; Pooling=true;Min Pool Size=1\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>扩展方法配置 FreeSql，并设置 <code>ICurrentUserAccessor</code> 获取租户Id设置全局过滤器</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ServiceCollectionExtensions</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IServiceCollection</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> AddFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">this</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IServiceCollection</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IConfiguration</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> c</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        Func</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IServiceProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> currentAccessor</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetRequiredService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ICurrentUserAccessor</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSqlBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseConnectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">c</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseNameConvert</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">NameConvertType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">PascalCaseToUnderscoreWithLower</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseAutoSyncStructure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//自动同步实体结构到数据库，FreeSql不会扫描程序集，只有CRUD时才会生成表。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseGenerateCommandParameterWithLambda</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//默认false,针对 lambda 表达式解析,设置成true时方便查看SQL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseNoneCommandParameter</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//默认true,针对insert/update/delete是否参数化</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseMonitorCommand</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">cmd</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">                        Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\r\\n</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">线程\"</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Thread</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CurrentThread</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ManagedThreadId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \": \"</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> cmd</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CommandText</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                    })</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">GlobalFilter</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ApplyOnly</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ISoftDelete</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"IsDeleted\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">a</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> a</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsDeleted</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> false</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">GlobalFilter</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ApplyOnlyIf</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ITenant</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"TenantId\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, () </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> currentAccessor</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CurrentUser</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">?</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">TenantId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> !=</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> null</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">a</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> a</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">TenantId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> currentAccessor</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CurrentUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">TenantId</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            // 不使用IAuditBaseRepository的审计仓储 操作CRUD时，可使用此方式进行审计类的自动赋值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Aop</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">AuditValue</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> +=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">_</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">e</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">e</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AuditValue</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Guid</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">currentAccessor</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CurrentUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">); };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddSingleton</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddFreeKitCore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        using</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IServiceScope</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> scope</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">BuildServiceProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateScope</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">())</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> freeSql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> scope</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ServiceProvider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetRequiredService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //freeSql.CodeFirst.SyncStructure(ReflexHelper.GetTypesByTableAttribute(typeof(Program)));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            freeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CodeFirst</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SyncStructure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Song</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//Program.cs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> c</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">c</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>基于特性标签的 AOP 事务</h3>\n<p>该特性支持以Service为后缀的方法，并且需要继承接口</p>\n<ul>\n<li>\n<p>特性标签 <strong>[Transactional]</strong></p>\n</li>\n<li>\n<p><code>Propagation</code> 事务传播方式</p>\n<ul>\n<li>Required  如果当前没有事务，就新建一个事务，如果已存在一个事务中，加入到这个事务中，默认的选择。</li>\n<li>Supports 支持当前事务，如果没有当前事务，就以非事务方法执行</li>\n<li>Mandatory 使用当前事务，如果没有当前事务，就抛出异常。</li>\n<li>NotSupported 以非事务方式执行操作，如果当前存在事务，就把当前事务挂起。</li>\n<li>Never 以非事务方式执行操作，如果当前事务存在则抛出异常。</li>\n<li>Nested 以嵌套事务方式执行</li>\n</ul>\n</li>\n<li>\n<p><code>IsolationLevel</code> 事务隔离级别（默认为ReadCommitted）</p>\n<ul>\n<li>ReadUncommitted 该事务可以读取还未被别的事务提交的数据（脏读）</li>\n<li>ReadCommitted  (sql server的默认隔离) 事务只可读取到别的事务中已经被提交的(Committed)数据，避免了\"脏读\"</li>\n<li>RepeatableRead  (InnoDB 的默认隔离级别) 为了保证多次读取数据的一致性，解决不可重复读(non-repeatable reads)</li>\n<li>Serializable 为了解决\"幻读\"(Phantom reads)问题</li>\n</ul>\n</li>\n<li>\n<p>配置默认的事务级别（可不配置）</p>\n</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Configure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UnitOfWorkDefualtOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">c</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    c</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsolationLevel</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Data</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsolationLevel</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ReadCommitted</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//（默认为null时未指定时，依旧为null，根据数据库的事务隔离级别）</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    c</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Propagation</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Propagation</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Required</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//（默认为null时未指定时，则指定Required）</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">});</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>|数据库|默认隔离级别|<br>\n|</p>\n",
      "date_published": "2022-06-02T18:18:50.000Z",
      "date_modified": "2025-01-14T13:19:24.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Localization 本地化",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/freekit/Localization.FreeSql.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/freekit/Localization.FreeSql.html",
      "summary": "Localization 本地化 IGeekFan.Localization.FreeSql 基于数据库存储的本地化，可以让你的程序支持多语言，会创建二个表。 LocalCulture(本地化语言) LocalResource(资源) 可支持自定义长度，通过FluentAPI进行设置 安装包 配置FreeSql服务 定义扩展方法 appsettings...",
      "content_html": "\n<h2>IGeekFan.Localization.FreeSql</h2>\n<p>基于数据库存储的本地化，可以让你的程序支持多语言，会创建二个表。</p>\n<h2>LocalCulture(本地化语言)</h2>\n<p>|类型|名称|长度|<br>\n|</p>\n",
      "date_published": "2022-06-02T18:18:50.000Z",
      "date_modified": "2022-08-24T20:14:02.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Modularity 模块化",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/freekit/Modularity.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/freekit/Modularity.html",
      "summary": "Modularity 模块化 单体模块化 https://github.com/thinktecture-labs/aspnetcore-modular-monolith 因为类名如 Autofac 和 aspnetcore 中的类相同，将类名修改成如下名称 Module.cs-->ModuleInfo.cs IStartup.cs-->IModule...",
      "content_html": "\n<h2>单体模块化</h2>\n<ul>\n<li><a href=\"https://github.com/thinktecture-labs/aspnetcore-modular-monolith\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/thinktecture-labs/aspnetcore-modular-monolith</a></li>\n</ul>\n<p>因为类名如 Autofac 和 aspnetcore 中的类相同，将类名修改成如下名称</p>\n<ul>\n<li>Module.cs--&gt;ModuleInfo.cs</li>\n<li>IStartup.cs--&gt;IModuleStartup.cs</li>\n</ul>\n<p>创建一个类库名 Module1，并引用 AspNetCore 包</p>\n<div class=\"language-xml line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"xml\" data-title=\"xml\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">   &lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">ItemGroup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\t\t&lt;</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">FrameworkReference</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#D19A66\"> Include</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Microsoft.AspNetCore.App\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">   &lt;/</span><span style=\"--shiki-light:#22863A;--shiki-dark:#E06C75\">ItemGroup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>集成接口，可在<code>ConfigureServices</code>中注入任何服务，在<code>Configure</code>方法中注入中间件</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Module1Startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IModuleStartup</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ConfigureServices</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IServiceCollection</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //services.AddSingleton&lt;ITestService, TestService&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Configure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IApplicationBuilder</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IWebHostEnvironment</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> env</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseEndpoints</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">endpoints</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            endpoints</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">MapGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"/TestEndpoint\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">                async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> context</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">                    await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> context</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Response</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Hello World from TestEndpoint in Module 1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                }).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RequireAuthorization</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        );</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>使用控制器</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Microsoft</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AspNetCore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Mvc</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Route</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"[module]/[controller]\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> TestController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Controller</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ActionResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Index</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"Hello World from TestController in Module 1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// InterModule</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"InterModule\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ActionResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">InterModule</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> $\"{</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">} in TestController in Module 1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>主程序<code>Program</code></li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// Register a convention allowing to us to prefix routes to modules.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddTransient</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IPostConfigureOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">MvcOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ModuleRoutingMvcOptionsPostConfigure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// Adds module1 with the route prefix module-1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddModule</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Module1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Module1Startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"module-1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// Adds module2 with the route prefix module-2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddModule</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Module2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Module2Startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"module-2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>注入中间件</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// Adds endpoints defined in modules</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> modules</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetRequiredService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IEnumerable</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ModuleInfo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">foreach</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> module</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> in</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> modules</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Map</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">$\"/{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">module</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">RoutePrefix</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseRouting</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        module</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Configure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">app</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Environment</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    });</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2022-06-02T18:18:50.000Z",
      "date_modified": "2022-06-02T18:18:50.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "FreeKit 指北",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/freekit/",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/freekit/",
      "summary": "FreeKit 指北 .NET YEARS Freekit 为.NET Core提供了更多的扩展实现 .NET IDE Rider GitHub license Nuget Packages BaGet Packages IGeekFan.AspNetCore.Identity.FreeSql 查看文档 IGeekFan.FreeKit AuditEn...",
      "content_html": "\n<div align=\"center\">\n<h2><img src=\"/images/dotnet-bot_skating.png\" width=\"100\"> .NET <img src=\"/images/dotnet-20-years.png\" width=\"80\"> YEARS</h2>\n<p><strong>Freekit</strong> <a href=\"http://xn--siq.NET\" target=\"_blank\" rel=\"noopener noreferrer\">为.NET</a> Core提供了更多的扩展实现</p>\n<p><a href=\"https://www.jetbrains.com/rider/\" target=\"_blank\" rel=\"noopener noreferrer\"><img src=\"https://img.shields.io/static/v1?style=float&amp;logo=rider&amp;label=Rider&amp;message=jetbrains&amp;color=red\" alt=\".NET IDE Rider\"></a><br>\n<a href=\"https://raw.githubusercontent.com/luoyunchong/IGeekFan.AspNetCore.RapiDoc/master/LICENSE\" target=\"_blank\" rel=\"noopener noreferrer\"><img src=\"https://img.shields.io/badge/license-MIT-blue.svg\" alt=\"GitHub license\"></a></p>\n</div>\n<h2>Nuget Packages</h2>\n<p>| Package name                           | Version                                                                                                                                                                                              | Downloads                                                                              |<br>\n|</p>\n",
      "image": "https://img.shields.io/static/v1?style=float&logo=rider&label=Rider&message=jetbrains&color=red",
      "date_published": "2022-06-02T18:18:50.000Z",
      "date_modified": "2022-08-15T16:21:26.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Blogs分享",
      "url": "https://igeekfan.cn/igeekfan-docs/blogs/",
      "id": "https://igeekfan.cn/igeekfan-docs/blogs/",
      "summary": "Blogs分享",
      "content_html": "\n",
      "date_published": "2022-01-07T10:07:15.000Z",
      "date_modified": "2022-01-07T10:07:15.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": ".NET 编码的基础知识",
      "url": "https://igeekfan.cn/igeekfan-docs/blogs/net-encoded-1.html",
      "id": "https://igeekfan.cn/igeekfan-docs/blogs/net-encoded-1.html",
      "summary": ".NET 编码的基础知识 .NET 编码的一些基本概念和分析 简单的类型概念 Hex （16 进制） byte 字节 范围是：0~255，二进制下的范围就是00000000~11111111，相当于 1 字节。 byte[] 字节数组 bit 比特，只有 2 种状态：0，1 1 字节 等于 8 比特 即1byte=8bit 在 c#中。Byte 即 b...",
      "content_html": "\n<p>.NET 编码的一些基本概念和分析</p>\n<h3>简单的类型概念</h3>\n<ul>\n<li>Hex （16 进制）</li>\n<li>byte 字节 范围是：<code>0~255</code>，二进制下的范围就是<code>00000000~11111111</code>，相当于 1 字节。</li>\n<li>byte[] 字节数组</li>\n<li>bit 比特，只有 2 种状态：0，1</li>\n</ul>\n<p><strong>1 字节 等于 8 比特</strong> 即<strong>1byte=8bit</strong></p>\n<p>在 c#中。Byte 即 byte，他是一个 struct 结构体，</p>\n<p>b1 等于 b2.</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">byte</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">byte</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b1</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 0xf</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//以0x开头 即16进制的写法</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">byte</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b2</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 15</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Assert</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Equal</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">b1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">b2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>错误的语法</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">byte</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b3</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> b1</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> b2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>正确的语法</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">byte</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b3</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">byte</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">b1</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> b2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//或</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> b4</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> b1</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> b2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>因为 byte 的相互运算太容易发生溢出，+ 加的重载 是 int 类型相加，所以结果是 int 类型</p>\n<h3>Encoding.UTF8.GetBytes</h3>\n<p>UTF8 是统一的编码方式，它是一种变长的编码方式.它可以使用 1~4 个字节表示一个符号，根据不同的符号而变化字节长度</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">byte</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">plaintext</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Encoding</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">UTF8</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetBytes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"0123456789\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>能得到什么样的数据，<strong>48,49,50,51,52,53,54,55,56,57</strong>。为什么？</p>\n<p>搜 ASCII 码，我们就知道 <code>0</code>的 ASCII 码是 <code>48</code></p>\n<p>如果是字母呢。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">byte</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">plaintext</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Encoding</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">UTF8</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetBytes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"ABCDabcd\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>能得到什么样的数据，<strong>65,66,67,68,97,98,99,100</strong>。为什么？还是因为 ASCII 码。UTF8 当然是兼容 ASCII 码。</p>\n<p>因为一个 ASCII 码，1 个字节就能表示 256 个状态，所以英文字母，阿拉伯数字，标点符号都不在话，哪如果是中文呢。这里我们就拿 UTF8 编码来分析。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>byte[]   plaintext = Encoding.UTF8.GetBytes(\"中国\");</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>如下内容，长度为 6，228，184，173 都是十进制。如果转成 16 进制呢。<strong>e4，b8，ad</strong>，如果分不清十六进制，建议学一下，计算机系统基础。当然，说明一下，<code>a</code>代表<code>10</code>，<code>e</code>即代表<code>14</code>.即<code>14*16+4=228</code>.表示时不区分大小写，即用大写<code>A</code>，和小写<code>a</code>都能表示<code>10</code></p>\n<p>| 列  | 十进制 | 十六进制 |<br>\n|</p>\n",
      "date_published": "2022-01-07T10:07:15.000Z",
      "date_modified": "2022-09-13T11:34:29.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": ".NET+Sqlite 如何支持加密",
      "url": "https://igeekfan.cn/igeekfan-docs/blogs/net-sqlite-encryption.html",
      "id": "https://igeekfan.cn/igeekfan-docs/blogs/net-sqlite-encryption.html",
      "summary": ".NET+Sqlite 如何支持加密 相关文章 FreeSql.Provider.SqliteCore 如何加密 Sqlite SQLite 来源于公共领域 SQLite Is Public Domain、 确保代码不会受到任何专有或许可内容的污染，没有任何来自互联网上的未知来源复制。即全是原创的。 虽然是免费的，无需许可证，可用于任何目的，但如果你的...",
      "content_html": "\n<h2>相关文章</h2>\n<ul>\n<li><a href=\"https://www.cnblogs.com/igeekfan/p/freesql-sqlitecore-SQLCipher.html\" target=\"_blank\" rel=\"noopener noreferrer\">FreeSql.Provider.SqliteCore 如何加密</a></li>\n</ul>\n<h2>Sqlite</h2>\n<p><code>SQLite</code> 来源于公共领域 <code>SQLite Is Public Domain</code>、<br>\n确保代码不会受到任何专有或许可内容的污染，没有任何来自互联网上的未知来源复制。即全是原创的。</p>\n<p>虽然是免费的，无需许可证，可用于任何目的，但如果你的公司必须要一个许可证，你也能申请授权<a href=\"https://sqlite.org/purchase/license\" target=\"_blank\" rel=\"noopener noreferrer\">https://sqlite.org/purchase/license</a>.</p>\n<p>但不支持<strong>加密</strong>。如果想支持登录加密，需要另外的扩展<strong>SQLite 加密扩展(SQLite Encryption Extension,)</strong>，具有读取/写入 AES 加密数据库的附加功能。具体授权可参考 <a href=\"https://www.sqlite.org/prosupport.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.sqlite.org/prosupport.html</a></p>\n<h2>Sqlite 加密</h2>\n<p>一直以来，<code>FreeSql</code>开发群中，总会有一些开发者来询问<code>Sqlite</code>加密的问题，事实上，官方提供的 Sqlite 加密功能是收费的。当连接串上使用<code>Password</code>时，会提示授权问题。<br>\n如果底层依赖于<code>System.Data.SQLite.Core</code>，</p>\n<div class=\"language-text line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"text\" data-title=\"text\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>Could not load file or assembly 'System.Data.SQLite.SEE.License,</span></span>\n<span class=\"line\"><span>Version=1.0.115.5, Culture=neutral, PublicKeyToken=433d9874d0bb98c5,</span></span>\n<span class=\"line\"><span>processorArchitecture=MSIL</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>如果底层依赖于<code>Microsoft.Data.Sqlite</code> 也会提示</p>\n<div class=\"language-text line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"text\" data-title=\"text\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>You specified a password in the connection string, but the native SQLite</span></span>\n<span class=\"line\"><span>library 'e_sqlite3' doesn't support encryption.</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>System.Data.SQLite.Core</h2>\n<p>创建一个控制台项目,起名 <code>OvOv.SqliteSystemCore</code></p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> new</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> console</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -n</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> OvOv.SqliteSystemCore</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> OvOv.SqliteSystemCore</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>安装包</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> add</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> package</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> System.Data.SQLite.Core</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>使用<code>SQLiteConnection</code>创建一个连接，使用 Password 指定密码</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Data</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SQLite</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Open</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> baseConnectionString</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"Data Source=local.db\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> connectionString</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SQLiteConnectionStringBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">baseConnectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Password</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"123qwe\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SQLiteConnection</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">? </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">connection</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SQLiteConnection</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">connectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    connection</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Open</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Open</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>运行项目</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>就会出现如下错误。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>System.IO.FileNotFoundException:“Could not load file or assembly</span></span>\n<span class=\"line\"><span>'System.Data.SQLite.SEE.License, Version=1.0.115.5, Culture=neutral, PublicKeyToken=433d9874d0bb98c5, processorArchitecture=MSIL'.</span></span>\n<span class=\"line\"><span>系统找不到指定的文件。”</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>Microsoft.Data.Sqlite</h2>\n<p>创建一个控制台项目,起名 <code>OvOv.SqliteMicrosoft</code></p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> new</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> console</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -n</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> OvOv.SqliteMicrosoft</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> OvOv.SqliteMicrosoft</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>安装包</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> add</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> package</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Microsoft.Data.Sqlite</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>使用<code>SqliteConnection</code>创建一个连接，使用 Password 指定密码</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Microsoft</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Data</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Sqlite</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Open</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> baseConnectionString</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"Data Source=local.db\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> connectionString</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SqliteConnectionStringBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">baseConnectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Mode</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> SqliteOpenMode</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ReadWriteCreate</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Password</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"123qwe\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SqliteConnection</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">? </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">connection</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SqliteConnection</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">connectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    connection</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Open</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Open</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>运行项目</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>就会出现如下错误。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>Unhandled exception. System.InvalidOperationException: You specified a password in the connection string,</span></span>\n<span class=\"line\"><span>but the native SQLite library</span></span>\n<span class=\"line\"><span>'e_sqlite3' doesn't support encryption. at Microsoft.Data.Sqlite.SqliteConnection.Open()</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>其实微软已经提供了加密的方案。</p>\n<ul>\n<li><a href=\"https://docs.microsoft.com/zh-cn/dotnet/standard/data/sqlite/encryption?tabs=netcore-cli\" target=\"_blank\" rel=\"noopener noreferrer\">https://docs.microsoft.com/zh-cn/dotnet/standard/data/sqlite/encryption?tabs=netcore-cli</a></li>\n</ul>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> remove</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> package</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Microsoft.Data.Sqlite</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> add</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> package</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Microsoft.Data.Sqlite.Core</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> add</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> package</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> SQLitePCLRaw.bundle_e_sqlcipher</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>重新运行项目 ，就会发现，他正常执行。没有任何报错。</p>\n<p>有关使用不同的本机库进行加密的详细信息，请参阅<a href=\"https://docs.microsoft.com/zh-cn/dotnet/standard/data/sqlite/custom-versions?tabs=netcore-cli\" target=\"_blank\" rel=\"noopener noreferrer\">自定义 SQLite 版本</a>。</p>\n<p>我们从 自定义 SQLite 版本上可以看到。</p>\n<p>默认情况下，主 <code>Microsoft.Data.Sqlite</code> 包引入 <code>SQLitePCLRaw.bundle_e_sqlite3</code>。 若要使用不同的捆绑，请改为安装 <code>Microsoft.Data.Sqlite.Core</code> 包以及要使用的捆绑包。</p>\n<h4><code>SQLitePCLRaw.bundle_e_sqlcipher</code></h4>\n<p>提供 SQLCipher 的<strong>非官方开放源代码内部版本</strong>。此版本支持<strong>加密</strong>。</p>\n<h3><a class=\"header-anchor\" href=\"#ado-net-修改-sqlite-密码\"><span></span></a><a href=\"http://ADO.NET\" target=\"_blank\" rel=\"noopener noreferrer\">ADO.NET</a> 修改 Sqlite 密码</h3>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> UpdatePassword</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> oldPassword</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> newPassword</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> baseConnectionString</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"Data Source=local.db\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> connectionString</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SqliteConnectionStringBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">baseConnectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Mode</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> SqliteOpenMode</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ReadWriteCreate</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Password</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> oldPassword</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    using</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> connection</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SqliteConnection</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">connectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        connection</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Open</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        using</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> command</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> connection</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateCommand</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">())</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            command</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CommandText</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"SELECT quote($newPassword);\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            command</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Parameters</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddWithValue</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"$newPassword\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">newPassword</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> quotedNewPassword</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> command</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteScalar</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">() </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">as</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            command</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CommandText</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"PRAGMA rekey = \"</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> +</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> quotedNewPassword</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            command</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Parameters</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Clear</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> x</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> command</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteNonQuery</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> x</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> oldPassword</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"123qwe\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> newPassword</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"abcd\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UpdatePassword</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">oldPassword</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">newPassword</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4>完整代码</h4>\n<ul>\n<li><a href=\"https://github.com/luoyunchong/dotnetcore-examples/blob/master/Database-Drivers/OvOv.SqliteMicrosoftCore/Program.cs\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/dotnetcore-examples/blob/master/Database-Drivers/OvOv.SqliteMicrosoftCore/Program.cs</a></li>\n</ul>\n",
      "date_published": "2022-01-07T10:07:15.000Z",
      "date_modified": "2022-09-13T11:34:29.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Serilog指北",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/serilog-tutorial.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/serilog-tutorial.html",
      "summary": "Serilog指北 原文：https://blog.datalust.co/serilog-tutorial/#3eventsandlevels github: https://github.com/serilog/serilog 1.概述 serilog是一个完全结构化事件的简单.NET日志记录 fully-structured,结构化 支持多种Pr...",
      "content_html": "\n<ul>\n<li>原文：<a href=\"https://blog.datalust.co/serilog-tutorial/#3eventsandlevels\" target=\"_blank\" rel=\"noopener noreferrer\">https://blog.datalust.co/serilog-tutorial/#3eventsandlevels</a></li>\n<li>github: <a href=\"https://github.com/serilog/serilog\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/serilog/serilog</a></li>\n</ul>\n<h3>1.概述</h3>\n<p>serilog是一个完全结构化事件的简单.NET日志记录</p>\n<p><code>fully-structured</code>,结构化</p>\n<ul>\n<li>支持多种Provider，可将日志推送到不同的中间件，如文件，数据库(mysql,sql server,mariadb等)</li>\n</ul>\n<h3>2. Hello, Serilog!</h3>\n<p>让我们从最简单的开始，跟随以下教程，你需要创建一个Console项目，<a href=\"http://xn--6kqx45gg2r.NET\" target=\"_blank\" rel=\"noopener noreferrer\">适用于.NET</a> FrameWork <a href=\"http://xn--0tr.NET\" target=\"_blank\" rel=\"noopener noreferrer\">和.NET</a> Core。</p>\n<p><code>Serilog</code> 通过 <code>NuGet</code>  分发包. 该项目以Serilog包为核心组织，配合许多 <code>sinks</code>（接收器） (超过上百!), 用于将事件写入终端,文件，数据库，日志服务器的插件中。</p>\n<p>我们从 <code>Serilog</code> 和 <code>Serilog.Sinks.Console</code>开始, 稍后再讨论其他选项:</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>Install-Package Serilog</span></span>\n<span class=\"line\"><span>Install-Package Serilog.Sinks.Console</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>以下是世界上最简单的 Serilog 配置：</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>using Serilog;</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>class Program</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    public static void Main(string[] args)</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        using (var log = new LoggerConfiguration()</span></span>\n<span class=\"line\"><span>            .WriteTo.Console()</span></span>\n<span class=\"line\"><span>            .CreateLogger())</span></span>\n<span class=\"line\"><span>        {</span></span>\n<span class=\"line\"><span>            log.Information(\"Hello, Serilog!\");</span></span>\n<span class=\"line\"><span>            log.Warning(\"Goodbye, Serilog.\");</span></span>\n<span class=\"line\"><span>        }</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>明确以下几点</p>\n<ul>\n<li><code>LoggerConfiguration</code> 类提供 了一个fluent 接口 构建一个日志管道</li>\n<li><code>WriteTo.Console() </code> 将一个控制台接收器 添加到管道中</li>\n<li><code>CreateLogger()</code> 集合构建后会 返回一个 <code>Logger</code> 对象, 他实现了 <code>ILogger</code>的接口</li>\n<li><code>Logger</code> 接口继承 <code>IDisposable</code>, 所以我们使用 <code>using</code> 块</li>\n<li>最后, <code>log.Information()</code> 和 <code>log.Warning()</code> 通过logger记录所有的发出的事件</li>\n</ul>\n<p>运行程序</p>\n<p><img src=\"https://note.youdao.com/yws/api/personal/file/261B46CA8E7E474D889CC2D6312BA39E?method=download&amp;shareKey=b47ca475a270339f81b8af4ba28a1954\" alt=\"image\"></p>\n<p>现在最迫切的问题是: 在我们的应用程序中，其他类如何得到这个Log对象? 除了通过参数进行传递, 有两种可能性</p>\n<ul>\n<li>如果您使用的是 <code>IoC</code> 容器, 你 可以使用组件接收<code>ILogger</code>对象，即通过 <code>dependency injection</code>(依赖注入)<code> ILogger</code>的方式使用. 像集成 <a href=\"https://github.com/nblumhardt/autofac-serilog-integration\" target=\"_blank\" rel=\"noopener noreferrer\">AutofacSerilogIntegration</a>等包即可。</li>\n</ul>\n<p>或者,你可以把Logger存储到一个已知的位置中;为此 <code>Serilog</code>有一个静态日志类</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Log</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Logger</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LoggerConfiguration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    .</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">WriteTo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateLogger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Log</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Information</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Hello again, Serilog!\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Log</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CloseAndFlush</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><code>Log</code> 类提供了与<code>ILogger</code>接口相同的所有方法.用于替换使用using 块,我们可以调用 <code>Log.CloseAndFlush()</code>，重置<code>Serilog.Log.Logger</code>,并释放原有的资源</p>\n<blockquote>\n<p>你可能选择基于<code>ILogger</code>的注入方式使用，或使用静态Log类 -这种选择是基于个人口味和爱好的问题. 为了保持简单 我们将在此教程中使用静态日志类。</p>\n</blockquote>\n<h3>3. 事件和级别</h3>\n<p>如果使用过<code>log4net</code>等较旧的库，在使<code>Serilog</code>时，您需要在思维方式上做的最大改变是从日志事件而不是日志消息的角度来思考。活动由以下部分组成：</p>\n<ul>\n<li>记录事件发生时的时间戳</li>\n<li>描述何时应捕获事件的级别</li>\n<li>记录事件所代表内容的消息</li>\n<li>描述事件的命名属性</li>\n<li>可能是一个异常对象</li>\n</ul>\n<p>您可以将日志事件格式化为控制台的可读文本，正如我们在第一个示例中看到的：</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>11:33:01 [INF] Hello, Serilog!</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>或者，您可以将同一事件格式化为JSON，并将其发送到远程日志服务器：</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>{\"@t\":\"2017-11-20T11:33:01.22138\",\"@m\":\"Hello, Serilog!\"}`</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>在幕后，应用程序中的日志语句创建LogEvent对象，而连接到管道的接收器则确定如何记录它们。</p>\n<h3>Logging levels</h3>\n<p><code>Serilog</code>速度很快，但始终构造和记录详细的日志事件可能会浪费CPU、磁盘和网络资源。为了管理这一点，<code>Serilog</code>事件被分配了调试、信息、警告和错误等级别。每个支持的级别都有一个<code>Log.*（）</code>方法。</p>\n<p>在开发过程中，可能会打开调试级别事件：</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>Log.Logger = new LoggerConfiguration()</span></span>\n<span class=\"line\"><span>    .MinimumLevel.Debug() // &lt;- Set the minimum level</span></span>\n<span class=\"line\"><span>    .WriteTo.Console()</span></span>\n<span class=\"line\"><span>    .CreateLogger();</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>// In a tight loop...</span></span>\n<span class=\"line\"><span>Log.Debug(\"Processing item {ItemNumber} of {ItemCount}\", itemNumber, itemCount);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>在生产中，通常关闭调试事件并将最低级别设置为信息，以便只记录重要事件。阅读文档中有关<code>Serilog</code>级别的<a href=\"https://github.com/serilog/serilog/wiki/Writing-Log-Events#log-event-levels\" target=\"_blank\" rel=\"noopener noreferrer\">更多信息</a>。</p>\n<h3>4. 发送和收集结构化数据</h3>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>var itemNumber = 10;</span></span>\n<span class=\"line\"><span>var itemCount = 999;</span></span>\n<span class=\"line\"><span>Log.Debug(\"Processing item {ItemNumber} of {ItemCount}\", itemNumber, itemCount);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>您注意到日志消息中的<code>{ItemNumber}</code>之类的命名占位符了吗？这不是C#插值字符串：Log.*（）方法接受消息模板，这是.NET格式字符串的一种变体，除了通常的{0}位置字符串外，还支持{Named}占位符。</p>\n<p>这似乎有点奇怪，直到您意识到，通过这样做，<code>Serilog</code>可以将消息的一部分作为一级属性与人性化文本一起捕获：</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    \"@t\": \"2017-11-20T11:33:01.22138\",</span></span>\n<span class=\"line\"><span>    \"@l\": \"Debug\",</span></span>\n<span class=\"line\"><span>    \"@m\": \"Processing item 10 of 999\",</span></span>\n<span class=\"line\"><span>    \"ItemNumber\": 10,</span></span>\n<span class=\"line\"><span>    \"ItemCount\": 999</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>我们为什么要这样做？由于日志事件附带了一些有趣的字段作为属性，因此我们可以立即使用简单的过滤器（如<code>ItemNumber&gt;900</code>）来查找事件，而不必通过正则表达式从消息中提取信息。</p>\n<p>更进一步，我们可以使用<code>@structure</code>捕获操作符不仅获取平面属性值，还获取完整的对象：</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>var user = new { Name = \"Nick\", Id = \"nblumhardt\" };</span></span>\n<span class=\"line\"><span>Log.Information(\"Logged on user {@User}\", user);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>在这里，用户对象被捕获到生成的JSON中，因此我们可以使用诸如<code>user.Id='nblumhardt'</code>之类的查询来查找事件：</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    \"@t\": \"2017-11-20T11:33:01.22138\",</span></span>\n<span class=\"line\"><span>    \"@m\": \"Logged on user {\\\"Name\\\": \\\"Nick\\\", \\\"Id\\\": \\\"nblumhardt\\\"}\",</span></span>\n<span class=\"line\"><span>    \"User\": {\"Name\": \"Nick\", \"Id\": \"nblumhardt\"}</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>生产监控和调试已经是一项艰巨、耗时且经常充满压力的任务：通常这些相关数据触手可及，<code>Serilog</code>消除了与操作相关 活动中最大的分歧之一。</p>\n<blockquote>\n<p>提示：从<code>VisualStudioMarketplace</code>安装了不起的<a href=\"https://marketplace.visualstudio.com/items?itemName=Suchiman.SerilogAnalyzer\" target=\"_blank\" rel=\"noopener noreferrer\">Serilog分析器</a>，以便在键入时检查消息模板语法</p>\n</blockquote>\n<p>这实际上会产生多大的差异，很大程度上取决于您如何从<code>Serilog</code>收集事件。传统上，日志事件进入文本文件并使用<code>grep</code>进行搜索。<code>Serilog</code>也可以记录文本文件，但您不能在记事本中执行<code>ItemNumber&gt;900</code>，因此您需要评估更强大的工具来实现这一点。</p>\n<h2>将事件写入JSON日志文件</h2>\n<p>如果您的需求很简单，可以将<code>JSON</code>写入日志文件，并使用<code>JSON</code>感知工具直接查询文件。<code>Serilog</code>的文件接收器和紧凑的<code>JSON</code>格式化程序使第一部分变得简单。让我们尝试另一个安装了以下软件包的小型控制台应用程序：</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>Install-Package Serilog;</span></span>\n<span class=\"line\"><span>Install-Package Serilog.Sinks.File</span></span>\n<span class=\"line\"><span>Install-Package Serilog.Formatting.Compact</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>在Main（）方法中：</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>Log.Logger = new LoggerConfiguration()</span></span>\n<span class=\"line\"><span>    .MinimumLevel.Debug()</span></span>\n<span class=\"line\"><span>    .WriteTo.File(new CompactJsonFormatter(), \"log.clef\")</span></span>\n<span class=\"line\"><span>    .CreateLogger();</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>var itemCount = 99;</span></span>\n<span class=\"line\"><span>for (var itemNumber = 0; itemNumber &lt; itemCount; ++itemNumber)</span></span>\n<span class=\"line\"><span>    Log.Debug(\"Processing item {ItemNumber} of {ItemCount}\", itemNumber, itemCount);</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>Log.CloseAndFlush();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>运行此应用程序将使用<code>Serilog</code>的压缩日志事件格式在<code>log.clef</code>中生成一个<a href=\"https://en.wikipedia.org/wiki/JSON_streaming\" target=\"_blank\" rel=\"noopener noreferrer\">新行分隔的<code>JSON</code>流</a>。（如果没有<code>CompactJsonFormatter</code>，我们将创建一个简单的平面日志文件。）</p>\n<p>如果在文本编辑器中打开该文件，您将看到JSON事件，如我们上面使用的示例。</p>\n<h3>将事件写入日志服务器</h3>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>Install-Package Serilog.Sinks.Seq</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>Log.Logger = new LoggerConfiguration()</span></span>\n<span class=\"line\"><span>    .MinimumLevel.Debug()</span></span>\n<span class=\"line\"><span>    .WriteTo.Seq(\"http://localhost:5341\")</span></span>\n<span class=\"line\"><span>    .CreateLogger();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>5.标记用于筛选和关联的事件</h3>\n<h4>增加固定属性</h4>\n<p>最简单的充实方法是向源自日志管道的所有事件添加固定属性值。这是使用记录器配置中的<code>Enrich.WithProperty()</code>完成的：</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>Log.Logger = new LoggerConfiguration()</span></span>\n<span class=\"line\"><span>    .Enrich.WithProperty(\"Application\", \"Demo\")</span></span>\n<span class=\"line\"><span>    .WriteTo.Seq(\"http://localhost:5341\")</span></span>\n<span class=\"line\"><span>    .CreateLogger();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>在<code>LogEvents</code>上，通过扩展添加的属性与源自消息模板的属性相同：</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    \"@t\": \"2017-11-20T11:33:01.22138\",</span></span>\n<span class=\"line\"><span>    \"@l\": \"Debug\",</span></span>\n<span class=\"line\"><span>    \"@m\": \"Processing item 10 of 999\",</span></span>\n<span class=\"line\"><span>    \"ItemNumber\": 10,</span></span>\n<span class=\"line\"><span>    \"ItemCount\": 999,</span></span>\n<span class=\"line\"><span>    \"Application\": \"Demo\"</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>这种策略有助于放大集中日志流中的特定日志源；以这种方式添加的属性包括应用程序、环境和版本等内容。</p>\n<h2>增加事件或记录器特定属性</h2>\n<p>通过创建和使用上下文记录器，可以将属性添加到一个或几个相关事件中，而不是使用相同的值丰富所有事件：</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>var orderLog = Log.ForContext(\"OrderId\", order.Id);</span></span>\n<span class=\"line\"><span>orderLog.Information(\"Looking up product codes\");</span></span>\n<span class=\"line\"><span>// ...</span></span>\n<span class=\"line\"><span>orderLog.Information(\"Product lookup took {Elapsed} ms\", elapsed.TotalMilliseconds);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>在这里，通过<code>orderLog</code>发出的两个事件都将附加<code>OrderId</code>属性。</p>\n<p>扩展是可添加的：如果<code>Application</code>属性设置在管道级别，则上面的第二个事件将携带经过（来自消息）、<code>OrderId</code>（来自上下文记录器）和<code>Application</code>（来自日志管道）。</p>\n<h3>丰富源类型信息</h3>\n<p>特定于记录器的充实的一个特例是如何用创建事件的类标记事件。</p>\n<p>在名为<code>HomeController</code>的类中，使用以下方法创建特定于类型的记录器：</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>private readonly ILogger _log = Log.ForContext&lt;HomeController&gt;();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>通过<code>_log</code>发出的事件将携带值为<code>MyApp.Controller.HomeController</code>的<code>SourceContext</code>属性。</p>\n<h3>丰富环境语境</h3>\n<p>为了丰富工作单元中引发的所有事件，<code>Serilog</code>提供了<code>LogContext</code>。首先需要在<code>LoggerConfiguration</code>级别使用<code>Enrich.FromLogContext()</code>启用此功能：</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>Log.Logger = new LoggerConfiguraition()</span></span>\n<span class=\"line\"><span>     .Enrich.FromLogContext()</span></span>\n<span class=\"line\"><span>     // ...</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><code>LogContext</code>可以看作是（键、值）对的堆栈；当从日志上下文中丰富事件时，这些事件将作为属性添加到事件中。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>using (LogContext.PushProperty(\"MessageId\", message.Id))</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    Log.Debug(\"Dispatching message of type {MessageType}\", message.GetType());</span></span>\n<span class=\"line\"><span>    await handler.HandleAsync(message);</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><code>LogContext</code>的有趣之处在于不需要传递任何信息。在示例代码中，<code>HandleAsync()</code>的实现以及它调用的任何其他方法都可以直接使用<code>Log</code>和<code>ILogger</code>、 <code>MessageId</code>属性将被提取并添加到后台。</p>\n<blockquote>\n<p>提示：<code>LogContext</code>是一个堆栈；推送到堆栈上的属性必须通过处理从<code>PushProperty()</code>返回的对象再次弹出-必须使用块。</p>\n</blockquote>\n",
      "image": "https://note.youdao.com/yws/api/personal/file/261B46CA8E7E474D889CC2D6312BA39E?method=download&shareKey=b47ca475a270339f81b8af4ba28a1954",
      "date_published": "2022-01-07T10:07:15.000Z",
      "date_modified": "2022-08-15T16:21:26.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "git emoji",
      "url": "https://igeekfan.cn/igeekfan-docs/blogs/git-emoji.html",
      "id": "https://igeekfan.cn/igeekfan-docs/blogs/git-emoji.html",
      "summary": "git emoji",
      "content_html": "\n<p>| emoji 图标            | emoji                         | 含义                         |<br>\n|</p>\n",
      "date_published": "2022-01-06T12:53:16.000Z",
      "date_modified": "2022-06-02T11:02:17.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Nacos 配置中心",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/nacos-aspnetcore.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/nacos-aspnetcore.html",
      "summary": "Nacos 配置中心 nacos 是一个构建云原生应用的动态服务发现、配置管理和服务管理平台。。 配置管理 asp.net core 中所有的配置项，如 appsetting.json 进行集中管理,支持热加载，支持服务发现。 nacos github https://github.com/alibaba/nacos csharp sdk github...",
      "content_html": "\n<p><code>nacos</code> 是一个构建云原生应用的动态服务发现、配置管理和服务管理平台。。</p>\n<h2>配置管理</h2>\n<p><a href=\"http://asp.net\" target=\"_blank\" rel=\"noopener noreferrer\">asp.net</a> core 中所有的配置项，如 appsetting.json 进行集中管理,支持热加载，支持服务发现。</p>\n<ul>\n<li>nacos github <a href=\"https://github.com/alibaba/nacos\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/alibaba/nacos</a></li>\n<li>csharp sdk github <a href=\"https://github.com/nacos-group/nacos-sdk-csharp\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/nacos-group/nacos-sdk-csharp</a></li>\n<li>csharp sdk 文档：<a href=\"https://nacos-sdk-csharp.readthedocs.io/en/latest/introduction/gettingstarted.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://nacos-sdk-csharp.readthedocs.io/en/latest/introduction/gettingstarted.html</a></li>\n<li><a href=\"https://nacos.io/zh-cn/\" target=\"_blank\" rel=\"noopener noreferrer\">https://nacos.io/zh-cn/</a></li>\n</ul>\n<p>安装请参考：<a href=\"https://nacos.io/zh-cn/docs/quick-start.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://nacos.io/zh-cn/docs/quick-start.html</a></p>\n<h3>开始</h3>\n<ul>\n<li>windows 进入 nacos 的 bin 目录，或把目录 <code>D:\\work\\tools\\nacos\\bin</code>（我本地）配置到环境变量中的 Path 中。</li>\n</ul>\n<p>即可在任意位置，执行命令</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">startup.cmd</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> -m</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> standalone</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><ul>\n<li>standalone 代表着单机模式运行，非集群模式</li>\n</ul>\n<div class=\"language-cmd line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cmd\" data-title=\"cmd\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">C:\\</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">WINDOWS</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\\</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">system32</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">startup.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">cmd</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> -</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">m</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> standalone</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"nacos is starting with standalone\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">         ,</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">--</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">       ,</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">--</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">'|</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">   ,</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">--</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,:  : |                                           Nacos </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">2.0.3</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,`</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">--</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">'`|  ' :                       ,</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2021-12-22T18:31:25.000Z",
      "date_modified": "2022-06-02T11:02:17.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "ASP.NETCore 下 FreeSql 的仓储事务",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/aspnetcore-repository-unitofwork.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/aspnetcore-repository-unitofwork.html",
      "summary": "ASP.NETCore 下 FreeSql 的仓储事务 第一步：配置 Startup.cs 注入 引入包 配置 Startup.cs 注入 appsettings.json TransBlogService.cs 完整的代码 Blog.cs Tag.cs TransBlogService.cs 以上使用的是泛型仓储，那我们如果是重写一个仓储 如何保持和...",
      "content_html": "\n<h4>第一步：配置 Startup.cs 注入</h4>\n<p>引入包</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">dotnet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> add</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> package</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> FreeSql</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">dotnet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> add</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> package</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DbContext</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">dotnet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> add</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> package</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Provider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">MySqlConnector</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>配置 Startup.cs 注入</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ConfigureServices</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IServiceCollection</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">  IConfigurationSection</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> Mysql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetSection</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Mysql\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSqlBuilder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseConnectionString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DataType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">MySql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Mysql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Value</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseAutoSyncStructure</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseNameConvert</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">NameConvertType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">PascalCaseToUnderscoreWithLower</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UseMonitorCommand</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">cmd</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Trace</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">cmd</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CommandText</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Build</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddSingleton</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddScoped</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UnitOfWorkManager</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddFreeRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">null</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Assembly</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //新增自己的服务，这里只有实现</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddScoped</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TransBlogService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>appsettings.json</li>\n</ul>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"Mysql\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Data Source=127.0.0.1;Port=3306;User ID=root;Password=root;Initial Catalog=ovov_freesql_repository;Charset=utf8;SslMode=none;Max pool size=10\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>| UnitOfWorkManager 成员                         | 说明                   |<br>\n|</p>\n",
      "date_published": "2021-12-12T10:05:43.000Z",
      "date_modified": "2022-06-02T11:02:17.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Autofac 依赖注入小知识",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/autofac.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/autofac.html",
      "summary": "Autofac 依赖注入小知识 控制反转/依赖注入 IOC/DI 依赖接口而不依赖于实现，是面向对象的六大设计原则（SOLID)之一。即依赖倒置原则(Dependence Inversion Principle) aspnetcore中的生命周期通常分为三种，具体如下 Singleton 单例（全局唯一实例） Scoped 范围 （在同一个生命周期内是...",
      "content_html": "\n<h2>控制反转/依赖注入 IOC/DI</h2>\n<p>依赖接口而不依赖于实现，是面向对象的六大设计原则（SOLID)之一。即依赖倒置原则(<code>Dependence Inversion Principle</code>)</p>\n<p>aspnetcore中的生命周期通常分为三种，具体如下</p>\n<ul>\n<li><code>Singleton</code> 单例（全局唯一实例）</li>\n<li><code>Scoped</code> 范围 （在同一个生命周期内是同一个实例）</li>\n<li><code>Transient</code> 瞬时（每次请求都是一个新的实例）</li>\n</ul>\n<p>Autofac命名有一些不同，但功能是一样的。</p>\n<ul>\n<li>Instance Per Dependency瞬时的</li>\n<li>Single Instance 单例</li>\n<li>Instance Per Lifetime Scope 作用域</li>\n</ul>\n<h3>Autofac 生命周期</h3>\n<ul>\n<li>Instance Per Dependency 瞬时</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Worker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">InstancePerDependency</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 如果不指定,默认就是InstancePerDependency</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Worker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>Instance Per Lifetime Scope 作用域</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 在同一个作用域中获得的是相同实例，在不同作用域获得的是不同实例</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Worker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">InstancePerLifetimeScope</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>Single Instance 单例</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 注册Worker类为SIngle Instance（单例），每次获取均返回同一个实例</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Worker</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SingleInstance</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>使用说明</h2>\n<p>创建<code>ASP.NET Core 3.0+</code>的项目，并安装<code>Autofac</code>包</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> add</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> package</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> Autofac.Extensions.DependencyInjection</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>在 Program 中 Host 主机指定 <code>.UseServiceProviderFactory(new AutofacServiceProviderFactory())</code>.</p>\n<p>UseServiceProviderFactory 调用 Autofac 提供程序,附加到通用宿主机制。</p>\n<div class=\"language-diff line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"diff\" data-title=\"diff\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">public class Program</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    public static void Main(string[] args)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        var host = Host.CreateDefaultBuilder(args)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#22863A;--shiki-dark:#98C379\">+       .UseServiceProviderFactory(new AutofacServiceProviderFactory())</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .ConfigureWebHostDefaults(webHostBuilder =&gt; {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            webHostBuilder</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .UseContentRoot(Directory.GetCurrentDirectory())</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .UseIISIntegration()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .UseStartup&lt;Startup&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        })</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .Build();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        host.Run();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>在 StartUp 中配置</p>\n<div class=\"language-diff line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"diff\" data-title=\"diff\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">public class Startup</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  public Startup(IConfiguration configuration)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    this.Configuration = configuration;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  public IConfiguration Configuration { get; private set; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#22863A;--shiki-dark:#98C379\">+  public ILifetimeScope AutofacContainer { get; private set; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  public void ConfigureServices(IServiceCollection services)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    services.AddOptions();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  // ConfigureContainer is where you can register things directly</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  // with Autofac. This runs after ConfigureServices so the things</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  // here will override registrations made in ConfigureServices.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  // Don't build the container; that gets done for you by the factory.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  public void ConfigureContainer(ContainerBuilder builder)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    // Register your own things directly with Autofac here. Don't</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    // call builder.Populate(), that happens in AutofacServiceProviderFactory</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    // for you.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#22863A;--shiki-dark:#98C379\">+    builder.RegisterModule(new MyApplicationModule());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  public void Configure(</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    IApplicationBuilder app,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    ILoggerFactory loggerFactory)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#22863A;--shiki-dark:#98C379\">+   this.AutofacContainer = app.ApplicationServices.GetAutofacRoot();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    loggerFactory.AddConsole(this.Configuration.GetSection(\"Logging\"));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    loggerFactory.AddDebug();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    app.UseMvc();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>定义注入实现</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> MyApplicationModule</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Autofac</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Module</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    protected</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Load</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ContainerBuilder</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">      builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpContextAccessor</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">As</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IHttpContextAccessor</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SingleInstance</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>注册泛型仓储</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterGeneric</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AuditBaseRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;&gt;)).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">As</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IAuditBaseRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;&gt;)).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">InstancePerLifetimeScope</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterGeneric</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AuditBaseRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;,&gt;)).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">As</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IAuditBaseRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;,&gt;)).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">InstancePerLifetimeScope</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>一个接口多个实现,使用 Named，区分、参数为字符串即可。</li>\n</ul>\n<p>注册服务</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IdentityServer4Service</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Named</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ITokenService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IdentityServer4Service</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Name</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">InstancePerLifetimeScope</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">JwtTokenService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Named</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ITokenService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">JwtTokenService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Name</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">InstancePerLifetimeScope</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>根据 Name 获取哪个服务</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ITokenService</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _tokenService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> AccountController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">IComponentContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> componentContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">IConfiguration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    bool</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> isIdentityServer4</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetSection</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Service:IdentityServer4\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Value</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">?</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToBoolean</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">() </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">??</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> false</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">    _tokenService</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> componentContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ResolveNamed</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ITokenService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">isIdentityServer4</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> ?</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IdentityServer4Service</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Name</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> :</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">JwtTokenService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Name</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>可通过 appsettings.json 中配置,可决定是哪个服务</p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">  \"Service\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"IdentityServer4\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">false</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>基于接口的注入</li>\n</ul>\n<p><code>AsImplementedInterfaces</code> Specifies that a type from a scanned assembly is registered as providing all of its implemented interfaces.<br>\n指定将扫描程序集中的类型注册为提供其所有实现的接口。</p>\n<p>根据接口<code>ITransientDependency</code>可以得到有哪些类继承了此接口，并判断是类，不是抽象类，不是泛型。</p>\n<p>所有继承类接口的类，将以接口的方式自动注入实例。可直接使用接口即可。</p>\n<ul>\n<li>InstancePerDependency 瞬时 （每次请求都是一个新的实例）</li>\n<li>InstancePerLifetimeScope 范围（在同一个生命周期内是同一个实例）</li>\n<li>SingleInstance 单例（全局唯一实例）</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> DependencyModule</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Autofac</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Module</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        protected</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Load</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ContainerBuilder</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            Assembly</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">currentAssemblies</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> AppDomain</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CurrentDomain</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetAssemblies</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">FullName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Contains</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"LinCms.\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToArray</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //每次调用，都会重新实例化对象；每次请求都创建一个新的对象；</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            Type</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> transientDependency</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ITransientDependency</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterAssemblyTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">currentAssemblies</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">t</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> transientDependency</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetTypeInfo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">IsAssignableFrom</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">t</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">&amp;&amp;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> t</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsClass</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> &amp;&amp;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> !</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">t</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsAbstract</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> &amp;&amp;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> !</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">t</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsGenericType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AsImplementedInterfaces</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">InstancePerDependency</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //同一个Lifetime生成的对象是同一个实例</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            Type</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> scopeDependency</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IScopedDependency</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterAssemblyTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">currentAssemblies</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">t</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> scopeDependency</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetTypeInfo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">IsAssignableFrom</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">t</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">&amp;&amp;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> t</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsClass</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> &amp;&amp;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> !</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">t</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsAbstract</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> &amp;&amp;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> !</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">t</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsGenericType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AsImplementedInterfaces</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">InstancePerLifetimeScope</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //单例模式，每次调用，都会使用同一个实例化的对象；每次都用同一个对象；</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            Type</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> singletonDependency</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ISingletonDependency</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterAssemblyTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">currentAssemblies</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">t</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> singletonDependency</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetTypeInfo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">IsAssignableFrom</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">t</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">&amp;&amp;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> t</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsClass</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> &amp;&amp;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> !</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">t</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsAbstract</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> &amp;&amp;!</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">t</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsGenericType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AsImplementedInterfaces</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SingleInstance</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>如果不写继承，如何批量注入呢。 1.类名有规则 2.基于特殊标签 3.继承接口。</p>\n<ul>\n<li>类名有规则<br>\n比如仓储后缀，全是<code>Repository</code>,其中<code>Assembly</code>为仓储的实现所在程序集。将自动注入所有的仓储，仓储必须有接口。</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    Assembly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> assemblysRepository</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Assembly</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Load</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"LinCms.Infrastructure\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterAssemblyTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">assemblysRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">a</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> a</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Name</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">EndsWith</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Repository\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AsImplementedInterfaces</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">InstancePerLifetimeScope</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>注入服务后就执行一段逻辑</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">MigrationStartupTask</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SingleInstance</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterBuildCallback</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">async</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">c</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">=&gt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> c</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Resolve</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">MigrationStartupTask</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">StartAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">());</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>动态代理</h3>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">dotnet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> add</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> package</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Autofac</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Extras</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DynamicProxy</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">dotnet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> add</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> package</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Castle</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Core</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">AsyncInterceptor</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>服务注册</li>\n</ul>\n<p>AOP+属性注入+以后缀为 Service 的服务实现，注入 Scope 范围的生命周期+启用接口的拦截器。</p>\n<ul>\n<li>使用<code>EnableInterfaceInterceptors</code>创建执行拦截的接口代理，</li>\n<li>使用<code>EnableClassInterceptors()</code> 动态对子类进行重写, 执行 virtual 方法的拦截</li>\n</ul>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UnitOfWorkInterceptor</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UnitOfWorkAsyncInterceptor</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">List</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Type</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">interceptorServiceTypes</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> List</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Type</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UnitOfWorkInterceptor</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Assembly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> servicesDllFile</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Assembly</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Load</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"LinCms.Application\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">RegisterAssemblyTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">servicesDllFile</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">a</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> a</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Name</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">EndsWith</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Service\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">&amp;&amp;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> !</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">a</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsAbstract</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> &amp;&amp;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> !</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">a</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsInterface</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> &amp;&amp;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> a</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsPublic</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AsImplementedInterfaces</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//接口注入</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">InstancePerLifetimeScope</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//生命周期：范围</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">PropertiesAutowired</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 属性注入</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">InterceptedBy</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">interceptorServiceTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToArray</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">())</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//声明拦截器</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">EnableInterfaceInterceptors</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">//启用接口的拦截器。</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>这二个类，请参考如下代码</p>\n<ul>\n<li>同步：UnitOfWorkInterceptor.cs <a href=\"https://github.com/luoyunchong/lin-cms-dotnetcore/blob/master/src/LinCms.Web/Middleware/UnitOfWorkInterceptor.cs\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/lin-cms-dotnetcore/blob/master/src/LinCms.Web/Middleware/UnitOfWorkInterceptor.cs</a></li>\n<li>异步拦截：UnitOfWorkAsyncInterceptor.cs <a href=\"https://github.com/luoyunchong/lin-cms-dotnetcore/blob/master/src/LinCms.Web/Middleware/UnitOfWorkInterceptor.cs\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/lin-cms-dotnetcore/blob/master/src/LinCms.Web/Middleware/UnitOfWorkInterceptor.cs</a></li>\n</ul>\n<p><code>Autofac.Extras.DynamicProxy</code>依赖 Castle.Core,即只支持同步方法的拦截。<br>\n异步方法的拦截需要安装包：<code>Castle.Core.AsyncInterceptor</code>。</p>\n<ul>\n<li>异步方法,分为有/无返回值：<code>async Task RunAsync()</code>,<code>asyn Task&lt;Result&gt; RunAsync()</code></li>\n<li>同步方法：<code>void Run()</code>,<code>Result Run()</code></li>\n</ul>\n<h3>同步拦截</h3>\n<p>1.定义拦截器</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> CallLogger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IInterceptor</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">  TextWriter</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _output</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">  public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> CallLogger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">TextWriter</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> output</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">    _output</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> output</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">  public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Intercept</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IInvocation</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> invocation</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    _output</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Write</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Calling method {0} with parameters {1}... \"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">      invocation</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Method</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Name</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">      string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Join</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\", \"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">invocation</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Arguments</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">a</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">a</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> ??</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToArray</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    invocation</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Proceed</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    _output</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Done: result was {0}.\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">invocation</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ReturnValue</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>2.注册拦截器。</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// Named registration</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Register</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">c</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> CallLogger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Out</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">       .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Named</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IInterceptor</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"log-calls\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// Typed registration</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">builder</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Register</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">c</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> CallLogger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Console</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Out</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>将拦截器与要拦截的类型 关联</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Intercept</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CallLogger</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">))]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> First</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">  public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> virtual</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> GetValue</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // Do some calculation and return a value</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// This attribute will look for a NAMED</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// interceptor registration:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Intercept</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"log-calls\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Second</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">  public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> virtual</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> GetValue</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // Do some calculation and return a value</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>链接</h2>\n<ul>\n<li>官网 <a href=\"https://autofac.org/\" target=\"_blank\" rel=\"noopener noreferrer\">https://autofac.org/</a></li>\n<li>GitHub <a href=\"https://github.com/autofac/Autofac\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/autofac/Autofac</a></li>\n<li>文档 <a href=\"https://autofac.readthedocs.io/en/latest/\" target=\"_blank\" rel=\"noopener noreferrer\">https://autofac.readthedocs.io/en/latest/</a></li>\n</ul>\n",
      "date_published": "2021-12-12T10:05:43.000Z",
      "date_modified": "2022-08-15T16:21:26.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "LinCms如何切换成SQL server",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/change-sqlserver.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/change-sqlserver.html",
      "summary": "LinCms如何切换成SQL server 需要修改LinCms.Web中的appsetting.json配置 数据库配置 DefaultDB：改成1 SqlServer：改成自己的数据库配置 Serilog配置 Using引用 \"Serilog.Sinks.MSSqlServer\",去掉 \"Serilog.Sinks.MariaDB\" 把 \"Name...",
      "content_html": "\n<p>需要修改LinCms.Web中的appsetting.json配置</p>\n<h3>数据库配置</h3>\n<p>DefaultDB：改成1<br>\nSqlServer：改成自己的数据库配置</p>\n<div class=\"language-diff line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"diff\" data-title=\"diff\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  \"ConnectionStrings\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B31D28;--shiki-dark:#E06C75\">-    \"DefaultDB\": \"0\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#22863A;--shiki-dark:#98C379\">+    \"DefaultDB\": \"1\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    \"DataType\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"MySql\": 0,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"SqlServer\": 1,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"PostgreSQL\": 2,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"Oracle\": 3,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"Sqlite\": 4</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    \"MySql\": \"Data Source=localhost;Port=3306;User ID=root;Password=rCsRedisoot;Initial Catalog=lincms;Charset=utf8mb4;SslMode=none;Max pool size=1;Connection LifeTime=20\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#22863A;--shiki-dark:#98C379\">+   \"SqlServer\": \"Data Source=.;User ID=sa;Password=123456;Integrated Security=True;Initial Catalog=LinCMS;Pooling=true;Min Pool Size=1\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  },</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>Serilog配置</h3>\n<p>Using引用  <code>\"Serilog.Sinks.MSSqlServer\"</code>,去掉<code> \"Serilog.Sinks.MariaDB\"</code></p>\n<p>把 <code>\"Name\"</code>为 <code>\"MariaDB\"</code>的json注释掉。</p>\n<p>把<code>\"Name\"</code>为 <code>\"MSSqlServer\"</code>的json注释去掉。</p>\n<p>并改掉<code>Args:connectionString</code>的连接串。</p>\n<div class=\"language-diff line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"diff\" data-title=\"diff\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    \"Serilog\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    \"Using\": [</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"Serilog.Sinks.Console\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"Serilog.Sinks.File\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B31D28;--shiki-dark:#E06C75\">-      \"Serilog.Sinks.MariaDB\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#22863A;--shiki-dark:#98C379\">+      \"Serilog.Sinks.MSSqlServer\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    ],</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    \"MinimumLevel\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"Default\": \"Information\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"Override\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        \"Microsoft\": \"Information\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        \"System\": \"Warning\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    \"WriteTo\": [</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        \"Name\": \"File\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        \"Args\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">          \"path\": \"Logs/log.txt\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">          \"rollingInterval\": \"Day\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        \"Name\": \"Console\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        \"Args\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">          \"theme\": \"Serilog.Sinks.SystemConsole.Themes.AnsiConsoleTheme::Code, Serilog.Sinks.Console\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">          \"outputTemplate\": \"[{Timestamp:HH:mm:ss} {Level:u3}] {Message:lj} &lt;s:{SourceContext}&gt;{NewLine}{Exception}\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B31D28;--shiki-dark:#E06C75\">-      {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        \"Name\": \"MariaDB\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        \"Args\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">          \"connectionString\": \"Data Source=localhost;Port=3308;User ID=root;Password=root;Initial Catalog=lincms;Charset=utf8mb4;SslMode=none;Max pool size=1;Connection LifeTime=20\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">          \"autoCreateTable\": true,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">          \"tableName\": \"app_serilog\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">          \"restrictedToMinimumLevel\": \"Information\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">          \"batchPostingLimit\": 4, //1000</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">          \"period\": \"0.00:00:03\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">          \"options\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            \"PropertiesToColumnsMapping\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">              \"Exception\": \"exception\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">              \"Level\": \"level\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">              \"Message\": \"message\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">              \"MessageTemplate\": \"message_template\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">              \"Properties\": \"properties\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">              \"Timestamp\": \"timestamp\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            \"TimestampInUtc\": false,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            \"ExcludePropertiesWithDedicatedColumn\": true,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            \"EnumsAsInts\": true,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            \"LogRecordsCleanupFrequency\": \"0.02:00:00\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            \"LogRecordsExpiration\": \"31.00:00:00\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">          }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B31D28;--shiki-dark:#E06C75\">-      }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#22863A;--shiki-dark:#98C379\">+      //{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //  \"Name\": \"MSSqlServer\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //  \"Args\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //    \"connectionString\": \"Data Source=.;User ID=sa;Password=123456;Integrated Security=True;Initial Catalog=LinCMS;Pooling=true;Min Pool Size=1\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //    \"restrictedToMinimumLevel\": \"Information\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //    \"sinkOptionsSection\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"tableName\": \"app_serilog\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"schemaName\": \"dbo\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"autoCreateSqlTable\": true,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"batchPostingLimit\": 1000,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"period\": \"0.00:00:15\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //    },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //    \"columnOptionsSection\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"disableTriggers\": true,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"clusteredColumnstoreIndex\": false,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"primaryKeyColumnName\": \"id\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"addStandardColumns\": [ \"LogEvent\" ],</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"removeStandardColumns\": [ \"Properties\" ],</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"additionalColumns\": [</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //          \"ColumnName\": \"event_type\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //          \"DataType\": \"int\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //          \"AllowNull\": true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //          \"ColumnName\": \"release\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //          \"DataType\": \"varchar\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //          \"DataLength\": 32</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //          \"ColumnName\": \"environment_user_name\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //          \"PropertyName\": \"UserName\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //          \"DataType\": \"varchar\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //          \"DataLength\": 50</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //          \"ColumnName\": \"all_sqlcolumn_defaults\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //          \"DataType\": \"varchar\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //          \"AllowNull\": true,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //          \"DataLength\": -1,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //          \"NonClusteredIndex\": false</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      ],</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"id\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        \"columnName\": \"id\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        \"nonClusteredIndex\": true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"level\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        \"columnName\": \"level\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        \"storeAsEnum\": true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      //\"Properties\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      //  \"columnName\": \"properties\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      //  \"excludeAdditionalProperties\": true,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      //  \"dictionaryElementName\": \"dict\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      //  \"itemElementName\": \"item\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      //  \"omitDictionaryContainerElement\": false,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      //  \"omitSequenceContainerElement\": false,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      //  \"omitStructureContainerElement\": false,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      //  \"omitElementIfEmpty\": true,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      //  \"propertyElementName\": \"prop\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      //  \"rootElementName\": \"root\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      //  \"sequenceElementName\": \"seq\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      //  \"structureElementName\": \"struct\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      //  \"usePropertyKeyAsElementName\": false</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      //},</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"TimeStamp\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        \"columnName\": \"timestamp\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        \"convertToUtc\": true,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        \"DataType\": \"tinyint\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"MessageTemplate\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        \"columnName\": \"message_template\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        \"convertToUtc\": true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"Timestamp\": \"timestamp\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"Exception\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        \"columnName\": \"exception\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"Message\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        \"columnName\": \"message\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      \"logEvent\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        \"columnName\": \"properties\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        \"excludeAdditionalProperties\": true,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //        \"excludeStandardColumns\": true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //      }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      //  }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#22863A;--shiki-dark:#98C379\">+      //}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    ]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>CAP配置</h3>\n<p>因为用了<code>CAP</code>。cap换<code>sql server</code>。这里改成 <code>DefaultStorage</code>改成2。</p>\n<p>如果Messqueue换rabbitmq的话，<code>DefaultMessageQueue</code>就改成1.然后配置 RabbitMQ</p>\n<div class=\"language-diff line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"diff\" data-title=\"diff\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  \"CAP\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B31D28;--shiki-dark:#E06C75\">-    \"DefaultStorage\": \"1\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#22863A;--shiki-dark:#98C379\">+    \"DefaultStorage\": \"2\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    \"DefaultMessageQueue\": \"0\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    \"Storage\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"InMemoryStorage\": 0,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"MySql\": 1,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"SqlServer\": 2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    \"MessageQueue\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"InMemoryQueue\": 0,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"RabbitMQ\": 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    \"RabbitMQ\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"HostName\": \"localhost\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"UserName\": \"admin\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"Password\": \"123456\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"Port\": 5672,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      \"VirtualHost\": \"/admin\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  },</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>双击<code>LinCms.Application</code>项目,注释掉<code>DotNetCore.CAP.MySql</code>的引用，引用 SqlServer的包</p>\n<div class=\"language-diff line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"diff\" data-title=\"diff\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\t&lt;ItemGroup&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\t\t&lt;PackageReference Include=\"AspNet.Security.OAuth.Gitee\" Version=\"5.0.11\" /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\t\t&lt;PackageReference Include=\"AspNet.Security.OAuth.GitHub\" Version=\"5.0.11\" /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\t\t&lt;PackageReference Include=\"AspNet.Security.OAuth.QQ\" Version=\"5.0.11\" /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\t\t&lt;PackageReference Include=\"AutoMapper\" Version=\"10.1.1\" /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\t\t&lt;PackageReference Include=\"Autofac.Extensions.DependencyInjection\" Version=\"7.1.0\" /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B31D28;--shiki-dark:#E06C75\">-\t\t&lt;PackageReference Include=\"DotNetCore.CAP.MySql\" Version=\"5.1.3\" /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#22863A;--shiki-dark:#98C379\">+\t\t&lt;PackageReference Include=\"DotNetCore.CAP.SqlServer\" Version=\"5.1.3\" /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\t\t&lt;PackageReference Include=\"IdentityServer4\" Version=\"4.1.2\" /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\t\t&lt;PackageReference Include=\"DotNetCore.CAP\" Version=\"5.1.3\" /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\t\t&lt;PackageReference Include=\"IdentityModel\" Version=\"5.1.0\" /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\t\t&lt;PackageReference Include=\"MQiniu.Core\" Version=\"1.0.1\" /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\t\t&lt;PackageReference Include=\"Caching.CSRedis\" Version=\"3.6.60\" /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\t\t&lt;PackageReference Include=\"CSRedisCore\" Version=\"3.6.6\" /&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\t&lt;/ItemGroup&gt;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>打开<code>LinCms.Application</code>项目中的<code>CapUnitOfWorkExtensions.cs</code>文件</p>\n<p>修改方法<code>BeginTransaction</code></p>\n<div class=\"language-diff line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"diff\" data-title=\"diff\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">public static ICapTransaction BeginTransaction(this IUnitOfWork unitOfWork, ICapPublisher publisher, bool autoCommit = false)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    //看了源码，换了新的写法，换不同的数据库，就需要手动修改这段代码了（MySqlCapTransaction）</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    //publisher.Transaction.Value = (ICapTransaction)publisher.ServiceProvider.GetService(typeof(ICapTransaction));新版本只能得到nul</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B31D28;--shiki-dark:#E06C75\">-   publisher.Transaction.Value = ActivatorUtilities.CreateInstance&lt;MySqlCapTransaction&gt;(publisher.ServiceProvider);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#22863A;--shiki-dark:#98C379\">+   publisher.Transaction.Value = ActivatorUtilities.CreateInstance&lt;SqlServerCapTransaction&gt;(publisher.ServiceProvider);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2021-12-12T10:05:43.000Z",
      "date_modified": "2021-12-22T18:31:25.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "LinCms.Scaffolding 代码生成器",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/lincms-scaffolding.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/lincms-scaffolding.html",
      "summary": "LinCms.Scaffolding 代码生成器 https://github.com/luoyunchong/lin-cms-dotnetcore/tree/dev 打开项目 LinCms.Scaffolding.sln。 看到 appsettings.json 配置如下 完成一个简单的表的 CRUD，只需要，创建一个实体类，修改一下上面的配置项，即...",
      "content_html": "\n<p><a href=\"https://github.com/luoyunchong/lin-cms-dotnetcore/tree/dev\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/lin-cms-dotnetcore/tree/dev</a></p>\n<p>打开项目 LinCms.Scaffolding.sln。</p>\n<p>看到 appsettings.json 配置如下</p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"SettingOptions\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"ProjectName\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"LinCms\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"BaseDirectory\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"D:/code/github/lin-cms-dotnetcore/src/LinCms.Core/\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">    \"EntityFilePath\"</span><span style=\"--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FFFFFF;--shiki-dark-font-style:inherit\">:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"Entities/Base/Doc.cs\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"Areas\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Base\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"TemplatePath\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"./Templates\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"OutputDirectory\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"D:/code/github/lin-cms-dotnetcore/code-scaffolding\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>完成一个简单的表的 CRUD，只需要，创建一个实体类，修改一下上面的配置项，即可生成代码。</p>\n<ul>\n<li>BaseDirectory:BaseDirectory 请配置成 LinCms.Core 的项目路径。后缀要加/</li>\n</ul>\n<p>由于项目使用<strong>Microsoft.CodeAnalysis.CSharp</strong>解析出类的属性，需要知道项目的在哪个位置。</p>\n<p>另外，本项目，会根据 LinCms.Core.xml 中的内容解析出类和属性的注释。</p>\n<ul>\n<li>EntityFilePath 实体类所在文件位置</li>\n<li>Areas 区域模块名,eg:(Base)</li>\n<li>TemplatePath 相对路径，当前项目下的 Templates 目录,不需要修改</li>\n<li>OutputDirectory 生成的代码路径。可以是相对路径，也可以是绝对路径</li>\n</ul>\n<p>我们在 LinCms.Core 中的 Entities 中 Base 目录，新建一个类 Doc.cs，并写上注释信息，以便生成列表和表单。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">DataAnnotations</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Collections</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Generic</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Text</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Entities</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Base</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// 文档</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Doc</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FullAuditEntity</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// 文档名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Column</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">StringLength</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 50</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Name</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// 显示名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Column</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">StringLength</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 50</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> DisplayName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>我们可以根据需要，修改上面的配置信息。</p>\n<p>我们可以打开 Lincms 的项目。删除所有的 Docs 相关的代码。</p>\n<p>然后运行此代码生成器。即可生成所有 CRUD 代码。然后。代码会输出到此目录 <strong>\"D:/code/github/lin-cms-dotnetcore/code-scaffolding\"</strong>,</p>\n<p><img src=\"https://pic.downk.cc/item/5f1da73014195aa594ee9888.jpg\" alt=\"\"></p>\n<p>然后。我们将前五个代码，依次复制到项目中，因为可能覆盖现有的代码，所以不推荐将此代码的输出目录写成<strong>D:/code/github/lin-cms-dotnetcore/src</strong>。</p>\n<p>然后将最后一个 lin-cms-vue。按模块复制到自己项目中即可。</p>\n",
      "image": "https://pic.downk.cc/item/5f1da73014195aa594ee9888.jpg",
      "date_published": "2020-07-26T16:18:09.000Z",
      "date_modified": "2022-07-30T11:18:46.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Scriban 模板语言",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/scriban-README.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/scriban-README.html",
      "summary": "Scriban 模板语言 目录 【翻译】Scriban 是一种快速、强大、安全和轻量级的文本模板语言和.NET 引擎，具有解析 liquid 模板的兼容模式 【翻译】 Scriban language（ 待完成） 【翻译】Scriban runtime（ 待完成） 原文 Github：https://github.com/lunet-io/scriba...",
      "content_html": "\n<h3>目录</h3>\n<ul>\n<li><a href=\"https://www.cnblogs.com/igeekfan/p/13343331.html\" target=\"_blank\" rel=\"noopener noreferrer\">【翻译】Scriban 是一种快速、强大、安全和轻量级的文本模板语言和.NET 引擎，具有解析 liquid 模板的兼容模式</a></li>\n<li><a href=\"\">【翻译】 Scriban language（ 待完成）</a></li>\n<li><a href=\"\">【翻译】Scriban runtime（ 待完成）</a></li>\n<li>原文 Github：<a href=\"https://github.com/lunet-io/scriban#readme\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/lunet-io/scriban#readme</a></li>\n</ul>\n<p><a href=\"https://github.com/lunet-io/scriban/actions\" target=\"_blank\" rel=\"noopener noreferrer\"><img src=\"https://github.com/lunet-io/scriban/workflows/ci/badge.svg?branch=master\" alt=\"Build Status\"></a> <a href=\"https://coveralls.io/github/lunet-io/scriban?branch=master\" target=\"_blank\" rel=\"noopener noreferrer\"><img src=\"https://coveralls.io/repos/github/lunet-io/scriban/badge.svg?branch=master\" alt=\"Coverage Status\"></a> <a href=\"https://www.nuget.org/packages/Scriban/\" target=\"_blank\" rel=\"noopener noreferrer\"><img src=\"https://img.shields.io/nuget/v/Scriban.svg\" alt=\"NuGet\"></a></p>\n\n<p>Scriban 是一种快速、强大、<a href=\"http://xn--15q79ea762erongmcvqp2olx7ae8rfr2a92e2mno9h.NET\" target=\"_blank\" rel=\"noopener noreferrer\">安全和轻量级的文本模板语言和.NET</a> 引擎，具有解析<code>liquid</code>模板的兼容模式</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// Parse a scriban template</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> template</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Template</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Parse</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Hello {{name}}!\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> result</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> template</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Render</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Name</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"World\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> }); </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// =&gt; \"Hello World!\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>使用 Liquid 语言解析 Liquid 模板：</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// Parse a liquid template</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> template</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Template</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ParseLiquid</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Hello {{name}}!\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> result</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> template</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Render</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Name</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"World\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> }); </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// =&gt; \"Hello World!\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>语言非常通用，易于阅读和使用，类似于<a href=\"https://shopify.github.io/liquid/\" target=\"_blank\" rel=\"noopener noreferrer\">liquid</a> 模板:</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> template</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> Template</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Parse</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">@\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">&lt;ul id='products'&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">  {{ for product in products }}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">    &lt;li&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">      &lt;h2&gt;{{ product.name }}&lt;/h2&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">           Price: {{ product.price }}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">           {{ product.description | string.truncate 15 }}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">    &lt;/li&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">  {{ end }}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">&lt;/ul&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> result</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> template</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Render</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Products</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\"> this</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ProductList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> });</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><blockquote>\n<p><strong>注意</strong></p>\n<p>默认情况下, .NET 对象的属性和方法会自动以小写和<code>_</code>命名，这意味着像<code>MyMethodIsNice</code>这样的属性将被公开为<code>my_method_is_nice</code>.这是默认约定，最初是为了匹配<code>liquid</code>模板的行为。<br>\n如果要改变此行为，则需要使用 <a href=\"/igeekfan-docs/dotnetcore/lin-cms/doc/runtime.html#member-renamer\" target=\"_blank\"><code>MemberRenamer</code></a> 委托</p>\n</blockquote>\n<h2>特性</h2>\n<ul>\n<li>非常<strong>高效</strong>,<strong>快速</strong> 解析器和<strong>轻量级</strong>的运行时. 对 CPU 和垃圾收集器友好. 查看</li>\n<li><a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/benchmarks.md\" target=\"_blank\" rel=\"noopener noreferrer\">benchmarks</a>获取更多细节.</li>\n<li>由 Lexer / Parser 提供一个<strong>完整的抽象语法树，fast, versatile and robust(快速，通用且强大)</strong>, 比基于 regex 的解析器更高效\n<ul>\n<li>错误报告:能提供精确的源代码位置 ，包括(path, column and line)</li>\n<li><strong>将 AST 写入脚本文本的形式</strong>, 使用 <a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/runtime.md#ast-to-text\" target=\"_blank\" rel=\"noopener noreferrer\"><code>Template.ToText</code></a>, 可以操作内存中的脚本并将其重新保存到磁盘, 对于 <strong>roundtrip（往返）的脚本更新方案</strong>是有用的</li>\n</ul>\n</li>\n<li><strong>兼容<code>liquid</code></strong> 模板 可使用<code>Template.ParseLiquid</code> 方法\n<ul>\n<li>虽然 <code>liquid</code> 语言不如<code>scriban</code>强大, 但该模式从 <code>liquid</code> 则更容易地迁移至 <code>scriban</code></li>\n<li>在 <a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/runtime.md#ast-to-text\" target=\"_blank\" rel=\"noopener noreferrer\">AST to text</a> 模式下,将对模板<code>Template.ParseLiquid</code>进行解析，替换成<code>Template.ToText</code>,即可将<code>liquid</code> 脚本 转换成 <code>scriban</code> 脚本</li>\n<li>由于 liquid 语言没有严格定义 并且它有着不同版本的 liquid 语法，在使用 scriban 的 liquid 模板时会有一些限制, 查看此文档了解详情 <a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/liquid-support.md\" target=\"_blank\" rel=\"noopener noreferrer\">liquid support in scriban</a></li>\n</ul>\n</li>\n<li><strong>可扩展的运行时</strong> 提供许多扩展点</li>\n<li>支持 <code>async</code>/<code>await</code> 的脚本支持 (e.g <code>Template.RenderAsync</code>)</li>\n<li><a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/language.md#14-whitespace-control\" target=\"_blank\" rel=\"noopener noreferrer\">精确控制空白文本输出</a></li>\n<li><a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/language.md\" target=\"_blank\" rel=\"noopener noreferrer\">完整的语言特性</a> 包括 <code>if</code>/<code>else</code>/<code>for</code>/<code>while</code>, <a href=\"/igeekfan-docs/dotnetcore/lin-cms/doc/language.html#8-expressions\" target=\"_blank\">expressions</a> (<code>x = 1 + 2</code>), conditions... etc.</li>\n<li><a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/language.md#89-function-call-expression\" target=\"_blank\" rel=\"noopener noreferrer\">函数调用和管道</a> (<code>myvar | string.capitalize</code>)\n<ul>\n<li><a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/language.md#7-functions\" target=\"_blank\" rel=\"noopener noreferrer\">自定义函数</a> 通过<code>func</code>语句直接将函数自定义到语言中 通过<code>alias @ directive</code>可使用<strong>function pointers/delegates</strong></li>\n<li>从 runtime API 绑定 <a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/runtime.md#imports-functions-from-a-net-class\" target=\"_blank\" rel=\"noopener noreferrer\">.NET 自定义函数</a>，<a href=\"http://xn--jhqq1bn2s0qfzuhmx8d.NET\" target=\"_blank\" rel=\"noopener noreferrer\">并提供许多与.NET</a> 对象接口的<a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/runtime.md#the-scriptobject\" target=\"_blank\" rel=\"noopener noreferrer\">选项</a> 。</li>\n</ul>\n</li>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/doc/language.html#5-objects\" target=\"_blank\">Complex objects (复杂对象)</a> (javascript/json like objects <code>x = {mymember: 1}</code>) and <a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/language.md#6-arrays\" target=\"_blank\" rel=\"noopener noreferrer\">arrays</a> (e.g <code>x = [1,2,3,4]</code>)</li>\n<li>通常由<code>wrap</code>语句使用可以将 <a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/language.md#98-wrap-function-arg1argn--end\" target=\"_blank\" rel=\"noopener noreferrer\">a block of statements （语句块）</a> 传递给函数,</li>\n<li>一些<a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/builtins.md\" target=\"_blank\" rel=\"noopener noreferrer\">内置函数</a>:\n<ul>\n<li><a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/builtins.md#array-functions\" target=\"_blank\" rel=\"noopener noreferrer\"><code>arrays functions</code></a></li>\n<li><a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/builtins.md#date-functions\" target=\"_blank\" rel=\"noopener noreferrer\"><code>date</code></a></li>\n<li><a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/builtins.md#html-functions\" target=\"_blank\" rel=\"noopener noreferrer\"><code>html</code></a></li>\n<li><a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/builtins.md#math-functions\" target=\"_blank\" rel=\"noopener noreferrer\"><code>maths functions</code></a></li>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/doc/builtins.html#object-functions\" target=\"_blank\"><code>object</code></a></li>\n<li><a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/builtins.md#regex-functions\" target=\"_blank\" rel=\"noopener noreferrer\"><code>regex functions</code></a></li>\n<li><a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/builtins.md#string-functions\" target=\"_blank\" rel=\"noopener noreferrer\"><code>string functions</code></a></li>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/doc/builtins.html#timespan-functions\" target=\"_blank\"><code>timespan</code></a></li>\n</ul>\n</li>\n<li><a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/language.md#11-code-block\" target=\"_blank\" rel=\"noopener noreferrer\">Multi-line statements 多行语句</a> 不必在每行都使用</li>\n</ul>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">{{...}}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><ul>\n<li><a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/runtime.md#the-lexer-and-parser\" target=\"_blank\" rel=\"noopener noreferrer\">Safe parser</a> and <a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/runtime.md#safe-runtime\" target=\"_blank\" rel=\"noopener noreferrer\">safe runtime</a>, 使您可以控制公开哪些对象和功能</li>\n</ul>\n<h2>Syntax Coloring(语法着色)</h2>\n<p>您可以安装 <a href=\"https://marketplace.visualstudio.com/items?itemName=xoofx.scriban\" target=\"_blank\" rel=\"noopener noreferrer\">Scriban Extension for Visual Studio Code</a> 获取 scriban 脚本 (without HTML) 和 scriban html 文件的语法颜色提示</p>\n<h2>文档</h2>\n<ul>\n<li>有关<a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/language.md\" target=\"_blank\" rel=\"noopener noreferrer\">语言语法</a>的说明，请参阅语言文档。</li>\n<li>内置函数见文档<a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/builtins.md\" target=\"_blank\" rel=\"noopener noreferrer\">内置函数</a>列表。</li>\n<li><a href=\"http://xn--d6q68ewvytnav2iwszywn9lrwohlwk.NET\" target=\"_blank\" rel=\"noopener noreferrer\">有关编译和运行模板的.NET</a> 运行时 API 的说明，请参阅<a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/runtime.md\" target=\"_blank\" rel=\"noopener noreferrer\">运行时</a>文档。</li>\n<li>有关支持 liquid 模板的更多详细信息，请参阅[Liquid support]文档。</li>\n<li>请参阅我的博客文章\"<a href=\"http://xoofx.com/blog/2017/11/13/implementing-a-text-templating-language-and-engine-for-dotnet/\" target=\"_blank\" rel=\"noopener noreferrer\">实现.NET 的文本模板引擎</a>\"，了解一些幕后细节。</li>\n</ul>\n<h2>二进制包</h2>\n<p>Scriban 提供一个可获取的 NuGet 包: <a href=\"https://www.nuget.org/packages/Scriban/\" target=\"_blank\" rel=\"noopener noreferrer\"><img src=\"https://img.shields.io/nuget/v/Scriban.svg\" alt=\"NuGet\"></a></p>\n<p>兼容以下 .NET framework 版本:</p>\n<ul>\n<li>.NET Framework 3.5</li>\n<li>.NET Framework 4.0</li>\n<li>.NET Framework 4.5+ (supports asynchronous code and timeouts for regular expressions)</li>\n<li>.NET Standard1.1+ (some features are not available)</li>\n<li>.NET Standard1.3+ (which means .NET Core, Xamarin, UWP, Unity etc.)</li>\n</ul>\n<p>还有提供签名的 NuGet 包 <a href=\"https://www.nuget.org/packages/Scriban.Signed/\" target=\"_blank\" rel=\"noopener noreferrer\">Scriban.Signed</a></p>\n<h2>Benchmarks（基准测试）</h2>\n<p><strong>Scriban 速度极快</strong>! 更多细节, 你可以查看此文档 <a href=\"https://github.com/lunet-io/scriban/blob/devel-3.0/doc/benchmarks.md\" target=\"_blank\" rel=\"noopener noreferrer\">benchmarks（基准测试） 文档</a>.</p>\n<h2>License</h2>\n<p>该软件是在<a href=\"https://opensource.org/licenses/BSD-2-Clause\" target=\"_blank\" rel=\"noopener noreferrer\">BSD-Clause 2 license</a>协议下发布的</p>\n<h2>相关项目</h2>\n<ul>\n<li><a href=\"https://github.com/dotliquid/dotliquid\" target=\"_blank\" rel=\"noopener noreferrer\">dotliquid</a>: Liquid <a href=\"http://xn--msvn2d35qbttogc.NET\" target=\"_blank\" rel=\"noopener noreferrer\">模板语言的.NET</a> 端口。</li>\n<li><a href=\"https://github.com/sebastienros/fluid/\" target=\"_blank\" rel=\"noopener noreferrer\">Fluid</a> .NET liquid 模板引擎</li>\n<li><a href=\"https://github.com/jdiamond/Nustache\" target=\"_blank\" rel=\"noopener noreferrer\">Nustache</a>: .NET 无逻辑模板（Logic-less templates for .NET）</li>\n<li><a href=\"https://github.com/rexm/Handlebars.Net\" target=\"_blank\" rel=\"noopener noreferrer\">Handlebars.Net</a>: .NET port of handlebars.js</li>\n</ul>\n<h2>在线示例</h2>\n<ul>\n<li><a href=\"https://scribanonline.azurewebsites.net/\" target=\"_blank\" rel=\"noopener noreferrer\">https://scribanonline.azurewebsites.net/)</a>: <a href=\"http://ASP.NET\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET</a> Core Sample.</li>\n</ul>\n<h2>Credits</h2>\n<p>Adapted logo <code>Puzzle</code> by <a href=\"https://thenounproject.com/andydoane/\" target=\"_blank\" rel=\"noopener noreferrer\">Andrew Doane</a> from the Noun Project</p>\n<h2>作者</h2>\n<p>Alexandre Mutel aka <a href=\"http://xoofx.com\" target=\"_blank\" rel=\"noopener noreferrer\">xoofx</a>.</p>\n",
      "image": "https://github.com/lunet-io/scriban/workflows/ci/badge.svg?branch=master",
      "date_published": "2020-07-26T16:18:09.000Z",
      "date_modified": "2022-06-02T11:02:17.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "GitHub Actions",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/github-actions.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/github-actions.html",
      "summary": "GitHub Actions Gitee 与 GitHub 自动同步 当 github 上的项目代码 master 分支提交后，gitee 自动同步。如何实现呢。主要通过 github action 实现 我们想将 luoyunchong/lin-cms-dotnetcore 同步到 igeekfan/lin-cms-dotnetcore 上面，需要做...",
      "content_html": "\n<h2>Gitee 与 GitHub 自动同步</h2>\n<p>当 github 上的项目代码 master 分支提交后，gitee 自动同步。如何实现呢。主要通过 github action 实现</p>\n<p>我们想将 luoyunchong/lin-cms-dotnetcore 同步到 igeekfan/lin-cms-dotnetcore 上面，需要做的非常简单，只需要 2 步：</p>\n<p>1.将 Gitee 的私钥，上传到项目的 setting 的 Secrets 中。<br>\n<a href=\"https://pic.downk.cc/item/5e9725f5c2a9a83be5dcdec3.png\" target=\"_blank\" rel=\"noopener noreferrer\"><img src=\"https://pic.downk.cc/item/5e9725f5c2a9a83be5dcdec3.png\" alt=\"\"></a></p>\n<p>前提，该私钥对应的公钥在 gitee 上，windows(C:\\Users\\Computer.ssh)，其中 id_rsa 是私钥，id_rsa.pub 内容是公钥，具体在 gitee 上增加 ssh 公钥的过程，请参考<a href=\"https://gitee.com/help/articles/4191\" target=\"_blank\" rel=\"noopener noreferrer\">SSH 公钥设置</a></p>\n<ol start=\"2\">\n<li>改 source-repo、destination-repo 的值</li>\n</ol>\n<h2>lin-cms-dotnetcore gitee 同步脚本</h2>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>name: Publish</span></span>\n<span class=\"line\"><span>on:</span></span>\n<span class=\"line\"><span>    push:</span></span>\n<span class=\"line\"><span>        branches:</span></span>\n<span class=\"line\"><span>            - master</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>jobs:</span></span>\n<span class=\"line\"><span>    build:</span></span>\n<span class=\"line\"><span>        runs-on: ubuntu-latest</span></span>\n<span class=\"line\"><span>        steps:</span></span>\n<span class=\"line\"><span>            - name: Sync to Gitee 💕</span></span>\n<span class=\"line\"><span>              uses: wearerequired/git-mirror-action@master</span></span>\n<span class=\"line\"><span>              env:</span></span>\n<span class=\"line\"><span>                  SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}</span></span>\n<span class=\"line\"><span>              with:</span></span>\n<span class=\"line\"><span>                  source-repo: \"git@github.com:luoyunchong/lin-cms-dotnetcore.git\"</span></span>\n<span class=\"line\"><span>                  destination-repo: \"git@gitee.com:igeekfan/lin-cms-dotnetcore.git\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>每一个 steps 就是在 jobs 里执行命令，一个 jobs 可以有多个 steps,<br>\nsteps 字段指定每个 Job 的运行步骤的介绍</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>jobs.&lt;job_id&gt;.steps.name 步骤名称</span></span>\n<span class=\"line\"><span>jobs.&lt;job_id&gt;.steps.env 该步骤所需的环境变量。</span></span>\n<span class=\"line\"><span>jobs.&lt;job_id&gt;.steps.uses  使用的组件</span></span>\n<span class=\"line\"><span>jobs.&lt;job_id&gt;.steps.with 多个值(这个参数其实是提交给容器的CMD)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>CI/CD 部署</h2>\n<ul>\n<li>完整的配置项</li>\n</ul>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span># This workflow will do a clean install of node dependencies, build the source code and run tests across different versions of node</span></span>\n<span class=\"line\"><span># For more information see: https://help.github.com/actions/language-and-framework-guides/using-nodejs-with-github-actions</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>name: Node.js CI</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>on:</span></span>\n<span class=\"line\"><span>  push:</span></span>\n<span class=\"line\"><span>    branches:</span></span>\n<span class=\"line\"><span>      - master</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>jobs:</span></span>\n<span class=\"line\"><span>  build:</span></span>\n<span class=\"line\"><span>    name: 编译</span></span>\n<span class=\"line\"><span>    runs-on: ubuntu-latest</span></span>\n<span class=\"line\"><span>    strategy:</span></span>\n<span class=\"line\"><span>      matrix:</span></span>\n<span class=\"line\"><span>        node-version: ['8','10','12']</span></span>\n<span class=\"line\"><span>    steps:</span></span>\n<span class=\"line\"><span>    - uses: actions/checkout@v2</span></span>\n<span class=\"line\"><span>    - name: Use Node.js ${{ matrix.node-version }}</span></span>\n<span class=\"line\"><span>      uses: actions/setup-node@v1</span></span>\n<span class=\"line\"><span>      with:</span></span>\n<span class=\"line\"><span>        node-version: ${{ matrix.node-version }}</span></span>\n<span class=\"line\"><span>    - name: 安装依赖</span></span>\n<span class=\"line\"><span>      run: npm i</span></span>\n<span class=\"line\"><span>    - name: 编译文件</span></span>\n<span class=\"line\"><span>      run: |</span></span>\n<span class=\"line\"><span>        npm run lint</span></span>\n<span class=\"line\"><span>        npm run build</span></span>\n<span class=\"line\"><span>  deploy:</span></span>\n<span class=\"line\"><span>    name: 部署</span></span>\n<span class=\"line\"><span>    runs-on: ubuntu-latest</span></span>\n<span class=\"line\"><span>    steps:</span></span>\n<span class=\"line\"><span>      - name: 拉取代码</span></span>\n<span class=\"line\"><span>        uses: actions/checkout@v2</span></span>\n<span class=\"line\"><span>      - name: 安装 Node.js 12</span></span>\n<span class=\"line\"><span>        uses: actions/setup-node@v1</span></span>\n<span class=\"line\"><span>        with:</span></span>\n<span class=\"line\"><span>          node-version: 12</span></span>\n<span class=\"line\"><span>      - name: 安装依赖</span></span>\n<span class=\"line\"><span>        run: npm i</span></span>\n<span class=\"line\"><span>      - name: 编译文件</span></span>\n<span class=\"line\"><span>        run: |</span></span>\n<span class=\"line\"><span>          npm run lint</span></span>\n<span class=\"line\"><span>          npm run build</span></span>\n<span class=\"line\"><span>      - name: 上传文件</span></span>\n<span class=\"line\"><span>        uses: easingthemes/ssh-deploy@v2.1.4</span></span>\n<span class=\"line\"><span>        env:</span></span>\n<span class=\"line\"><span>          ARGS: \"-rltgoDzvO --delete\"</span></span>\n<span class=\"line\"><span>          SOURCE: \"dist/\"</span></span>\n<span class=\"line\"><span>          REMOTE_HOST: ${{ secrets.HOST }}</span></span>\n<span class=\"line\"><span>          REMOTE_USER: ${{ secrets.USER }}</span></span>\n<span class=\"line\"><span>          SSH_PRIVATE_KEY: ${{ secrets.SERVER_SSH_KEY }}</span></span>\n<span class=\"line\"><span>          TARGET: ${{ secrets.REMOTE_TARGET }}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>ssh-deploy 插件</h3>\n<ul>\n<li><a href=\"https://github.com/easingthemes/ssh-deploy\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/easingthemes/ssh-deploy</a></li>\n</ul>\n<p>可查看 README 了解具体参数</p>\n<p>以上共有四个参数需要配置</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>REMOTE_HOST: ${{ secrets.HOST }}</span></span>\n<span class=\"line\"><span>REMOTE_USER: ${{ secrets.USER }}</span></span>\n<span class=\"line\"><span>SSH_PRIVATE_KEY: ${{ secrets.SERVER_SSH_KEY }}</span></span>\n<span class=\"line\"><span>TARGET: ${{ secrets.REMOTE_TARGET }}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>打开 Settings-&gt;Secrets-&gt;New secret 配置如下内容。</p>\n<ul>\n<li>HOST eg: <a href=\"http://mydomain.com\" target=\"_blank\" rel=\"noopener noreferrer\">mydomain.com</a> 这里我们配置了服务器的 ip 111.231.197.142</li>\n<li>USER centos 服务器的用户名</li>\n<li>REMOTE_TARGET 目标服务器的文件夹位置， eg: /var/www/lin-cms-vvlog</li>\n<li>SERVER_SSH_KEY：SSH 密钥对的私钥部分，公钥应该添加到服务器上的 authorized_keys 文件中。。eg /root/.ssh/authorized_keys</li>\n</ul>\n<p>最后一个参数说明：这个相当于把私钥给 github，让他能远程上传文件到 centos 中，公钥放到服务器上。公钥生成的过程不 BB 了，</p>\n<h3>.ssh 生成</h3>\n<ul>\n<li><a href=\"https://help.github.com/en/articles/connecting-to-github-with-ssh\" target=\"_blank\" rel=\"noopener noreferrer\">https://help.github.com/en/articles/connecting-to-github-with-ssh</a></li>\n<li><a href=\"https://www.ssh.com/ssh/public-key-authentication\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.ssh.com/ssh/public-key-authentication</a></li>\n</ul>\n<p>本地 windows .ssh 默认生成目录</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>C:\\Users\\计算机名\\.ssh</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>我的.ssh 目录位置</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>C:\\Users\\Computer\\.ssh</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>dir 查看文件</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>C:\\Users\\Computer\\.ssh&gt;dir</span></span>\n<span class=\"line\"><span>2020/02/22  19:45             3,243 id_rsa</span></span>\n<span class=\"line\"><span>2020/02/22  19:45               750 id_rsa.pub</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>id_rsa 是私钥，用 vscode 等记事本编辑器打开，并复制配置到 github 上。New secret,id_rsa.pub 是公钥，把他复制到 linux 文件夹<code>/root/.ssh/</code>目录中，这时把他的名字由<code>id_rsa.pub</code>改成<code>authorized_keys</code>即可。</p>\n<p><code>/用户名/.ssh</code> 没有.ssh 文件夹就创建一个。</p>\n<h3>XSheel ssh 登录</h3>\n<p>可通过 xshell 工具验证，Public Key 登录。</p>\n<p>新建会话属性-&gt;输入主机（H）即 IP 地址。</p>\n<p>选择用户身份验证-&gt;方法选择 public Key,输入用户名，比如 root</p>\n<ul>\n<li>选择私钥登录<br>\n在用户密钥右侧点击浏览-&gt;用户密钥-&gt;导入-&gt;选择 id_rsa.pub 私钥，导入成功后，选择此密钥，确定。再在 SSH 用户身份验证界面确定,即可登录成功。表明私钥，公钥配置成功</li>\n</ul>\n<h2>参考</h2>\n<ul>\n<li><a href=\"https://github.com/marketplace/actions/mirror-a-repository-using-ssh\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/marketplace/actions/mirror-a-repository-using-ssh</a></li>\n<li><a href=\"https://help.github.com/en/actions\" target=\"_blank\" rel=\"noopener noreferrer\">https://help.github.com/en/actions</a></li>\n</ul>\n",
      "image": "https://pic.downk.cc/item/5e9725f5c2a9a83be5dcdec3.png",
      "date_published": "2020-07-24T17:10:08.000Z",
      "date_modified": "2022-06-02T11:02:17.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "方法级别的权限控制（API级别）",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/authorize.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/authorize.html",
      "summary": "方法级别的权限控制（API级别） Lin的定位在于实现一整套 CMS的解决方案，它是一个设计方案，提供了不同的后端，不同的前端，而且也支持不同的数据库 目前官方团队维护 lin-cms-vue,lin-cms-spring-boot,lin-cms-koa,lin-cms-flask 社区维护了 lin-cms-tp5,lin-cms-react,li...",
      "content_html": "\n<p>Lin的定位在于实现一整套 CMS的解决方案，它是一个设计方案，提供了不同的后端，不同的前端，而且也支持不同的数据库</p>\n<p>目前官方团队维护 lin-cms-vue,lin-cms-spring-boot,lin-cms-koa,lin-cms-flask<br>\n社区维护了 lin-cms-tp5,lin-cms-react,lin-cms-dotnetcore，即已支持vue,react二种前端框架，java,nodejs,python,php,c#等五种后端语言。</p>\n<p><a href=\"http://xn--4gqvab21ge41e49gvk0e1st.NET\" target=\"_blank\" rel=\"noopener noreferrer\">下面我们来讲一下.NET</a> Core这个项目中权限控制的实现。</p>\n<p>对于CMS来说，一个完善的权限模块是必不可少的，是系统内置实现的。为了更加简单地理解权限，<a href=\"http://xn--ASP-p18d1bu7f23heq6b29jzx4acj4c.NET\" target=\"_blank\" rel=\"noopener noreferrer\">我们先来理解一下ASP.NET</a> Core有哪些权限控制。</p>\n<p>1.<strong>AuthorizeAttribute</strong>的作用？</p>\n<p>这个特性标签授权通过属性参数配置，可应用于控制器或操作方法上，对用户的身份进行验证。</p>\n<p>如果没有授权，会返回403状态码，我们可以通过重写，来实现返回JSON字符串，让前台提示。前提是请求中间件配置了如下二行。</p>\n<ul>\n<li>\n<p><strong>app.UseAuthentication();</strong> 认证，明确是谁在操作，认证方式如用户名密码,登录后，可以得到一个token，或者写入cookies，这样可以确定这个用户是谁</p>\n</li>\n<li>\n<p><strong>app.UseAuthorization();</strong> 授权中间件，明确你是否有某个权限。在http请求时，中间件会在带有权限特性标签 <strong>[Authorize]</strong> 的操作，进行权限判断，包括角色，策略等。</p>\n</li>\n</ul>\n<p>该控制器下的操作都必须经过身份验证，</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Authorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AccountController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Controller</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ActionResult</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Login</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ActionResult</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Logout</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>这样只显示单个方法必须应用授权。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AccountController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Controller</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">   public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ActionResult</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Login</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">   {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">   }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">   [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Authorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">   public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ActionResult</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Logout</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">   {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">   }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>如果我们通过<strong>AllowAnonymous</strong>特性标签去掉身份验证。Login方法无须进行验证。即可匿名访问。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Authorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AccountController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Controller</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AllowAnonymous</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ActionResult</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Login</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ActionResult</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Logout</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ol start=\"2\">\n<li>基于角色的授权</li>\n</ol>\n<p>我们可以通过给这个特性标签加参数，配置，某个方法，控制器是否有这个角色，如果有此角色才能访问这些资源。</p>\n<p>单个角色</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Authorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">Roles</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"Administrator\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AdministrationController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Controller</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>多个角色，我们可以这样配置,即用逗号分隔。用户有其中一个角色即可访问。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Authorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">Roles</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"HRManager,Finance\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SalaryController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Controller</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>当某个方法必须同时有二个角色怎么办呢。该控制器只有同时有PowerUser，和ControlPanelUser的角色才能访问这些资源了。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Authorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">Roles</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"PowerUser\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Authorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">Roles</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"ControlPanelUser\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ControlPanelController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Controller</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>3.更多。请看官网 <a href=\"https://docs.microsoft.com/zh-cn/aspnet/core/security/authorization/roles?view=aspnetcore-3.1\" target=\"_blank\" rel=\"noopener noreferrer\">https://docs.microsoft.com/zh-cn/aspnet/core/security/authorization/roles?view=aspnetcore-3.1</a></li>\n</ul>\n<p>更多该特性标签的介绍，也可参考官网，这里就不展开了。</p>\n<p>那这个角色，到底在哪配置的？？</p>\n<p>登录时生成的Token,是基于JWT的，其中的Claim的type为<strong>ClaimTypes.Role</strong>（枚举值），角色名称为字符串，与特性标签中的Roles属性值相同。<br>\n如</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Claim</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ClaimTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Role</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Administrator\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>有多个角色时，<strong>List Claim</strong> 多加几个 <strong>new Claim(ClaimTypes.Role, \"PowerUser\");</strong> 也是支持的。user为用户信息，LinGroups为当前用户的分组（多个）</p>\n<p>即如下代码示例，多个分组（角色）</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> claims</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> List</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Claim</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">    new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Claim</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ClaimTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">NameIdentifier</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">user</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Email</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> ??</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">    new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Claim</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ClaimTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">GivenName</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">user</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Nickname</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> ??</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">    new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Claim</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ClaimTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Name</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">user</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Username</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> ??</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">user</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">LinGroups</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">?</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ForEach</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">     claims</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Add</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Claim</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ClaimTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Role</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Name</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> });</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>AuthorizeAttribute源码</h3>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AttributeUsage</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">AttributeTargets</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Class</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> |</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> AttributeTargets</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Method</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">AllowMultiple</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">Inherited</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">  public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AuthorizeAttribute</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Attribute</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IAuthorizeData</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> AuthorizeAttribute</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> AuthorizeAttribute</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> policy</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\">      this</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Policy</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> policy</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Policy</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Roles</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> AuthenticationSchemes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>我们可以看到，它继承了Attribute，说明这是一个特性标签，IAuthorizeData是一个接口，有这三个属性，约束了 一个规范，即有角色Roles，有策略Policy，有身份验证方案AuthenticationSchemes，该特性支持Class,支持方法，该特性标签支持多个共用，该特性标签支持被继承。</p>\n<p>基于角色的授权和基于声明的授权是一种预配置的策略，即固定的角色，固定的Claims验证。</p>\n<p>我们可以基于自定义策略的实现更多的权限验证或某些规则验证。</p>\n<p>AuthorizeAttribute能做的权限控制如下</p>\n<ul>\n<li>基于角色级别的权限控制（多个角色，单个角色）</li>\n<li>基于声明的授权：可自定义声明特性。</li>\n<li>基于策略的授权：</li>\n</ul>\n<h2>lin-cms-dotnetcore中的权限设计</h2>\n<p>说了这么多官方提供的，我们讲一下lin-cms-dotnetcore中的权限设计</p>\n<p>完整的表结构如下<br>\n<a href=\"https://luoyunchong.github.io/igeekfan-docs/dotnetcore/lin-cms/table.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://luoyunchong.github.io/igeekfan-docs/dotnetcore/lin-cms/table.html</a></p>\n<h4>LinCmsAuthorizeAttribute</h4>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AttributeUsage</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">AttributeTargets</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Class</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> |</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> AttributeTargets</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Method</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">AllowMultiple</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCmsAuthorizeAttribute</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Attribute</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IAsyncAuthorizationFilter</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Permission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Module</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> LinCmsAuthorizeAttribute</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> permission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> module</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            Permission</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> permission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            Module</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> module</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> OnAuthorizationAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AuthorizationFilterContext</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> context</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            ClaimsPrincipal</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> claimsPrincipal</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> context</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">HttpContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">User</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">!</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">claimsPrincipal</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Identity</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">IsAuthenticated</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">                HandlerAuthenticationFailed</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">context</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"认证失败，请检查请求头或者重新登陆\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ErrorCode</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">AuthenticationFailed</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">                return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            IAuthorizationService</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> authorizationService</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IAuthorizationService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">context</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">HttpContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">RequestServices</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IAuthorizationService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            AuthorizationResult</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> authorizationResult</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> authorizationService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AuthorizeAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">context</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">HttpContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">User</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">null</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> OperationAuthorizationRequirement</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">() { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Name</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> Permission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> });</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">!</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">authorizationResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Succeeded</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">                HandlerAuthenticationFailed</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">context</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">$\"您没有权限：{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Module</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">}-{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Permission</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ErrorCode</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">NoPermission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> HandlerAuthenticationFailed</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AuthorizationFilterContext</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> context</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> errorMsg</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ErrorCode</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> errorCode</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            context</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">HttpContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Response</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">StatusCode</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> StatusCodes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Status401Unauthorized</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            context</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Result</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> JsonResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> UnifyResponseDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">errorCode</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">errorMsg</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">context</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">HttpContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>上面的实现非常简单,LinCmsAuthorizeAttribute继承于Attribute，说明是一个特性标签，有二个属性Permission，Module，代表权限名，模块名（用于区分哪个功能模块），然后将权限名称转化为OperationAuthorizationRequirement，然后调用authorizationService中的方法AuthorizeAsync来完成授权。</p>\n<p>接下来，我们在控制器上使用LinCmsAuthorizeAttribute,那么我们</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Route</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"cms/admin/group\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ApiController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> GroupController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ControllerBase</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IGroupService</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _groupService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> GroupController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IGroupService</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> groupService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        _groupService</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> groupService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"all\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"查询所有权限组\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"管理员\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">List</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinGroup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetListAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _groupService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetListAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"{id}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"查询一个权限组及其权限\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"管理员\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">GroupDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">long</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        GroupDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> groupDto</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _groupService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> groupDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpPost</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"新建权限组\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"管理员\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UnifyResponseDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromBody</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreateGroupDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> inputDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">        await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _groupService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">inputDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> UnifyResponseDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Success</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"新建分组成功\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpPut</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"{id}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"更新一个权限组\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"管理员\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UnifyResponseDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UpdateAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">long</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromBody</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UpdateGroupDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> updateGroupDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">        await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _groupService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UpdateAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">updateGroupDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> UnifyResponseDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Success</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"更新分组成功\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpDelete</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"{id}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"删除一个权限组\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"管理员\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UnifyResponseDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">DeleteAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">long</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">        await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _groupService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">DeleteAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> UnifyResponseDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Success</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"删除分组成功\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>这样在方法上已经加了权限的标签，但我们怎么得到系统中的所有权限，让用户配置呢。<br>\n<a href=\"https://igeekfan.gitee.io/igeekfan-docs/dotnetcore/lin-cms/reflex-assembly-get-controller-methods-attribute.html#%E8%8E%B7%E5%8F%96%E6%8E%A7%E5%88%B6%E5%99%A8%E5%8F%8A%E6%96%B9%E6%B3%95%E7%89%B9%E6%80%A7%E6%A0%87%E7%AD%BE\" target=\"_blank\" rel=\"noopener noreferrer\">获取控制器及方法特性标签</a>。本质上，是通过反射,扫描当前程序集，会获取到一个List，我们可以在系统启动时把这些数据存到数据库中。</p>\n<p>最新的方式是采用此方法，原理都相同。name，module唯一值。存入lin_permission表中，这时就有id值了。lin_group_permission就能用分组关联了。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> SeedAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    List</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">PermissionDefinition</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">linCmsAttributes</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> ReflexHelper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GeAssemblyLinCmsAttributes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    List</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinPermission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">insertPermissions</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> List</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinPermission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">    List</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">&lt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">LinPermission</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">allPermissions</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">  _permissionRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToListAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    linCmsAttributes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ForEach</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        bool</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> exist</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> allPermissions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Any</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">u</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> u</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Module</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Module</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> &amp;&amp;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> u</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Name</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Permission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">!</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">exist</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            insertPermissions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Add</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinPermission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Permission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Module</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    });</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">    await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _permissionRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">InsertAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">insertPermissions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>实现方法级的权限控制源码解析</h3>\n<p>原理可以看这个文章<a href=\"https://www.cnblogs.com/RainingNight/p/dynamic-authorization-in-asp-net-core.html\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET Core 认证与授权[7]:动态授权</a>中的<strong>自定义授权过滤器</strong></p>\n<p>我们需要了解一下这些类/接口/抽象类</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>- IAuthorizationService(interface)</span></span>\n<span class=\"line\"><span>- AuthorizationService(class)</span></span>\n<span class=\"line\"><span>- IAuthorizationHandler(interface)</span></span>\n<span class=\"line\"><span>- AuthorizationHandler&lt;TRequirement&gt;(abstract class)</span></span>\n<span class=\"line\"><span>- PermissionAuthorizationHandler（class 自定义的类,继承AuthorizationHandler）</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>总结调用链如下</h3>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>LinCmsAuthorizeAttribute（继承了IAsyncAuthorizationFilter的特性标签）</span></span>\n<span class=\"line\"><span>调用了</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2020-05-28T06:06:11.000Z",
      "date_modified": "2022-09-13T11:34:29.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "文件上传系统",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/file-upload.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/file-upload.html",
      "summary": "文件上传系统 LinCMS内置了灵活的文件上传管理功能，支持本地存储和云存储多种方式，前端提供了配套的组件方便使用。 功能概述 支持单文件、多文件上传 支持上传至本地文件系统或七牛云对象存储 自动文件去重（基于MD5），支持\"秒传\"功能 可配置文件大小、类型、数量限制 统一的文件管理API 系统设计 核心接口 系统定义了IFileService接口作为...",
      "content_html": "\n<p>LinCMS内置了灵活的文件上传管理功能，支持本地存储和云存储多种方式，前端提供了配套的组件方便使用。</p>\n<h2>功能概述</h2>\n<ul>\n<li>支持单文件、多文件上传</li>\n<li>支持上传至本地文件系统或七牛云对象存储</li>\n<li>自动文件去重（基于MD5），支持\"秒传\"功能</li>\n<li>可配置文件大小、类型、数量限制</li>\n<li>统一的文件管理API</li>\n</ul>\n<h2>系统设计</h2>\n<h3>核心接口</h3>\n<p>系统定义了<code>IFileService</code>接口作为文件服务的抽象：</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> interface</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IFileService</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// 单文件上传，键为file</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"file\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">上传的文件对象</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"key\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">文件对应的key，默认为0</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">文件信息DTO</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    Task</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FileDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">UploadAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFormFile</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> file</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> key</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>存储实现</h3>\n<p>系统提供了两种实现：</p>\n<ul>\n<li><strong>本地存储</strong>：<code>LocalFileService</code>，文件保存在服务器本地文件系统</li>\n<li><strong>七牛云存储</strong>：<code>QiniuService</code>，文件上传至七牛云对象存储</li>\n</ul>\n<h2>配置说明</h2>\n<p>在<code>appsettings.json</code>中配置文件上传相关参数：</p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"FileStorage\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"MaxFileSize\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">83886080</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,  </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 最大文件大小(单位:字节)，默认80MB</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"NumLimit\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">3</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,            </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 单次上传文件数量限制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"Include\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,            </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 允许的文件类型，如：\".png,.jpg\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"Exclude\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\".exe,.dll\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,   </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 禁止的文件类型</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"ServiceName\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"LocalFileService\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,  </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 使用的存储服务类型：LocalFileService或QiniuService</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"LocalFile\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"PrefixPath\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"assets\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,            </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 文件存储子目录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"Host\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"https://localhost:5001/\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">  // 访问域名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"Qiniu\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"AK\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"your-access-key\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,           </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 七牛云AccessKey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"SK\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"your-secret-key\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,           </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 七牛云SecretKey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"Bucket\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"your-bucket-name\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,      </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 七牛云存储空间名称</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"PrefixPath\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"assets\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,            </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// 存储路径前缀</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"Host\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"http://images.example.com/\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">// CDN加速域名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"UseHttps\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">false</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">                  // 是否使用HTTPS</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>本地存储配置</h3>\n<p>使用本地存储时（<code>ServiceName</code>设为<code>LocalFileService</code>）：</p>\n<ul>\n<li><code>PrefixPath</code>：文件存储目录，相对于<code>wwwroot</code>目录的相对路径</li>\n<li><code>Host</code>：访问文件的域名，通常是应用的域名</li>\n</ul>\n<p>存储路径格式：<code>/{STORE_DIR}/{year}/{month}/{day}/{guid}.文件后缀</code><br>\n例如：<code>/assets/2023/8/15/64263e57-9a24-4933-9116-25616c801e93.png</code></p>\n<h3>七牛云存储配置</h3>\n<p>使用七牛云存储时（<code>ServiceName</code>设为<code>QiniuService</code>）：</p>\n<ul>\n<li><code>AK</code>：七牛云账号的AccessKey</li>\n<li><code>SK</code>：七牛云账号的SecretKey</li>\n<li><code>Bucket</code>：存储空间名称</li>\n<li><code>PrefixPath</code>：存储路径前缀</li>\n<li><code>Host</code>：七牛云分配的域名或绑定的自定义域名</li>\n</ul>\n<p>存储路径格式：<code>{PrefixPath}/{yyyyMMddHHmmssffffff}.文件后缀</code><br>\n例如：<code>assets/20230815150043868887.jpg</code></p>\n<h2>API说明</h2>\n<p>LinCMS提供了两个主要的文件上传API：</p>\n<p>| 请求方式 | 路径             | 功能       | 参数                             |<br>\n|</p>\n",
      "date_published": "2020-05-13T11:18:08.000Z",
      "date_modified": "2025-04-28T14:32:13.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "行为日志",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/logger.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/logger.html",
      "summary": "行为日志",
      "content_html": "\n",
      "date_published": "2020-05-13T11:18:08.000Z",
      "date_modified": "2022-06-02T11:02:17.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "QQ第三方授权登录",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/qq-login.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/qq-login.html",
      "summary": "QQ第三方授权登录 安装包 接上文GitHub第三方授权登录 申请过程不介绍了，申请者资料,个人也是可以申请成功的。 这时候有二个参数就是clientid clientsecret 其中平台信息，这个申请审核通过后，不要修改，千万不要随便修改，一修改就要重新审核。 网站回调域:可以随便修改，并且可以写多个，中间用英文逗号分隔即可。 比如，网站地址填的：...",
      "content_html": "\n<h2>安装包</h2>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>dotnet add package AspNet.Security.OAuth.QQ</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><ul>\n<li><a href=\"https://luoyunchong.github.io/igeekfan-docs/dotnetcore/lin-cms/spa-github-login.html\" target=\"_blank\" rel=\"noopener noreferrer\">接上文GitHub第三方授权登录</a></li>\n</ul>\n<p>申请过程不介绍了，<a href=\"https://wiki.connect.qq.com/%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C_oauth2-0\" target=\"_blank\" rel=\"noopener noreferrer\">申请者资料</a>,个人也是可以申请成功的。</p>\n<p>这时候有二个参数就是clientid clientsecret</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>APP ID：xxxx</span></span>\n<span class=\"line\"><span>APP Key：xxxxxx</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>其中<strong>平台信息</strong>，这个申请审核通过后，<strong>不要修改，千万不要随便修改</strong>，一修改就要重新审核。</p>\n<p>网站回调域:可以随便修改，并且可以写多个，中间用英文逗号分隔即可。<br>\n比如，网站地址填的：<a href=\"https://api.igeekfan.cn%EF%BC%8C%E4%B8%8B%E9%9D%A2%E5%A6%82%E6%9E%9C%E6%98%AFlocalhost%EF%BC%8C%E6%98%AF%E5%8F%AF%E4%BB%A5%E7%9A%84%EF%BC%8C%E4%BD%86%E5%A6%82%E6%9E%9C%E6%98%AF%E5%9F%9F%E5%90%8D,%E4%BE%BF%E5%8F%AA%E8%83%BD%E6%98%AFhttps://api.igeekfan.cn\" target=\"_blank\" rel=\"noopener noreferrer\">https://api.igeekfan.cn，下面如果是localhost，是可以的，但如果是域名,便只能是https://api.igeekfan.cn</a>这个域名下的路径。</p>\n<p>网站回调域配置,后台是运行在<a href=\"https://localhost:5001\" target=\"_blank\" rel=\"noopener noreferrer\">https://localhost:5001</a>端口上。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>https://api.igeekfan.cn/signin-qq;https://localhost:5001/signin-qq</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2>接口介绍</h2>\n<p>server-side模式，是OAuth2.0认证的一种模式，又称Web Server Flow；</p>\n<p><img src=\"http://qzonestyle.gtimg.cn/qzone/vas/opensns/res/img/OAuth_guide_V2_1.png\" alt=\"image\"></p>\n<p>获取Authorization Code<br>\n<a href=\"https://graph.qq.com/oauth2.0/authorize\" target=\"_blank\" rel=\"noopener noreferrer\">https://graph.qq.com/oauth2.0/authorize</a></p>\n<p>通过Authorization Code获取Access Token<br>\n<a href=\"https://graph.qq.com/oauth2.0/token\" target=\"_blank\" rel=\"noopener noreferrer\">https://graph.qq.com/oauth2.0/token</a></p>\n<p>获取用户OpenID_OAuth2.0<br>\n<a href=\"https://graph.qq.com/oauth2.0/me\" target=\"_blank\" rel=\"noopener noreferrer\">https://graph.qq.com/oauth2.0/me</a></p>\n<p>获取用户个人信息<br>\n<a href=\"https://graph.qq.com/user/get_user_info\" target=\"_blank\" rel=\"noopener noreferrer\">https://graph.qq.com/user/get_user_info</a></p>\n<h2><a class=\"header-anchor\" href=\"#使用authorization-code获取access-token\"><span></span></a><a href=\"https://wiki.connect.qq.com/%E4%BD%BF%E7%94%A8authorization_code%E8%8E%B7%E5%8F%96access_token\" target=\"_blank\" rel=\"noopener noreferrer\">使用Authorization_Code获取Access_Token</a></h2>\n<p>接入流程如下：</p>\n<ol>\n<li>先获取Authorization Code；</li>\n<li>通过Authorization Code获取Access Token</li>\n</ol>\n<p>1.Step1：获取Authorization Code</p>\n<p>GET</p>\n<p><a href=\"https://graph.qq.com/oauth2.0/authorize?response_type=code&amp;client_id=client_id&amp;redirect_uri=https://localhost:5001/signin-qq&amp;state=123abc\" target=\"_blank\" rel=\"noopener noreferrer\">https://graph.qq.com/oauth2.0/authorize?response_type=code&amp;client_id=client_id&amp;redirect_uri=https://localhost:5001/signin-qq&amp;state=123abc</a></p>\n<p>具体参数可查看官网。</p>\n<p>state由用户自己创建一个随机数，以防止CSRF攻击。</p>\n<p>如果用户成功登录并授权，则会跳转到指定的回调地址，并在redirect_uri地址后带上Authorization Code和原始的state值。如：</p>\n<p><a href=\"https://localhost:5001/signin-qq?code=B6D497755EACE4635115FC82BE24F280&amp;state=123abc\" target=\"_blank\" rel=\"noopener noreferrer\">https://localhost:5001/signin-qq?code=B6D497755EACE4635115FC82BE24F280&amp;state=123abc</a></p>\n<p>后台先根据state验证是自己发出的请求，判断是否相同，不相同，则代表非本项目发出的授权登录请求。</p>\n<ol start=\"2\">\n<li>根据code获取access_token</li>\n</ol>\n<p>GET</p>\n<p><a href=\"https://graph.qq.com/oauth2.0/token?grant_type=authorization_code&amp;client_id=client_id&amp;client_secret=client_secret&amp;code=B6D497755EACE4635115FC82BE24F280&amp;redirect_uri=https://localhost:5001/signin-qq\" target=\"_blank\" rel=\"noopener noreferrer\">https://graph.qq.com/oauth2.0/token?grant_type=authorization_code&amp;client_id=client_id&amp;client_secret=client_secret&amp;code=B6D497755EACE4635115FC82BE24F280&amp;redirect_uri=https://localhost:5001/signin-qq</a></p>\n<p>这时候你会得到</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>access_token=1B6E45FA99BA3D6B347713440C9BCEFE&amp;expires_in=7776000&amp;refresh_token=8DB1D48D95C85D3EF593936B8ACE5EE0</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2>获取用户OpenID_OAuth2.0</h2>\n<p>GET</p>\n<p><a href=\"https://graph.qq.com/oauth2.0/me?access_token=1B6E45FA99BA3D6B347713440C9BCEFE\" target=\"_blank\" rel=\"noopener noreferrer\">https://graph.qq.com/oauth2.0/me?access_token=1B6E45FA99BA3D6B347713440C9BCEFE</a></p>\n<p>openid是此网站上唯一对应用户身份的标识</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>callback( {\"client_id\":\"101867513\",\"openid\":\"951560F5C7A5AA9E5E599CF9B4ECFFB2\"} );</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2>获取用户的其他信息</h2>\n<p>用户信息</p>\n<p><a href=\"https://graph.qq.com/user/get_user_info?access_token=1B6E45FA99BA3D6B347713440C9BCEFE&amp;oauth_consumer_key=YOUR_APP_ID&amp;openid=951560F5C7A5AA9E5E599CF9B4ECFFB2\" target=\"_blank\" rel=\"noopener noreferrer\">https://graph.qq.com/user/get_user_info?access_token=1B6E45FA99BA3D6B347713440C9BCEFE&amp;oauth_consumer_key=YOUR_APP_ID&amp;openid=951560F5C7A5AA9E5E599CF9B4ECFFB2</a></p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"ret\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"msg\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"is_lost\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">:</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"nickname\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"、天上有木月OvO\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"gender\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"xxx\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"gender_type\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"province\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"xxx\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"city\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"xxx\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"year\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"2019\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"constellation\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"figureurl\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"http:</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\/\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">qzapp.qlogo.cn</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">qzapp</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">101867513</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">951560F5C7A5AA9E5E599CF9B4ECFFB2</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">30\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"figureurl_1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"http:</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\/\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">qzapp.qlogo.cn</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">qzapp</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">101867513</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">951560F5C7A5AA9E5E599CF9B4ECFFB2</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">50\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"figureurl_2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"http:</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\/\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">qzapp.qlogo.cn</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">qzapp</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">101867513</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">951560F5C7A5AA9E5E599CF9B4ECFFB2</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\/</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">100\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"figureurl_qq_1\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"http://thirdqq.qlogo.cn/g?b=oidb&amp;k=bjXoWmdlu8fk1m80MCkibMg&amp;s=40&amp;t=1559108425\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"figureurl_qq_2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"http://thirdqq.qlogo.cn/g?b=oidb&amp;k=bjXoWmdlu8fk1m80MCkibMg&amp;s=100&amp;t=1559108425\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">\"figureurl_qq\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"http://thirdqq.qlogo.cn/g?b=oidb&amp;k=bjXoWmdlu8fk1m80MCkibMg&amp;s=640&amp;t=1559108425\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>代码</h2>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>services.AddAuthentication(xxx)</span></span>\n<span class=\"line\"><span>.AddGitHub(xxx)</span></span>\n<span class=\"line\"><span>加上AddQQ的配置项</span></span>\n<span class=\"line\"><span>.AddQQ(options =&gt;</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>   options.ClientId = Configuration[\"Authentication:QQ:ClientId\"];</span></span>\n<span class=\"line\"><span>   options.ClientSecret = Configuration[\"Authentication:QQ:ClientSecret\"];</span></span>\n<span class=\"line\"><span>})</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>appsettings.json中配置项</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>  \"Authentication\": {</span></span>\n<span class=\"line\"><span>   //下面为新增项</span></span>\n<span class=\"line\"><span>   \"QQ\": {</span></span>\n<span class=\"line\"><span>     \"ClientId\": \"xx\",</span></span>\n<span class=\"line\"><span>     \"ClientSecret\": \"xxx\"</span></span>\n<span class=\"line\"><span>   }</span></span>\n<span class=\"line\"><span> }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>对，没错，QQ登录，已经结束了。接下来就是把这些用户的信息保存到数据库，生成token的过程。</p>\n<p>这里</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>[HttpGet(\"signin-callback\")]</span></span>\n<span class=\"line\"><span>public async Task&lt;IActionResult&gt; Home(string provider, string redirectUrl = \"\")</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>   AuthenticateResult authenticateResult = await _contextAccessor.HttpContext.AuthenticateAsync(provider);</span></span>\n<span class=\"line\"><span>   if (!authenticateResult.Succeeded) return Redirect(redirectUrl);</span></span>\n<span class=\"line\"><span>   var openIdClaim = authenticateResult.Principal.FindFirst(ClaimTypes.NameIdentifier);</span></span>\n<span class=\"line\"><span>   if (openIdClaim == null || string.IsNullOrWhiteSpace(openIdClaim.Value))</span></span>\n<span class=\"line\"><span>       return Redirect(redirectUrl);</span></span>\n<span class=\"line\"><span>       </span></span>\n<span class=\"line\"><span>       </span></span>\n<span class=\"line\"><span>   ClaimsPrincipal principal=authenticateResult.Principal;</span></span>\n<span class=\"line\"><span>   //根据provider，处理用户的基础信息，</span></span>\n<span class=\"line\"><span>   </span></span>\n<span class=\"line\"><span>   long id =SaveQQAsync(principal, openIdClaim.Value)</span></span>\n<span class=\"line\"><span>   </span></span>\n<span class=\"line\"><span>   //xxx</span></span>\n<span class=\"line\"><span>   </span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>openIdClaimopenIdClaim是唯一值</p>\n<h3>lin_user表</h3>\n<p>字段| 类型|备注</p>\n",
      "image": "http://qzonestyle.gtimg.cn/qzone/vas/opensns/res/img/OAuth_guide_V2_1.png",
      "date_published": "2020-05-13T11:18:08.000Z",
      "date_modified": "2023-03-12T13:50:00.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "CAP实现EventBus",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/rabbitmq.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/rabbitmq.html",
      "summary": "CAP实现EventBus 分布式事务一致性，使用的是 CAP，那么我们在什么情况下使用它呢。 EventBus:事件总线，是一个基于观察者模块的事件发布/订阅框架，可以将一些复杂的，重复的操作，异步的操作，交给系统去处理，当前系统直接返回成功的操作。 简单的说就是解耦， 比如用户发布文章后，需要将消息推送给关注的用户，这时候，推送会浪费许多时间，本来...",
      "content_html": "\n<p>分布式事务一致性，使用的是 <a href=\"https://github.com/dotnetcore/cap\" target=\"_blank\" rel=\"noopener noreferrer\">CAP</a>，那么我们在什么情况下使用它呢。</p>\n<p>EventBus:事件总线，是一个基于观察者模块的事件发布/订阅框架，可以将一些复杂的，重复的操作，异步的操作，交给系统去处理，当前系统直接返回成功的操作。</p>\n<p>简单的说就是解耦，</p>\n<p>比如用户发布文章后，需要将消息推送给关注的用户，这时候，推送会浪费许多时间，本来这个操作与当前登录的用户没有关系，用户也只关注文章发布是否成功，。后续，将推送等操作，交给另一件事件去处理，这样速度更快，屏蔽了一些细节。就类似一种消息通知，我不关心后续是什么操作，只将自己的一些状态传递过去。</p>\n<p>我们先来了解一下CAP中的EventBus，主要特点是发布订阅模式，内部使用RabbitMQ实现异构系统的消息同步，通过本地消息表对信息持久化，保证由EventBus发出的消息是可靠的，即高可用。</p>\n<p>如果系统启动后在log/log200xxx.txt日志错误原因，RabbitMQ</p>\n<div class=\"language-txt line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"txt\" data-title=\"txt\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>DotNetCore.CAP.BrokerConnectionException: Broker Unreachable</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div>",
      "image": "https://note.youdao.com/yws/api/personal/file/7FA20220D5454DF9B0788B33E3A41FED?method=download&shareKey=c2e5f279b574304e3bd777a75a4e3045",
      "date_published": "2020-05-08T15:01:00.000Z",
      "date_modified": "2022-10-20T16:01:01.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "About",
      "url": "https://igeekfan.cn/igeekfan-docs/about/",
      "id": "https://igeekfan.cn/igeekfan-docs/about/",
      "summary": "About 欢迎 👋 你好，我是 IGeekFan ，我会写c#，会写一点点javascript。 推荐项目 联系我 💬 https://github.com/luoyunchong https://www.cnblogs.com/igeekfan luoyunchong@foxmail.com Anurag's github stats Most...",
      "content_html": "\n<h2>欢迎</h2>\n<p>👋 你好，我是 <code>IGeekFan</code> ，我会写<code>c#</code>，会写一点点<code>javascript</code>。</p>\n<p><img src=\"https://img.shields.io/badge/OS-Win11-informational?style=flat&amp;logo=<LOGO_NAME>&amp;logoColor=white&amp;color=2bbc8a\" alt=\"\"><br>\n<img src=\"https://img.shields.io/badge/OS-MAC-informational?style=flat&amp;logo=<LOGO_NAME>&amp;logoColor=white&amp;color=fff5e8\" alt=\"\"><br>\n<img src=\"https://img.shields.io/badge/Editor-VisualStudio2022-informational?style=flat&amp;logo=<LOGO_NAME>&amp;logoColor=white&amp;color=80ccff\" alt=\"\"><br>\n<img src=\"https://img.shields.io/badge/Editor-VisualStudioCode-informational?style=flat&amp;logo=<LOGO_NAME>&amp;logoColor=white&amp;color=424a53\" alt=\"\"><br>\n<img src=\"https://img.shields.io/badge/Editor-VisualStudioForMAC-informational?style=flat&amp;logo=<LOGO_NAME>&amp;logoColor=white&amp;color=80ccff\" alt=\"\"><br>\n<img src=\"https://img.shields.io/badge/Code-Csharp-informational?style=flat&amp;logo=<LOGO_NAME>&amp;logoColor=white&amp;color=FD8C73\" alt=\"\"><br>\n<img src=\"https://img.shields.io/badge/Code-JavaScript-informational?style=flat&amp;logo=<LOGO_NAME>&amp;logoColor=white&amp;color=0969da\" alt=\"\"><br>\n<img src=\"https://img.shields.io/badge/Code-Vue-informational?style=flat&amp;logo=<LOGO_NAME>&amp;logoColor=white&amp;color=b6e3ff\" alt=\"\"><br>\n<img src=\"https://img.shields.io/badge/Code-Python-informational?style=flat&amp;logo=<LOGO_NAME>&amp;logoColor=white&amp;color=2bbc8a\" alt=\"\"><br>\n<img src=\"https://img.shields.io/badge/Code-Go-informational?style=flat&amp;logo=<LOGO_NAME>&amp;logoColor=white&amp;color=80ccff\" alt=\"\"><br>\n<img src=\"https://img.shields.io/badge/Tools-Docker-informational?style=flat&amp;logo=<LOGO_NAME>&amp;logoColor=white&amp;color=eac54f\" alt=\"\"><br>\n<img src=\"https://img.shields.io/badge/Tools-AzureDevops-informational?style=flat&amp;logo=<LOGO_NAME>&amp;logoColor=white&amp;color=ffddb0\" alt=\"\"><br>\n<img src=\"https://img.shields.io/badge/Shell-PowerShell-informational?style=flat&amp;logo=<LOGO_NAME>&amp;logoColor=white&amp;color=f79939\" alt=\"\"><br>\n<img src=\"https://img.shields.io/badge/FrameWork-ASPNETCore-informational?style=flat&amp;logo=<LOGO_NAME>&amp;logoColor=white&amp;color=d8b9ff\" alt=\"\"><br>\n<img src=\"https://img.shields.io/badge/FrameWork-ABP-informational?style=flat&amp;logo=<LOGO_NAME>&amp;logoColor=white&amp;color=ffadda\" alt=\"\"></p>\n<h2>推荐项目</h2>\n<a href=\"https://github.com/luoyunchong/freekit\">\n  <img align=\"center\" src=\"https://github-readme-stats.vercel.app/api/pin/?username=luoyunchong&amp;repo=freekit&amp;title_color=fff&amp;icon_color=f9f9f9&amp;text_color=9f9f9f&amp;bg_color=151515\">\n</a>\n<a href=\"https://github.com/luoyunchong/igeekfan-docs\">\n  <img align=\"center\" src=\"https://github-readme-stats.vercel.app/api/pin/?username=luoyunchong&amp;repo=igeekfan-docs&amp;title_color=fff&amp;icon_color=f9f9f9&amp;text_color=9f9f9f&amp;bg_color=151515\">\n</a>\n<h2>联系我 💬</h2>\n<ul>\n<li><a href=\"https://github.com/luoyunchong\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong</a></li>\n<li><a href=\"https://www.cnblogs.com/igeekfan\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.cnblogs.com/igeekfan</a></li>\n<li><a href=\"mailto:luoyunchong@foxmail.com\" target=\"_blank\" rel=\"noopener noreferrer\">luoyunchong@foxmail.com</a></li>\n</ul>\n<p><img src=\"https://github-readme-stats.vercel.app/api?username=luoyunchong&amp;show_icons=true&amp;theme=radical\" alt=\"Anurag's github stats\"><br>\n<img src=\"https://github-readme-stats.vercel.app/api/top-langs/?username=luoyunchong&amp;theme=dark&amp;layout=compact\" alt=\"Most Used Languages\"></p>\n",
      "image": "https://img.shields.io/badge/OS-Win11-informational?style=flat&logo=<LOGO_NAME>&logoColor=white&color=2bbc8a",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2024-07-10T14:51:39.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "ColorUI",
      "url": "https://igeekfan.cn/igeekfan-docs/colorui/docs/",
      "id": "https://igeekfan.cn/igeekfan-docs/colorui/docs/",
      "summary": "ColorUI github https://github.com/weilanwl/ColorUI 特点 * 这是一个css库，相比其他vant-weapp、mpvue都是不一样的,非组件化，主要定位我觉得是美化主题，非组件化，支持uni-app、mpvue，可结合vant-weapp一起使用。 该文档作用 很简单，官方还没出文档，使用起来，需要开发...",
      "content_html": "\n<h2>github</h2>\n<ul>\n<li><a href=\"https://github.com/weilanwl/ColorUI\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/weilanwl/ColorUI</a></li>\n</ul>\n<h2>特点</h2>\n<p>*　这是一个css库，相比其他vant-weapp、mpvue都是不一样的,非组件化，主要定位我觉得是美化主题，非组件化，支持uni-app、mpvue，可结合vant-weapp一起使用。</p>\n<h2>该文档作用</h2>\n<p>很简单，官方还没出文档，使用起来，需要开发者自行去看main.css，打开手机看小程序的demo,然后再去找项目源码，我觉得太麻烦，不知道其他人的感受如何。</p>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2020-02-28T11:10:31.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Button 按钮",
      "url": "https://igeekfan.cn/igeekfan-docs/colorui/docs/button.html",
      "id": "https://igeekfan.cn/igeekfan-docs/colorui/docs/button.html",
      "summary": "Button 按钮",
      "content_html": "\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>&lt;button class=\"cu-btn\"&gt;默认&lt;/button&gt;</span></span>\n<span class=\"line\"><span>&lt;button class=\"cu-btn round\"&gt;圆角&lt;/button&gt;</span></span>\n<span class=\"line\"><span>&lt;button class=\"cu-btn icon\"&gt;</span></span>\n<span class=\"line\"><span>\t&lt;text class=\"cuIcon-emojifill\"&gt;&lt;/text&gt;</span></span>\n<span class=\"line\"><span>&lt;/button&gt;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>.cu-btn </span></span>\n<span class=\"line\"><span>.cu-btn::after</span></span>\n<span class=\"line\"><span>.cu-btn:not([class*=\"bg-\"]) </span></span>\n<span class=\"line\"><span>.cu-btn[class*=\"line\"] </span></span>\n<span class=\"line\"><span>.cu-btn[class*=\"line\"]::after</span></span>\n<span class=\"line\"><span>.cu-btn.round[class*=\"line\"]::after </span></span>\n<span class=\"line\"><span>.cu-btn[class*=\"lines\"]::after </span></span>\n<span class=\"line\"><span>.cu-btn[class*=\"bg-\"]::after </span></span>\n<span class=\"line\"><span>.cu-btn.sm </span></span>\n<span class=\"line\"><span>.cu-btn.lg </span></span>\n<span class=\"line\"><span>.cu-btn.cuIcon.sm </span></span>\n<span class=\"line\"><span>.cu-btn.cuIcon </span></span>\n<span class=\"line\"><span>button.cuIcon.lg </span></span>\n<span class=\"line\"><span>.cu-btn.shadow-blur::before </span></span>\n<span class=\"line\"><span>.cu-btn.button-hover </span></span>\n<span class=\"line\"><span>.block </span></span>\n<span class=\"line\"><span>.cu-btn.block </span></span>\n<span class=\"line\"><span>.cu-btn[disabled]</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>.cu-bar.btn-group</span></span>\n<span class=\"line\"><span>.cu-bar.btn-group button</span></span>\n<span class=\"line\"><span>.cu-bar.btn-group button</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2020-02-28T11:10:31.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Text 文本",
      "url": "https://igeekfan.cn/igeekfan-docs/colorui/docs/text.html",
      "id": "https://igeekfan.cn/igeekfan-docs/colorui/docs/text.html",
      "summary": "Text 文本",
      "content_html": "\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>.text-xs </span></span>\n<span class=\"line\"><span>.text-sm </span></span>\n<span class=\"line\"><span>.text-df </span></span>\n<span class=\"line\"><span>.text-lg </span></span>\n<span class=\"line\"><span>.text-xl </span></span>\n<span class=\"line\"><span>.text-xxl </span></span>\n<span class=\"line\"><span>.text-sl </span></span>\n<span class=\"line\"><span>.text-xsl </span></span>\n<span class=\"line\"><span>.text-Abc </span></span>\n<span class=\"line\"><span>.text-ABC </span></span>\n<span class=\"line\"><span>.text-abc </span></span>\n<span class=\"line\"><span>.text-price::before </span></span>\n<span class=\"line\"><span>.text-cut </span></span>\n<span class=\"line\"><span>.text-bold </span></span>\n<span class=\"line\"><span>.text-center </span></span>\n<span class=\"line\"><span>.text-content </span></span>\n<span class=\"line\"><span>.text-left </span></span>\n<span class=\"line\"><span>.text-right</span></span>\n<span class=\"line\"><span>.text-red</span></span>\n<span class=\"line\"><span>.line-red</span></span>\n<span class=\"line\"><span>.lines-red </span></span>\n<span class=\"line\"><span>.text-orange</span></span>\n<span class=\"line\"><span>.line-orange</span></span>\n<span class=\"line\"><span>.lines-orange</span></span>\n<span class=\"line\"><span>.text-yellow</span></span>\n<span class=\"line\"><span>.line-yellow</span></span>\n<span class=\"line\"><span>.lines-yellow </span></span>\n<span class=\"line\"><span>.text-olive</span></span>\n<span class=\"line\"><span>.line-olive</span></span>\n<span class=\"line\"><span>.lines-olive</span></span>\n<span class=\"line\"><span>.text-green</span></span>\n<span class=\"line\"><span>.line-green</span></span>\n<span class=\"line\"><span>.lines-green </span></span>\n<span class=\"line\"><span>.text-cyan</span></span>\n<span class=\"line\"><span>.line-cyan</span></span>\n<span class=\"line\"><span>.lines-cyan </span></span>\n<span class=\"line\"><span>.text-blue</span></span>\n<span class=\"line\"><span>.line-blue</span></span>\n<span class=\"line\"><span>.lines-blue </span></span>\n<span class=\"line\"><span>.text-purple</span></span>\n<span class=\"line\"><span>.line-purple</span></span>\n<span class=\"line\"><span>.lines-purple </span></span>\n<span class=\"line\"><span>.text-mauve</span></span>\n<span class=\"line\"><span>.line-mauve</span></span>\n<span class=\"line\"><span>.lines-mauve </span></span>\n<span class=\"line\"><span>.text-pink</span></span>\n<span class=\"line\"><span>.line-pink</span></span>\n<span class=\"line\"><span>.lines-pink </span></span>\n<span class=\"line\"><span>.text-brown</span></span>\n<span class=\"line\"><span>.line-brown</span></span>\n<span class=\"line\"><span>.lines-brown</span></span>\n<span class=\"line\"><span>.text-grey</span></span>\n<span class=\"line\"><span>.line-grey</span></span>\n<span class=\"line\"><span>.lines-grey </span></span>\n<span class=\"line\"><span>.text-gray</span></span>\n<span class=\"line\"><span>.line-gray</span></span>\n<span class=\"line\"><span>.lines-gray</span></span>\n<span class=\"line\"><span>.text-black</span></span>\n<span class=\"line\"><span>.line-black</span></span>\n<span class=\"line\"><span>.lines-black </span></span>\n<span class=\"line\"><span>.text-white</span></span>\n<span class=\"line\"><span>.line-white</span></span>\n<span class=\"line\"><span>.lines-white</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2020-02-28T11:10:31.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "RESTful+FreeSql+AutoMapper",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/FreeSql-sample-blog-RESTful-use-automapper.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/FreeSql-sample-blog-RESTful-use-automapper.html",
      "summary": "RESTful+FreeSql+AutoMapper 文章概述 本文使用ASP .NET Core的WEB API，构建一个RESTful风格的接口，使用Freesql访问MySQL数据库，实现二个表的简单博客，并集成AutoMapper。 接上一篇 FreeSql在ASP.NTE Core WebApi中如何使用的教程 项目源码 https://gi...",
      "content_html": "\n<h2>文章概述</h2>\n<p>本文使用ASP .NET Core的WEB API，构建一个RESTful风格的接口，使用Freesql访问MySQL数据库，实现二个表的简单博客，并集成AutoMapper。</p>\n<p>接上一篇</p>\n<ul>\n<li>\n<p><a href=\"http://blog.igeekfan.cn/2019/06/30/re-start/FreeSql-aspnetcore-how-to-use/\" target=\"_blank\" rel=\"noopener noreferrer\">FreeSql在ASP.NTE Core WebApi中如何使用的教程</a></p>\n</li>\n<li>\n<p>项目源码 <a href=\"https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-freesql\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-freesql</a></p>\n</li>\n</ul>\n<!-- more -->\n<h2>Dto作用</h2>\n<p>当我们使用RESTful提供接口时，比如创建一个博客，修改一下博客内容时，他们的参数是有区别的。良好的设计应该是</p>\n<p>创建一个博客</p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">POST /api/blog</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">data:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"title\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"string\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"content\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"string\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>修改一个博客内容</p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">PUT /api/blog</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">data:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"blogId\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"int\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"title\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"string\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"content\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"string\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>但一个blog 实体如下</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Blog</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Column</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">IsIdentity</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">IsPrimary</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> BlogId</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Title</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Content</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> DateTime</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> CreateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> virtual</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> List</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">Posts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>如果我们以Blog作为controllers中的参数时</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">       // POST api/blog</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpPost</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromBody</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CreateTime</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Now</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Insert</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrows</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>这时修改swagger显示的默认参数是</p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"blogId\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"title\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"string\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"content\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"string\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"createTime\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"2019-06-30T07:33:05.524Z\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"posts\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: [</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">      \"postId\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">      \"replyContent\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"string\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">      \"blogId\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">      \"replyTime\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"2019-06-30T07:33:05.524Z\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  ]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>如果我们不传递createTime，会出现异常，应该createTime是DateTime，不能为null，只有DateTime?才能为null,有?为可空类型。</p>\n<p>所以我们应该为POST方式传递过来时，新建一个实体类，我们称之为DTO(Data Transfer Object)，即数据传输对象，因为createTime即使传递，后端为他赋了值，前台传了也无效。有了DTO，这样可让前端清楚他们应该传递的参数，而不会出现没有作用的参数。</p>\n<p>在根目录创建Models/Blogs文件夹，在Blogs文件夹中创建</p>\n<h3>CreateBlogDto.cs</h3>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Models</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blogs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> CreateBlogDto</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Title</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Content</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>UpdateBlogDto.cs</h3>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Models</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blogs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> UpdateBlogDto</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> BlogId</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Title</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Content</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>有了Dto后，我们会发现了新的问题，往数据库插入时，往往使用了一些ORM,他们只支持原本的实体类，如Blog，Post。但不支持CreateBlogDto、UpdateBlogDto,我们可以手动，将一个类的值，赋值给另一个类。<br>\n如</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    CreateBlogDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> createBlogDto</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> CreateBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Title</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"我是title\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Content</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"我是content\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    Blog</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> newBlog</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Title</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> createBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Title</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Content</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> createBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Content</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    };</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>现在只是非常简单的二个属性，我们还能忍受，但如果是十个属性、而且有着大量的类与类之间的转换呢。这时修改AutoMapper就闪亮登场了。</p>\n<h2>AutoMapper</h2>\n<blockquote>\n<p>作用：A convention-based object-object mapper.</p>\n</blockquote>\n<p>我们是在ASP .NET Core下使用AutoMapper <a href=\"https://automapper.readthedocs.io/en/latest/Dependency-injection.html\" target=\"_blank\" rel=\"noopener noreferrer\">官网介绍，如何依赖注入中使用</a></p>\n<h3>Setup</h3>\n<p>先cd到dotnetcore-examples\\aspnetcore-freesql\\RESTful.FreeSql目录</p>\n<div class=\"language-powershell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"powershell\" data-title=\"powershell\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">PS </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> dotnet add package AutoMapper</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">PS </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> dotnet add package AutoMapper.Extensions.Microsoft.DependencyInjection </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">--</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">version </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">6.1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>在StartUp.cs中的ConfigureServices配置如下</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>   public void ConfigureServices(IServiceCollection services)</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        // .... Ignore code before this</span></span>\n<span class=\"line\"><span>        </span></span>\n<span class=\"line\"><span>        //AddAutoMapper会去找继承Profile的类，</span></span>\n<span class=\"line\"><span>        services.AddAutoMapper(AppDomain.CurrentDomain.GetAssemblies());</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>        // .... Ignore code after this</span></span>\n<span class=\"line\"><span>    }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>Adding Profiles</h3>\n<p>AutoMapper/BlogProfile.cs</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AutoMapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Domain</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Models</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blogs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AutoMapper</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> BlogProfile</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Profile</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> BlogProfile</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">() </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">            CreateMap</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreateBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">            CreateMap</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UpdateBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>AutoMapper/BlogProfile.cs</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AutoMapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Domain</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Models</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blogs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AutoMapper</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> PostProfile</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Profile</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> PostProfile</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">            CreateMap</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreatePostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>Models/Posts/SearchPostDto.cs根据博客id，得到分页的评论时，集成分页类</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Web</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Models</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Posts</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SearchPostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">:</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">PageDto</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> BlogId</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>Controlers/BlogController.cs文件中，注入IMapper,</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AutoMapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Microsoft</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AspNetCore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Mvc</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Collections</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Generic</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Domain</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Models</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blogs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Web</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Controllers</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Route</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"api/[controller]\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ApiController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> BlogController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ControllerBase</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // GET api/Blog</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IMapper</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> BlogController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IMapper</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            _fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            _mapper</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// 博客列表页 </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"pageDto\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">分页参数</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ActionResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">PagedResultDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromQuery</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">PageDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> pageDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            List</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">blogs</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">OrderByDescending</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CreateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Page</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">pageDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">PageNumber</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">pageDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">PageSize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            long</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> count</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Count</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> PagedResultDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">count</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">blogs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // GET api/blog/5</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"{id}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ActionResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            // eg.1 return _fsql.Select&lt;Blog&gt;().Where(a =&gt; a.Id == id).ToOne();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            // eg.2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToOne</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // POST api/blog</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpPost</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromBody</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreateBlogDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> createBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            Blog</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> blog</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Map</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">createBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CreateTime</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> DateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Now</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Insert</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrows</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // PUT api/blog</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpPut</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Put</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromBody</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UpdateBlogDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> updateBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //eg.1 更新指定列</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //_fsql.Update&lt;Blog&gt;(updateBlogDto.BlogId).Set(a =&gt; new Blog()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //    Title = updateBlogDto.Title,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //    Content = updateBlogDto.Content</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //}).ExecuteAffrows();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //eg.2将这个实体更新到数据库中。当更新时，会把其他列的值，如CreateTime也更新掉。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //使用IgnoreColumns可忽略某一些列。</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            Blog</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> blog</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Map</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">updateBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Update</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SetSource</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">IgnoreColumns</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CreateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrows</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // DELETE api/blog/5</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpDelete</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"{id}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Delete</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Delete</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">BlogId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> }).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrows</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>Controlers/BlogController.cs文件中，注入IMapper,</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Microsoft</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AspNetCore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Mvc</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Collections</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Generic</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Threading</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Tasks</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AutoMapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Domain</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Models</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Posts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Web</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Controllers</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Route</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"api/[controller]\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ApiController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> PostController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ControllerBase</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // GET: api/Post</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IMapper</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> PostController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IMapper</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            _fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            _mapper</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// 根据博客id、分页条件查询评论信息</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"searchPostDto\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> PagedResultDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SearchPostDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> searchPostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            ISelect</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">selectPost</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> _fsql</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">BlogId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> searchPostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">BlogId</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            List</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">posts</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> selectPost</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">OrderByDescending</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ReplyTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Page</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">searchPostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">PageNumber</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">searchPostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">PageSize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            long</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> total</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> selectPost</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Count</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> PagedResultDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">total</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">posts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // GET: api/Post/5</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"{id}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">Name</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"Get\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Post</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">a</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> a</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">PostId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToOne</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // POST: api/Post</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpPost</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromBody</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreatePostDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> createPostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            Post</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> post</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Map</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">createPostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ReplyTime</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> DateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Now</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Insert</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrows</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // DELETE: api/Post/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpDelete</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"{id}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> DeleteAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">            await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Delete</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">PostId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> }).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrowsAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>参考</h3>\n<ul>\n<li>建议大家先看官网 <a href=\"http://automapper.org/\" target=\"_blank\" rel=\"noopener noreferrer\">http://automapper.org/</a></li>\n<li>开源地址 <a href=\"https://github.com/AutoMapper/AutoMapper\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/AutoMapper/AutoMapper</a></li>\n<li>Getting-started 文档 <a href=\"https://automapper.readthedocs.io/en/latest/Getting-started.html#what-is-automapper\" target=\"_blank\" rel=\"noopener noreferrer\">https://automapper.readthedocs.io/en/latest/Getting-started.html#what-is-automapper</a></li>\n</ul>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2020-05-08T15:01:00.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "IdentityServer4",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/IdentityServer4.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/IdentityServer4.html",
      "summary": "IdentityServer4 写的一些IdentityServer4的示例 IdentityServer4 实现单点登录授权token验证 源码 代码托管在GitHub上 https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-identityserver4 ...",
      "content_html": "\n<h2>写的一些IdentityServer4的示例</h2>\n<p>IdentityServer4 实现单点登录授权token验证</p>\n<h2>源码</h2>\n<p>代码托管在GitHub上 <a href=\"https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-identityserver4\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-identityserver4</a></p>\n<h2>参考</h2>\n<ul>\n<li><a href=\"https://www.cnblogs.com/edisonchou/p/identityserver4_foundation_and_quickstart_01.html\" target=\"_blank\" rel=\"noopener noreferrer\">.NET Core微服务之基于IdentityServer建立授权与验证服务</a></li>\n</ul>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2020-05-08T15:01:00.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "ImCore 即时通讯",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/ImCore-Chat.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/ImCore-Chat.html",
      "summary": "ImCore 即时通讯 简介 利用 webSocket 协议实现简易、高性能、集群即时通讯组件，支持点对点通讯、群聊通讯、上线下线事件消息等众多实用性功能。 开源地址 https://github.com/2881099/im 示例 https://github.com/luoyunchong/dotnetcore-examples/tree/mast...",
      "content_html": "\n<h2>简介</h2>\n<p>利用 webSocket 协议实现简易、高性能、集群即时通讯组件，支持点对点通讯、群聊通讯、上线下线事件消息等众多实用性功能。</p>\n<h2>开源地址</h2>\n<p><a href=\"https://github.com/2881099/im\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/2881099/im</a></p>\n<h2>示例</h2>\n<p><a href=\"https://github.com/luoyunchong/dotnetcore-examples/tree/master/dotnet-core-im\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/dotnetcore-examples/tree/master/dotnet-core-im</a></p>\n<h2>演示效果</h2>\n<p><img src=\"https://ae01.alicdn.com/kf/Hf8b31f05dbb94f8da565fce29f78aa78Y.png\" alt=\"https://ae01.alicdn.com/kf/Hf8b31f05dbb94f8da565fce29f78aa78Y.png\"></p>\n",
      "image": "https://ae01.alicdn.com/kf/Hf8b31f05dbb94f8da565fce29f78aa78Y.png",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2020-02-28T11:10:31.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": ".NET Core 学习示例文档",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/",
      "summary": ".NET Core 学习示例文档 浏览左侧导航菜单以深入了解文档. .NET Core 学习示例文档主要是结合 ASP .NET Core，集成第三方类库的示例，运用基础组件，写好 Demo。 源码 代码托管在 GitHub 上 https://github.com/luoyunchong/dotnetcore-examples 推荐阅读 Micros...",
      "content_html": "\n<p>浏览左侧导航菜单以深入了解文档.</p>\n<p>.NET Core 学习示例文档主要是结合 ASP .NET Core，集成第三方类库的示例，运用基础组件，写好 Demo。</p>\n<h2>源码</h2>\n<p>代码托管在 GitHub 上 <a href=\"https://github.com/luoyunchong/dotnetcore-examples\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/dotnetcore-examples</a></p>\n<h2>推荐阅读</h2>\n<ul>\n<li>Microsoft Docs <a href=\"https://docs.microsoft.com/zh-cn\" target=\"_blank\" rel=\"noopener noreferrer\">https://docs.microsoft.com/zh-cn</a><br>\n其中包含如下\n<ul>\n<li>.NET Core 指北 <a href=\"https://docs.microsoft.com/zh-cn/dotnet/core/\" target=\"_blank\" rel=\"noopener noreferrer\">https://docs.microsoft.com/zh-cn/dotnet/core/</a></li>\n<li>ASP .NET 文档 <a href=\"https://docs.microsoft.com/zh-cn/aspnet/\" target=\"_blank\" rel=\"noopener noreferrer\">https://docs.microsoft.com/zh-cn/aspnet/</a></li>\n<li>.NET Core CLI 文档 <a href=\"https://docs.microsoft.com/zh-cn/dotnet/core/tools/?tabs=netcore2x\" target=\"_blank\" rel=\"noopener noreferrer\">https://docs.microsoft.com/zh-cn/dotnet/core/tools/?tabs=netcore2x</a></li>\n</ul>\n</li>\n</ul>\n<h2>本地环境说明</h2>\n<ul>\n<li>Windows 10 (18922.rs_prerelease.190614-1427)</li>\n<li>.NET Core 3.0.100-preview6-012264</li>\n<li>Visual Studio Code 1.35.1、Microsoft Visual Studio 2019 16.1.3</li>\n<li>PowerSheel</li>\n<li>MySQL 5.7.25</li>\n<li>Navicat Premium 12 <a href=\"http://blog.igeekfan.cn/2018/06/02/%E5%A4%A7%E5%90%8E%E7%AB%AF/Navicat%20Premium%2012%20%20%E7%A0%B4%E8%A7%A3%E7%89%88%E5%85%8D%E8%B4%B9%E4%B8%8B%E8%BD%BD/\" target=\"_blank\" rel=\"noopener noreferrer\">欢迎下载</a></li>\n</ul>\n<h2>Install</h2>\n<p>本地开发选择 SDK 安装即可，还是安装 2.2 的吧，3.0（19.6.29）目前还没有发布稳定版本。</p>\n<ul>\n<li>安装这个 <strong><a href=\"https://dotnet.microsoft.com/download/dotnet-core/2.2\" target=\"_blank\" rel=\"noopener noreferrer\">https://dotnet.microsoft.com/download/dotnet-core/2.2</a></strong></li>\n<li><a href=\"https://dotnet.microsoft.com/download/dotnet-core/3.0\" target=\"_blank\" rel=\"noopener noreferrer\">https://dotnet.microsoft.com/download/dotnet-core/3.0</a></li>\n</ul>\n<p>安装后，在 PowerShell 中任一目录查看安装后的版本</p>\n<div class=\"language-powershell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"powershell\" data-title=\"powershell\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">PS C:\\WINDOWS\\system3</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">2&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> dotnet </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">--</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">version</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">3.0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">100</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">-</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">preview6</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">-</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">012264</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 本地安装了好几个.net core sdk版本</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">PS C:\\WINDOWS\\system3</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">2&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> dotnet </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">--</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">list</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">-</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">sdks</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">2.1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">700</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">C</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">:\\</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">Program</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> Files</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\\</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">dotnet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\\</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">sdk</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">2.2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">300</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">C</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">:\\</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">Program</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> Files</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\\</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">dotnet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\\</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">sdk</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">3.0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">100</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">-</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">preview6</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">-</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">012264</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> [</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">C</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">:\\</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">Program</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> Files</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\\</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">dotnet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">\\</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">sdk</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>CLI</h2>\n<p>全称：command-line interface，命令行界面，主要是 cmd、bash(sh 等等)、powershell 等。</p>\n<blockquote>\n<p>说明 <strong>所有命令行都在 windows10 自带的 powershell 中执行。</strong></p>\n</blockquote>\n<h3>指定 SDK 版本</h3>\n<p>.NET Core 项目默认使用最新版本的 .NET Core，在根目录使用 PowerShell 中执行如下命令，</p>\n<p>语法 ：dotnet new global.json --sdk-version &lt;SDK 版本号&gt;</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>dotnet new globaljson --sdk-version 2.2.300</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>参考</p>\n<ul>\n<li><a href=\"https://docs.microsoft.com/zh-cn/dotnet/core/tools/dotnet-new?tabs=netcore22\" target=\"_blank\" rel=\"noopener noreferrer\">dotnet new 命令行</a></li>\n<li><a href=\"https://docs.microsoft.com/zh-cn/dotnet/core/versions/selection?view=dotnet-plat-ext-2.1\" target=\"_blank\" rel=\"noopener noreferrer\">选择要使用的 .NET Core 版本</a></li>\n</ul>\n<h2>.NET Core</h2>\n<p>.NET Core 是什么？ 官网说的太高大上了 <a href=\"https://docs.microsoft.com/zh-cn/dotnet/core/about\" target=\"_blank\" rel=\"noopener noreferrer\">https://docs.microsoft.com/zh-cn/dotnet/core/about</a></p>\n<p>总结，.NET Core 包含如下</p>\n<ul>\n<li>二个 RunTime\n<ul>\n<li>.NET Core RunTime：基础类型系统 、垃圾回收、基元类型等，</li>\n<li>ASP .NET RunTime ：提供 WEB、LOT 等应用程序的框架支持。</li>\n</ul>\n</li>\n<li>.NET Core CLI 工具：各种命令行工具，创建项目、编译项目，发布项目等；</li>\n<li>语言编译器：（支持 C#、F#、VB 等语言）</li>\n<li>dotnet 工具：.NET Core 运行时和库的安装程序包</li>\n</ul>\n<p>三个发布包：</p>\n<ul>\n<li>.NET Core 运行时</li>\n<li>ASP .NET Core 运行时</li>\n<li>.NET Core SDK：包括上面二个内容，再加上 .NET CLI 工具等</li>\n</ul>\n<p>所以本地调试时，可直接安装最全的 SDK 即可。</p>\n<h2>项目文档</h2>\n<p>目前 关于此项目的文档放到 docs 文件夹中，zh-Hans 为中文，这样可支持多语言，欢迎翻译 PR，之后会发布至</p>\n<ul>\n<li>文档官网 <a href=\"https://luoyunchong.github.io/vuepress-docs/\" target=\"_blank\" rel=\"noopener noreferrer\">https://luoyunchong.github.io/vuepress-docs/</a></li>\n</ul>\n<p>将使用 abp vnext 下的 modules 的<a href=\"https://github.com/abpframework/abp/blob/dev/modules/docs/README.md\" target=\"_blank\" rel=\"noopener noreferrer\">docs 模块</a>。不过 abp vnext 现在也不稳定，0.18.1，还是有各种问题，我还是写基础模块的使用文档吧，后期完善后，发布文档网站。</p>\n<h2>说明</h2>\n<p>本项目也是我的学习记录，，用于测试不同类库集成的解决方案，所以用最基础的方案，<strong>命令行</strong>来创建项目，引用包，运行，测试等。让自己对 .net core 的原理结构了解地更加深入一些。</p>\n<ul>\n<li>采用的都是 Visual Studio Code/VS2019 +PowerShell 运行，关于如何采用 Visual Studio 2019 创建项目，引用包是非常简单的，不再说明。</li>\n</ul>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2022-08-15T16:21:26.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "FreeSql+ASP.NET Core",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/freesql-in-aspnetcore-webapi-how-to-use.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/freesql-in-aspnetcore-webapi-how-to-use.html",
      "summary": "FreeSql+ASP.NET Core 文章概述 主要在介绍FreeSql在ASP.NTE Core WebApi中如何使用的过程，完成一个最简单的博客系统的后端接口。 FreeSql 简介 国人写的一个功能强大的ORM,FreeSql 支持 MySql/SqlServer/PostgreSQL/Oracle/Sqlite，特点：轻量级、可扩展、基于...",
      "content_html": "\n<h2>文章概述</h2>\n<p>主要在介绍FreeSql在ASP.NTE Core WebApi中如何使用的过程，完成一个最简单的博客系统的后端接口。</p>\n<h2>FreeSql 简介</h2>\n<p>国人写的一个功能强大的ORM,FreeSql 支持 MySql/SqlServer/PostgreSQL/Oracle/Sqlite，特点：轻量级、可扩展、基于 .NET Standard 跨平台。</p>\n<h2>源码</h2>\n<p>代码托管在GitHub上 <a href=\"https://github.com/luoyunchong/dotnetcore-examples/blob/master/ORM/FreeSql/OvOv.FreeSql.Repository/Controllers/BlogController.cs\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/dotnetcore-examples</a></p>\n<h2>参考</h2>\n<ul>\n<li>FreeSql github <a href=\"https://github.com/dotnetcore/FreeSql\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/dotnetcore/FreeSql</a></li>\n<li><a href=\"https://docs.microsoft.com/zh-cn/dotnet/core/tools/dotnet-new?tabs=netcore22\" target=\"_blank\" rel=\"noopener noreferrer\">关于.net core cli中如何使用dotnet new</a></li>\n<li><a href=\"https://docs.microsoft.com/zh-cn/aspnet/core/web-api/?view=aspnetcore-2.2\" target=\"_blank\" rel=\"noopener noreferrer\">使用 ASP.NET Core 创建 Web API</a></li>\n<li><a href=\"https://docs.microsoft.com/zh-cn/aspnet/core/tutorials/web-api-help-pages-using-swagger?view=aspnetcore-2.2\" target=\"_blank\" rel=\"noopener noreferrer\">Swagger/OpenAPI 生成接口文档</a></li>\n<li><a href=\"https://github.com/domaindrivendev/Swashbuckle.AspNetCore\" target=\"_blank\" rel=\"noopener noreferrer\">Swagger GitHub (Swashbuckle.AspNetCore)</a></li>\n</ul>\n<h2>项目准备</h2>\n<ul>\n<li>Mysql 5.6</li>\n<li>Visual Studio 2019或2017、Visual Studio code</li>\n<li>.NET Core 3.1+</li>\n<li>PowerShell</li>\n<li>懂点mvc，该教程不会教你如何使用 ASP .NET Core MVC、RESTful</li>\n</ul>\n<h3>创建项目</h3>\n<p>使用dotnet 命令行创建一个webapi项目，起名为OvOv.FreeSql</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>PS dotnetcore-examples\\aspnetcore-freesql&gt; dotnet new webapi -n OvOv.FreeSql</span></span>\n<span class=\"line\"><span>The template \"ASP.NET Core Web API\" was created successfully.</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>然后cd 到OvOv.FreeSql目录，通过dotnet run 命令运行项目</p>\n<div class=\"language-powershell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"powershell\" data-title=\"powershell\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">PS dotnetcore</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">-</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">examples\\aspnetcore</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">-</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">freesql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> cd .\\OvOv.FreeSql\\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">PS dotnetcore</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">-</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">examples\\aspnetcore</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">-</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">freesql\\OvOv.FreeSql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> dotnet run</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">info: Microsoft.Hosting.Lifetime[</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      Now listening on: https:</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">//</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">localhost:</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">5001</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">info: Microsoft.Hosting.Lifetime[</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      Now listening on: http:</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">//</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">localhost:</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">5000</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">info: Microsoft.Hosting.Lifetime[</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      Application started. Press Ctrl</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">+</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">C to shut down.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">info: Microsoft.Hosting.Lifetime[</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      Hosting environment: Development</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">info: Microsoft.Hosting.Lifetime[</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      Content root path: D:\\code\\github\\dotnetcore</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">-</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">examples\\aspnetcore</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">-</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">freesql\\OvOv.FreeSql</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>打开浏览器 <a href=\"https://localhost:5001\" target=\"_blank\" rel=\"noopener noreferrer\">https://localhost:5001</a> 会出现404</p>\n<p>请打开这个地址 <a href=\"https://localhost:5001/api/values\" target=\"_blank\" rel=\"noopener noreferrer\">https://localhost:5001/api/values</a> ，可看到如下内容。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>[\"value1\",\"value2\"]</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>接下来我们来集成FreeSql，我们以最简单的命令和说明，详细内容去官网看具体内容</p>\n<ul>\n<li>官网文档 <a href=\"http://freesql.net/doc\" target=\"_blank\" rel=\"noopener noreferrer\">http://freesql.net/doc</a></li>\n</ul>\n<h2>Install</h2>\n<p>要先cd到OvOv.FreeSql目录中。</p>\n<div class=\"language-powershell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"powershell\" data-title=\"powershell\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">PS \\aspnetcore</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">-</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">freesql\\OvOv.FreeSql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> dotnet add package FreeSql</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">PS \\aspnetcore</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">-</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">freesql\\OvOv.FreeSql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> dotnet add package FreeSql.Provider.MySql</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>code first</h2>\n<ul>\n<li><a href=\"https://github.com/dotnetcore/FreeSql/blob/master/Docs/codefirst.md\" target=\"_blank\" rel=\"noopener noreferrer\">关于CodeFirst，官方文档的介绍</a></li>\n</ul>\n<p>代码优先，使用过EntityFramework的应该很清楚这一概念，我的理解就是：在分析数据库表关系时，不通过在数据库中设计表，而是直接在代码中声明对应的类，使用导航属性代替外键关联，通过数据表字段与C#中的类库对应，从而自动生成数据表。</p>\n<h2>db first</h2>\n<p>数据库优先：需求分析后，直接设计数据库，通过数据库中的表，直接生成代码，类。</p>\n<h2>开始</h2>\n<h3>分析需求</h3>\n<p>我们以code first 为示例，学习如何使用freesql，实现一个简单的博客。将表内容分为博客表（Blog)和评论表（Post)</p>\n<h4>Blog 表</h4>\n<p>| 字段名     | 字段类型     | 说明     |<br>\n|</p>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2022-10-20T16:01:01.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "RESTful+FreeSql+AutoMapper",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/freesql-sample-blog-restful-use-automapper.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/freesql-sample-blog-restful-use-automapper.html",
      "summary": "RESTful+FreeSql+AutoMapper 文章概述 本文使用ASP .NET Core的WEB API，构建一个RESTful风格的接口，使用Freesql访问MySQL数据库，实现二个表的简单博客，并集成AutoMapper。 接上一篇 FreeSql在ASP.NTE Core WebApi中如何使用的教程 项目源码 https://gi...",
      "content_html": "\n<h2>文章概述</h2>\n<p>本文使用ASP .NET Core的WEB API，构建一个RESTful风格的接口，使用Freesql访问MySQL数据库，实现二个表的简单博客，并集成AutoMapper。</p>\n<p>接上一篇</p>\n<ul>\n<li>\n<p><a href=\"http://blog.igeekfan.cn/2019/06/30/re-start/FreeSql-aspnetcore-how-to-use/\" target=\"_blank\" rel=\"noopener noreferrer\">FreeSql在ASP.NTE Core WebApi中如何使用的教程</a></p>\n</li>\n<li>\n<p>项目源码 <a href=\"https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-freesql\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-freesql</a></p>\n</li>\n</ul>\n<!-- more -->\n<h2>Dto作用</h2>\n<p>当我们使用RESTful提供接口时，比如创建一个博客，修改一下博客内容时，他们的参数是有区别的。良好的设计应该是</p>\n<p>创建一个博客</p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">POST /api/blog</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">data:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"title\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"string\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"content\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"string\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>修改一个博客内容</p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">PUT /api/blog</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">data:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"blogId\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">:</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"int\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"title\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"string\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"content\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"string\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>但一个blog 实体如下</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Blog</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Column</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">IsIdentity</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">IsPrimary</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> BlogId</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Title</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Content</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> DateTime</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> CreateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> virtual</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> List</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">Posts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>如果我们以Blog作为controllers中的参数时</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">       // POST api/blog</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpPost</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromBody</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CreateTime</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Now</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Insert</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrows</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>这时修改swagger显示的默认参数是</p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"blogId\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"title\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"string\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"content\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"string\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"createTime\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"2019-06-30T07:33:05.524Z\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"posts\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: [</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">      \"postId\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">      \"replyContent\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"string\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">      \"blogId\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">      \"replyTime\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"2019-06-30T07:33:05.524Z\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  ]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>如果我们不传递createTime，会出现异常，应该createTime是DateTime，不能为null，只有DateTime?才能为null,有?为可空类型。</p>\n<p>所以我们应该为POST方式传递过来时，新建一个实体类，我们称之为DTO(Data Transfer Object)，即数据传输对象，因为createTime即使传递，后端为他赋了值，前台传了也无效。有了DTO，这样可让前端清楚他们应该传递的参数，而不会出现没有作用的参数。</p>\n<p>在根目录创建Models/Blogs文件夹，在Blogs文件夹中创建</p>\n<h3>CreateBlogDto.cs</h3>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Models</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blogs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> CreateBlogDto</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Title</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Content</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>UpdateBlogDto.cs</h3>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Models</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blogs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> UpdateBlogDto</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> BlogId</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Title</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Content</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>有了Dto后，我们会发现了新的问题，往数据库插入时，往往使用了一些ORM,他们只支持原本的实体类，如Blog，Post。但不支持CreateBlogDto、UpdateBlogDto,我们可以手动，将一个类的值，赋值给另一个类。<br>\n如</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    CreateBlogDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> createBlogDto</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> CreateBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Title</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"我是title\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Content</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"我是content\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    Blog</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> newBlog</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Title</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> createBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Title</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Content</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> createBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Content</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    };</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>现在只是非常简单的二个属性，我们还能忍受，但如果是十个属性、而且有着大量的类与类之间的转换呢。这时修改AutoMapper就闪亮登场了。</p>\n<h2>AutoMapper</h2>\n<blockquote>\n<p>作用：A convention-based object-object mapper.</p>\n</blockquote>\n<p>我们是在ASP .NET Core下使用AutoMapper <a href=\"https://automapper.readthedocs.io/en/latest/Dependency-injection.html\" target=\"_blank\" rel=\"noopener noreferrer\">官网介绍，如何依赖注入中使用</a></p>\n<h3>Setup</h3>\n<p>先cd到dotnetcore-examples\\aspnetcore-freesql\\RESTful.FreeSql目录</p>\n<div class=\"language-powershell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"powershell\" data-title=\"powershell\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">PS </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> dotnet add package AutoMapper</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">PS </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> dotnet add package AutoMapper.Extensions.Microsoft.DependencyInjection </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">--</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">version </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">6.1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>在StartUp.cs中的ConfigureServices配置如下</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>   public void ConfigureServices(IServiceCollection services)</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        // .... Ignore code before this</span></span>\n<span class=\"line\"><span>        </span></span>\n<span class=\"line\"><span>        //AddAutoMapper会去找继承Profile的类，</span></span>\n<span class=\"line\"><span>        services.AddAutoMapper(AppDomain.CurrentDomain.GetAssemblies());</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>        // .... Ignore code after this</span></span>\n<span class=\"line\"><span>    }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>Adding Profiles</h3>\n<p>AutoMapper/BlogProfile.cs</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AutoMapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Domain</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Models</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blogs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AutoMapper</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> BlogProfile</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Profile</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> BlogProfile</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">() </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">            CreateMap</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreateBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">            CreateMap</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UpdateBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>AutoMapper/BlogProfile.cs</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AutoMapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Domain</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Models</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blogs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AutoMapper</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> PostProfile</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Profile</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> PostProfile</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">            CreateMap</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreatePostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>Models/Posts/SearchPostDto.cs根据博客id，得到分页的评论时，集成分页类</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Web</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Models</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Posts</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SearchPostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">:</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">PageDto</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> BlogId</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>Controlers/BlogController.cs文件中，注入IMapper,</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AutoMapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Microsoft</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AspNetCore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Mvc</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Collections</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Generic</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Domain</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Models</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blogs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Web</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Controllers</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Route</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"api/[controller]\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ApiController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> BlogController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ControllerBase</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // GET api/Blog</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IMapper</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> BlogController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IMapper</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            _fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            _mapper</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// 博客列表页 </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"pageDto\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">分页参数</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ActionResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">PagedResultDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromQuery</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">PageDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> pageDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            List</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">blogs</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">OrderByDescending</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CreateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Page</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">pageDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">PageNumber</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">pageDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">PageSize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            long</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> count</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Count</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> PagedResultDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">count</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">blogs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // GET api/blog/5</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"{id}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ActionResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            // eg.1 return _fsql.Select&lt;Blog&gt;().Where(a =&gt; a.Id == id).ToOne();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            // eg.2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToOne</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // POST api/blog</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpPost</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromBody</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreateBlogDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> createBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            Blog</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> blog</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Map</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">createBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CreateTime</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> DateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Now</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Insert</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrows</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // PUT api/blog</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpPut</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Put</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromBody</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UpdateBlogDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> updateBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //eg.1 更新指定列</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //_fsql.Update&lt;Blog&gt;(updateBlogDto.BlogId).Set(a =&gt; new Blog()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //    Title = updateBlogDto.Title,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //    Content = updateBlogDto.Content</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //}).ExecuteAffrows();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //eg.2将这个实体更新到数据库中。当更新时，会把其他列的值，如CreateTime也更新掉。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            //使用IgnoreColumns可忽略某一些列。</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            Blog</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> blog</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Map</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">updateBlogDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Update</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SetSource</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">IgnoreColumns</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CreateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrows</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // DELETE api/blog/5</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpDelete</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"{id}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Delete</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Delete</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Blog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">BlogId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> }).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrows</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>Controlers/BlogController.cs文件中，注入IMapper,</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Microsoft</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AspNetCore</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Mvc</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Collections</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Generic</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> System</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Threading</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Tasks</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AutoMapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Domain</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Models</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Posts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">using</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Web</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> RESTful</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FreeSql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Controllers</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Route</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"api/[controller]\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ApiController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> PostController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ControllerBase</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // GET: api/Post</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IMapper</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> PostController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IFreeSql</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IMapper</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            _fsql</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            _mapper</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// 根据博客id、分页条件查询评论信息</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"searchPostDto\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> PagedResultDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">SearchPostDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> searchPostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            ISelect</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">selectPost</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> _fsql</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">BlogId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> searchPostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">BlogId</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            List</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">posts</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> selectPost</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">OrderByDescending</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ReplyTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Page</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">searchPostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">PageNumber</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">searchPostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">PageSize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            long</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> total</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> selectPost</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Count</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> PagedResultDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">total</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">posts</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // GET: api/Post/5</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"{id}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">Name</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> \"Get\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Post</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Select</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">a</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> a</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">PostId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToOne</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // POST: api/Post</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpPost</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromBody</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">] </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CreatePostDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> createPostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">            Post</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> post</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _mapper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Map</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">createPostDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ReplyTime</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> DateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Now</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Insert</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrows</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // DELETE: api/Post/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpDelete</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"{id}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> DeleteAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">            await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _fsql</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Delete</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Post</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">PostId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> }).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ExecuteAffrowsAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>参考</h3>\n<ul>\n<li>建议大家先看官网 <a href=\"http://automapper.org/\" target=\"_blank\" rel=\"noopener noreferrer\">http://automapper.org/</a></li>\n<li>开源地址 <a href=\"https://github.com/AutoMapper/AutoMapper\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/AutoMapper/AutoMapper</a></li>\n<li>Getting-started 文档 <a href=\"https://automapper.readthedocs.io/en/latest/Getting-started.html#what-is-automapper\" target=\"_blank\" rel=\"noopener noreferrer\">https://automapper.readthedocs.io/en/latest/Getting-started.html#what-is-automapper</a></li>\n</ul>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2020-05-08T15:01:00.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "IdentityServer4",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/identityserver4.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/identityserver4.html",
      "summary": "IdentityServer4 写的一些IdentityServer4的示例 IdentityServer4 实现单点登录授权token验证 源码 代码托管在GitHub上 https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-identityserver4 ...",
      "content_html": "\n<h2>写的一些IdentityServer4的示例</h2>\n<p>IdentityServer4 实现单点登录授权token验证</p>\n<h2>源码</h2>\n<p>代码托管在GitHub上 <a href=\"https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-identityserver4\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-identityserver4</a></p>\n<h2>参考</h2>\n<ul>\n<li><a href=\"https://www.cnblogs.com/edisonchou/p/identityserver4_foundation_and_quickstart_01.html\" target=\"_blank\" rel=\"noopener noreferrer\">.NET Core微服务之基于IdentityServer建立授权与验证服务</a></li>\n</ul>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2022-06-02T11:44:24.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "ImCore 即时通讯",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/imcore-chat.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/imcore-chat.html",
      "summary": "ImCore 即时通讯 简介 利用 webSocket 协议实现简易、高性能、集群即时通讯组件，支持点对点通讯、群聊通讯、上线下线事件消息等众多实用性功能。 开源地址 https://github.com/2881099/im 示例 https://github.com/luoyunchong/dotnetcore-examples/tree/mast...",
      "content_html": "\n<h2>简介</h2>\n<p>利用 webSocket 协议实现简易、高性能、集群即时通讯组件，支持点对点通讯、群聊通讯、上线下线事件消息等众多实用性功能。</p>\n<h2>开源地址</h2>\n<p><a href=\"https://github.com/2881099/im\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/2881099/im</a></p>\n<h2>示例</h2>\n<p><a href=\"https://github.com/luoyunchong/dotnetcore-examples/tree/master/dotnet-core-im\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/dotnetcore-examples/tree/master/dotnet-core-im</a></p>\n<h2>演示效果</h2>\n<p><img src=\"https://ae01.alicdn.com/kf/Hf8b31f05dbb94f8da565fce29f78aa78Y.png\" alt=\"https://ae01.alicdn.com/kf/Hf8b31f05dbb94f8da565fce29f78aa78Y.png\"></p>\n",
      "image": "https://ae01.alicdn.com/kf/Hf8b31f05dbb94f8da565fce29f78aa78Y.png",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2022-06-02T11:44:24.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "七牛云对象存储",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/qiniu-object-storages.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/examples/qiniu-object-storages.html",
      "summary": "七牛云对象存储 .NET Core 下集成 七牛云下的对象存储 开源地址 OvOv.MQiniu.Core 集成类库 前提 本地 windows 10,安装 .net core 2.2+ Linux 服务器 Ubuntu Server 16+ 服务器安装了 Docker 本地 xftp、xshell（这二个分别是 windows 传文件至 linux，...",
      "content_html": "\n<p>.NET Core 下集成 七牛云下的对象存储</p>\n<h2>开源地址</h2>\n<p><a href=\"https://github.com/luoyunchong/dotnetcore-examples/tree/master/999-Others/OvOv.MQiniu.Core\" target=\"_blank\" rel=\"noopener noreferrer\">OvOv.MQiniu.Core</a></p>\n<h2>集成类库</h2>\n<p>| 基础类库集成方案                                                                                      | 开源地址                                                                                            | 文档                                                       | 说明                                                                                              |<br>\n|</p>\n",
      "image": "https://upload-images.jianshu.io/upload_images/2001974-bcd72707e4fcc7f8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2022-06-02T18:18:50.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "认证鉴权状态",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/IdentityServer4-JWT.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/IdentityServer4-JWT.html",
      "summary": "认证鉴权状态 认证分为以下情况：当前角色为管理员，该分组配置了权限，该分组未分配某一方法的权限. 状态码（StatusCode):401 UnAuthorized 未登录，不带access_token，直接请求需要登录的接口、管理员接口结果一样。 返回结果应为：状态码：401 UNAUTHORIZED 携带access_token，但非超级管理员(ad...",
      "content_html": "\n<p>认证分为以下情况：当前角色为管理员，该分组配置了权限，该分组未分配某一方法的权限.</p>\n<p>状态码（StatusCode):401 UnAuthorized</p>\n<p>| StatusCode                | 含义                   |<br>\n|</p>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2020-07-24T17:10:08.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "产品设计",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/Production-Design.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/Production-Design.html",
      "summary": "产品设计 产品设计-评论模块的设计 1.主题式 将评论分为二级，第一级采用时间倒序，二级按照时间正序，有助于理解上下文关系。 用户操作： 评论随笔(内容支持超链接、emoji) 点赞评论/取消点赞 回复评论 删除自己的评论 运营操作： 审核通过/拉黑评论 删除任何评论 拉黑后的显示逻辑。（保留当前区块、显示内容为：该评论因违规被拉黑） 删除：（如果是二...",
      "content_html": "\n<h2>产品设计-评论模块的设计</h2>\n<h3>1.主题式</h3>\n<p>将评论分为二级，第一级采用时间倒序，二级按照时间正序，有助于理解上下文关系。</p>\n<p>用户操作：</p>\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-0\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-0\"> 评论随笔(内容支持超链接、emoji)</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-1\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-1\">  点赞评论/取消点赞</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-2\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-2\">  回复评论</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-3\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-3\">  删除自己的评论</label></li>\n</ul>\n<p>运营操作：</p>\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-4\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-4\">  审核通过/拉黑评论</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-5\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-5\">  删除任何评论</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-6\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-6\">  拉黑后的显示逻辑。（保留当前区块、显示内容为：该评论因违规被拉黑）</label></li>\n<li>删除：（如果是二级评论，直接软删除，如果是一级评论，软删除子评论和当前评论-需要提前提醒用户）<br>\n交互设计</li>\n<li>评论的字数长度（500）、emoji。</li>\n<li>点赞交互-动画、消息通知/推送</li>\n<li>评论区域元素，需要有明确可点击的区域，会跳转到哪个地方。</li>\n</ul>\n<h3>优化</h3>\n<ul>\n<li>精选评论</li>\n</ul>\n<h2>排行榜见解</h2>\n<p>排行榜从心理学上分析，主要从四个方面影响着您：<strong>寻找权威 、参与比较 、关注主流 、自我确认。</strong></p>\n<p>如何设计一个简单的排行榜呢。。</p>\n<p>在一个博客随笔中，我们设计一个3天、七天（周榜）、30天（月榜）、全部的榜单。以浏览量（权重1）、点赞量（20）、评论量（30)。权重可自己定义。</p>\n<p>1.默认取最新的随笔</p>\n<p>前台传create_time时，使用如下sql</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>select * from `blog_article` order by create_time desc;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>2.传排序方式为最近n天的热榜时。</p>\n<p>参数：THREE_DAYS_HOTTEST（三天）、WEEKLY_HOTTEST(七天）、MONTHLY_HOTTEST（一个月）、HOTTEST（全部）</p>\n<p>mysql 查询当前日期时间前三天数据</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>select date_sub(now() ,interval 3 day);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>根据权重查询</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>select * from `blog_article` a </span></span>\n<span class=\"line\"><span>where a.`create_time`&gt;(select date_sub(now() ,interval 3 day))</span></span>\n<span class=\"line\"><span>order by (a.`view_hits` + a.`likes_quantity` * 20 + a.`comment_quantity` * 30) DESC, a.`create_time` DESC</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>创作者中心</h2>\n<h3>用户主页</h3>\n<p>统计值：阅读总数，点赞总数，关注者总数</p>\n<h3>个人设置</h3>\n<p>用户信息、密码修改</p>\n<h2>更多参考</h2>\n<ul>\n<li><a href=\"http://www.woshipm.com/pd/1255548.html\" target=\"_blank\" rel=\"noopener noreferrer\">万字长文深度分析：产品排行榜的设计和玩法</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/52322777\" target=\"_blank\" rel=\"noopener noreferrer\">想知道谁是你的最佳用户？基于Redis实现排行榜周期榜与最近N期榜</a></li>\n</ul>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2020-07-24T17:10:08.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "LinCMS.NET",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/",
      "summary": "LinCMS.NET 😃 基于ASP.NET Core的简洁实用的CMS开发框架 项目介绍 Lin CMS .NET是Lin-CMS的.NET实现，采用ASP.NET Core 9.0构建，基于Vue.js的前后端分离CMS平台。项目实现了以下功能： 核心权限管理系统 基础字典项管理 随笔专栏系统 评论点赞功能 消息通知中心 标签管理系统 仿掘金社区...",
      "content_html": "<p></p>\n<h1><a class=\"header-anchor\" href=\"#lincms-net\"><span></span></a><a href=\"http://LinCMS.NET\" target=\"_blank\" rel=\"noopener noreferrer\">LinCMS.NET</a></h1>\n<div align=\"center\">\n  <img width=\"200\" src=\"https://consumerminiaclprd01.blob.core.chinacloudapi.cn/miniappbackground/sfgmember/lin/left-logo.png\">\n</div>\n<div align=\"center\">😃 基于ASP.NET Core的简洁实用的CMS开发框架</div>\n<h2>项目介绍</h2>\n<p>Lin CMS .NET是<a href=\"https://github.com/TaleLin\" target=\"_blank\" rel=\"noopener noreferrer\">Lin-CMS</a>的.NET实现，<a href=\"http://xn--ASP-bs1h843j.NET\" target=\"_blank\" rel=\"noopener noreferrer\">采用ASP.NET</a> Core 9.0构建，基于Vue.js的前后端分离CMS平台。项目实现了以下功能：</p>\n<ul>\n<li>核心权限管理系统</li>\n<li>基础字典项管理</li>\n<li>随笔专栏系统</li>\n<li>评论点赞功能</li>\n<li>消息通知中心</li>\n<li>标签管理系统</li>\n<li>仿掘金社区模块</li>\n</ul>\n<blockquote>\n<p>LinCMS源于林间有风团队的项目实践，是一套内容管理系统解决方案。<a href=\"http://xn--15qz0w2xcd4jsjlb4lbva941k9wx.NET\" target=\"_blank\" rel=\"noopener noreferrer\">该项目是完全开源的.NET</a> Core社区实现版本。</p>\n</blockquote>\n<h2>线上演示</h2>\n<ul>\n<li>API文档：<a href=\"https://api.igeekfan.cn/swagger/index.html\" target=\"_blank\" rel=\"noopener noreferrer\">Swagger</a></li>\n<li>用户端：<a href=\"https://igeekfan.cn/vvlog\" target=\"_blank\" rel=\"noopener noreferrer\">VVLog</a>\n<ul>\n<li>普通用户账号：710277267@qq.com</li>\n<li>密码：123qwe</li>\n</ul>\n</li>\n<li>管理端：<a href=\"https://igeekfan.cn/cms/\" target=\"_blank\" rel=\"noopener noreferrer\">CMS后台</a>\n<ul>\n<li>管理员账号：admin</li>\n<li>密码：123qwe</li>\n</ul>\n</li>\n</ul>\n<h2>开源地址</h2>\n<ul>\n<li>后端源码：\n<ul>\n<li><a href=\"https://github.com/luoyunchong/lin-cms-dotnetcore\" target=\"_blank\" rel=\"noopener noreferrer\">GitHub</a></li>\n<li><a href=\"https://gitee.com/igeekfan/lin-cms-dotnetcore\" target=\"_blank\" rel=\"noopener noreferrer\">Gitee</a></li>\n</ul>\n</li>\n<li>前端源码：\n<ul>\n<li>管理后台：<a href=\"https://github.com/luoyunchong/lin-cms-vue\" target=\"_blank\" rel=\"noopener noreferrer\">lin-cms-vue</a></li>\n<li>用户前台：<a href=\"https://github.com/luoyunchong/lin-cms-vvlog\" target=\"_blank\" rel=\"noopener noreferrer\">lin-cms-vvlog</a></li>\n</ul>\n</li>\n</ul>\n<h2>项目文档</h2>\n<ul>\n<li><strong>快速开始</strong>\n<ul>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/backend-quickstart.html\" target=\"_blank\">后端快速入门</a></li>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/frontend-quickstart.html\" target=\"_blank\">前端快速入门</a></li>\n</ul>\n</li>\n<li><strong>核心概念</strong>\n<ul>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/technology-stack.html\" target=\"_blank\">技术栈</a></li>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/project-structure.html\" target=\"_blank\">项目结构</a></li>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/database-design.html\" target=\"_blank\">数据库设计</a></li>\n</ul>\n</li>\n<li><strong>开发</strong>\n<ul>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/development-guide.html\" target=\"_blank\">开发指南示例</a></li>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/api-reference.html\" target=\"_blank\">API 参考</a> (Swagger)</li>\n</ul>\n</li>\n<li><strong>部署</strong>\n<ul>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/deployment.html\" target=\"_blank\">部署指南</a></li>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/github-actions.html\" target=\"_blank\">GitHub Actions CI/CD</a></li>\n</ul>\n</li>\n<li><strong>其他</strong>\n<ul>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/faq.html\" target=\"_blank\">常见问题</a></li>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/contributing.html\" target=\"_blank\">贡献指南</a></li>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/authorize.html\" target=\"_blank\">权限认证</a></li>\n<li><a href=\"/igeekfan-docs/dotnetcore/lin-cms/file-upload.html\" target=\"_blank\">文件上传</a></li>\n</ul>\n</li>\n</ul>\n<h2>核心特性</h2>\n<h3>前后端分离架构</h3>\n<p>LinCMS采用前后端分离的开发模式：</p>\n<ul>\n<li>后端：<a href=\"http://ASP.NET\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET</a> Core API，提供数据和业务逻辑</li>\n<li>前端：基于Vue的单页面应用，提供交互界面</li>\n</ul>\n<p>相比传统的服务端渲染方式（如Razor），前后端分离模式具有以下优势：</p>\n<ul>\n<li>前端开发者和后端开发者可以专注各自的领域</li>\n<li>更流畅的用户体验和更灵活的界面交互</li>\n<li>更好的可扩展性和可维护性</li>\n</ul>\n<h3>完整的权限解决方案</h3>\n<p>系统内置了完整的RBAC权限管理功能：</p>\n<ul>\n<li>基于角色的用户分组</li>\n<li>细粒度的API权限控制</li>\n<li>动态权限分配</li>\n<li>操作日志记录</li>\n<li>支持第三方OAuth登录（GitHub、Gitee等）</li>\n</ul>\n<h3>丰富的扩展功能</h3>\n<ul>\n<li>文件上传系统：支持本地存储和七牛云</li>\n<li>内容管理系统：标签、分类、文章管理</li>\n<li>互动系统：评论、点赞、关注</li>\n<li>消息通知：系统消息、互动提醒</li>\n</ul>\n<h2>技术栈</h2>\n<h3>后端技术</h3>\n<ul>\n<li><a href=\"http://ASP.NET\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET</a> Core 9.0：Web框架</li>\n<li>FreeSql：ORM框架，支持多种数据库</li>\n<li>IdentityServer4：认证授权框架</li>\n<li>AutoMapper：对象映射</li>\n<li>Serilog：日志框架</li>\n<li>CAP：分布式事务和事件总线</li>\n</ul>\n<h3>前端技术</h3>\n<ul>\n<li>Vue.js：渐进式JavaScript框架</li>\n<li>Element Plus：UI组件库</li>\n<li>Vuex：状态管理</li>\n<li>Vue Router：前端路由</li>\n<li>Axios：HTTP请求库</li>\n</ul>\n<h2>快速开始</h2>\n<h3>环境要求</h3>\n<ul>\n<li>.NET SDK 9.0+</li>\n<li>MySQL 5.7+ / SqlServer / PostgreSQL / Oracle / SQLite</li>\n<li>Node.js 16+（前端开发）</li>\n</ul>\n<h3>后端启动</h3>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 克隆项目</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">git</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> clone</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> https://github.com/luoyunchong/lin-cms-dotnetcore.git</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 进入项目目录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">cd</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> lin-cms-dotnetcore/src/LinCms.Web</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 修改数据库连接</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 编辑 appsettings.json 中的ConnectionStrings配置</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 运行项目</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">dotnet</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>详细安装指南请参考<a href=\"/igeekfan-docs/dotnetcore/lin-cms/dotnetcore-start.html\" target=\"_blank\">后端准备指南</a></p>\n<h3>前端启动</h3>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" data-title=\"bash\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 克隆项目</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">git</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> clone</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> https://github.com/luoyunchong/lin-cms-vue.git</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 安装依赖</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">pnpm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> install</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 启动开发服务器</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">pnpm</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> run</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> serve</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>详细安装指南请参考<a href=\"/igeekfan-docs/dotnetcore/lin-cms/vue-start.html\" target=\"_blank\">前端准备指南</a></p>\n<h2>目录结构</h2>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>├─ src</span></span>\n<span class=\"line\"><span>│  ├─ LinCms.Web         // API层</span></span>\n<span class=\"line\"><span>│  ├─ LinCms.Application // 应用服务层</span></span>\n<span class=\"line\"><span>│  ├─ LinCms.Application.Contracts // 应用服务接口与DTO</span></span>\n<span class=\"line\"><span>│  ├─ LinCms.Infrastructure // 基础设施层</span></span>\n<span class=\"line\"><span>│  ├─ LinCms.Core        // 核心领域层</span></span>\n<span class=\"line\"><span>│  └─ LinCms.Plugins     // 插件扩展</span></span>\n<span class=\"line\"><span>├─ test</span></span>\n<span class=\"line\"><span>│  └─ LinCms.Test        // 单元测试</span></span>\n<span class=\"line\"><span>└─ LinCms.Scaffolding    // 代码生成器</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>社区贡献</h2>\n<p>欢迎加入LinCMS社区，您可以通过以下方式参与项目：</p>\n<ul>\n<li>提交Bug或功能请求到<a href=\"https://github.com/luoyunchong/lin-cms-dotnetcore/issues\" target=\"_blank\" rel=\"noopener noreferrer\">GitHub Issues</a></li>\n</ul>\n<h2>许可证</h2>\n<p>本项目采用<a href=\"https://github.com/luoyunchong/lin-cms-dotnetcore/blob/master/LICENSE\" target=\"_blank\" rel=\"noopener noreferrer\">MIT许可证</a></p>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2025-04-28T17:00:03.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "获取控制器及方法特性标签",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/Reflex-Assembly.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/Reflex-Assembly.html",
      "summary": "获取控制器及方法特性标签 .NET Core 反射获取所有控制器及方法上特定标签. 有个需求，就是在. NET Core 中，我们想在项目 启动时，获取 LinCmsAuthorizeAttribute 这个特性标签所有出现的地方，把他的参数，放入一个集合并缓存起来，以便后面使用此数据用于权限验证。 我们通过反射获取所有控制器下及方法的 Attribu...",
      "content_html": "\n<blockquote>\n<p>.NET Core 反射获取所有控制器及方法上特定标签.</p>\n</blockquote>\n<p>有个需求，就是在. NET Core 中，我们想在项目 启动时，获取 LinCmsAuthorizeAttribute 这个特性标签所有出现的地方，把他的参数，放入一个集合并缓存起来，以便后面使用此数据用于权限验证。</p>\n<p>我们通过反射获取所有控制器下及方法的 Attribute。</p>\n<h2>LinCmsAuthorizeAttribute 是什么</h2>\n<p>其代码非常简单，用于自定义权限验证，通过重写 OnAuthorizationAsync 方法，实现固定权限可分配给动态角色（也能分配给动态用户）。主要就<strong>基于权限的授权</strong>的实现进行研究，实现方法级别的权限验证。</p>\n<ul>\n<li><a href=\"https://www.cnblogs.com/RainingNight/p/dynamic-authorization-in-aspnetcore.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.cnblogs.com/RainingNight/p/dynamic-authorization-in-aspnetcore.html</a></li>\n</ul>\n<p>当然，这个只是部分代码，完整代码请查看最下方开源地址，其中 LinCmsAuthorizeAttribute 继承 AuthorizeAttribute，拥有指定角色权限控制，当 Permission 未指定时，当过滤器与 Authorize 功能相同。Module 是指模块，即多个权限，属于同一个模块，方便前台展示为树型结构。Permission 属性的值不可重复。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AttributeUsage</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">AttributeTargets</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Class</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> |</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> AttributeTargets</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Method</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">AllowMultiple</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCmsAuthorizeAttribute</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AuthorizeAttribute</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IAsyncAuthorizationFilter</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Permission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\"> Module</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">set</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> LinCmsAuthorizeAttribute</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> LinCmsAuthorizeAttribute</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> permission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> module</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Permission</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> permission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Module</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> module</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> LinCmsAuthorizeAttribute</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> permission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> module</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> policy</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) : </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\">base</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">policy</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Permission</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> permission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        Module</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> module</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> async</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Task</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> OnAuthorizationAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">AuthorizationFilterContext</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> context</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Permission</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> ==</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> null</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">) </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> authorizationService</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IAuthorizationService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">context</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">HttpContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">RequestServices</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IAuthorizationService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> authorizationResult</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> authorizationService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AuthorizeAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">context</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">HttpContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">User</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">null</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> OperationAuthorizationRequirement</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">() { </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Name</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> Permission</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> });</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">!</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">authorizationResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Succeeded</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            context</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Result</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ForbidResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ToString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\"> $\"</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\"</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">{</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\">base</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToString</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">()}</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\"</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">,</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\"</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">Permission:{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Permission</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">}</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\"</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">,</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\"</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">Module:{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Module</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">}</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\"</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">,</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\"</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">Roles:{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Roles</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">}</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\"</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">,</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\"</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">Policy:{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">Policy</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">}</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\"</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">,</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\"</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">AuthenticationSchemes:{</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">AuthenticationSchemes</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">}</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\">\\\"</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>Controller</h2>\n<p>在 <a href=\"http://LinCms.Web\" target=\"_blank\" rel=\"noopener noreferrer\">LinCms.Web</a> 中的 Controller，至于为什么 Permission 为中文，目前的主要原因，此项目用于适配 <a href=\"https://github.com/TaleLin/lin-cms-vue\" target=\"_blank\" rel=\"noopener noreferrer\">Lin-CMS-VUE</a>项目,所以于平常我们以某个字符串作为权限名不同，但不须大惊小怪，道理相同。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Route</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"cms/log\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ApiController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LogController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ControllerBase</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ILogService</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _logService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> LogController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ILogService</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> logService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        _logService</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> logService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"users\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"查询日志记录的用户\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"日志\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> List</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetLoggedUsers</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromQuery</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">PageDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> pageDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _logService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetLoggedUsers</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">pageDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"查询所有日志\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"日志\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> PagedResultDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinLog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetLogs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromQuery</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LogSearchDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> searchDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _logService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetLogUsers</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">searchDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"search\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"搜索日志\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"日志\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> PagedResultDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinLog</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SearchLogs</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">([</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">FromQuery</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LogSearchDto</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> searchDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _logService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetLogUsers</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">searchDto</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>测试类获取方法上的特定标签</h2>\n<p>in xunit test 项目工程中，开始我们的测试</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Fact</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> GetAssemblyMethodsAttributes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> assembly</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Assembly</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AsEnumerable</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">type</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ControllerBase</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">IsAssignableFrom</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">type</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    assembly</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ForEach</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">r</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        foreach</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> methodInfo</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> in</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> r</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetMethods</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">())</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            foreach</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Attribute</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> attribute</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> in</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> methodInfo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetCustomAttributes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">())</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">                if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">attribute</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> is</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCmsAuthorizeAttribute</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> linCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">                    _testOutputHelper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">linCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">                }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    });</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>方法结果</h2>\n<p>可在输出文本中查看，正是我们想要的东西，最后一行，是其他 Controller 中的内容，而且我们重写了 ToString(),所以我们能看到其属性。</p>\n<div class=\"language-text line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"text\" data-title=\"text\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>\"LinCms.Zero.Authorization.LinCmsAuthorizeAttribute\",\"Permission:查询日志记录的用户\",\"Module:日志\",\"Roles:\",\"Policy:\",\"AuthenticationSchemes:\"</span></span>\n<span class=\"line\"><span>\"LinCms.Zero.Authorization.LinCmsAuthorizeAttribute\",\"Permission:查询所有日志\",\"Module:日志\",\"Roles:\",\"Policy:\",\"AuthenticationSchemes:\"</span></span>\n<span class=\"line\"><span>\"LinCms.Zero.Authorization.LinCmsAuthorizeAttribute\",\"Permission:搜索日志\",\"Module:日志\",\"Roles:\",\"Policy:\",\"AuthenticationSchemes:\"</span></span>\n<span class=\"line\"><span>\"LinCms.Zero.Authorization.LinCmsAuthorizeAttribute\",\"Permission:查看lin的信息\",\"Module:信息\",\"Roles:\",\"Policy:\",\"AuthenticationSchemes:\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>获取控制器上特性标签</h2>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// 获取控制器上的LinCmsAuthorizeAttribute</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// \"LinCms.Zero.Authorization.LinCmsAuthorizeAttribute\",\"Permission:\",\"Module:\",\"Roles:Administrator\",\"Policy:\",\"AuthenticationSchemes:\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Fact</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> GetControllerAttributes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> assembly</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Assembly</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetTypes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AsEnumerable</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">type</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> typeof</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ControllerBase</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">IsAssignableFrom</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">type</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToList</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    assembly</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ForEach</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">d</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> linCmsAuthorize</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> d</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetCustomAttribute</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorizeAttribute</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">linCmsAuthorize</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> !=</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> null</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">            _testOutputHelper</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteLine</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">linCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    });</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>Controller 结果</h2>\n<p>只有 AdminController 加了此标签，所以只有一行。</p>\n<div class=\"language-text line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"text\" data-title=\"text\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>\"LinCms.Zero.Authorization.LinCmsAuthorizeAttribute\",\"Permission:\",\"Module:\",\"Roles:Administrator\",\"Policy:\",\"AuthenticationSchemes:\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>此时 Roles 为 Administrator，Permission 及 Module 都是 null，<br>\n这是因为只有 AdminController 中加了 LinGroup.Administrator=\"Administrator\"字符串，在登录过程中，已经给当前登录用户设置了 new Claim(ClaimTypes.Role,user.IsAdmin()?LinGroup.Administrator:user.GroupId.ToString())，即\"Administrator,当用户访问 AdminController 中的方法时，LinCmsAuthorize 并没有做相关验证，都是 AuthorizeAttribute，实现了固定角色权限的判断及登录的判断。LinCmsAuthorize 完成了固定权限设置为不同的动态角色后，判断用户是否拥有此权限。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">LinCmsAuthorize</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">Roles</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> LinGroup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Administrator</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> AdminController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ControllerBase</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    ...</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>参考</h2>\n<ul>\n<li>c# – 如何在 asp. net core rc2 中获取控制器的自定义属性 <a href=\"https://codeday.me/bug/20181207/453278.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://codeday.me/bug/20181207/453278.html</a></li>\n</ul>\n<h2>开源地址</h2>\n<ul>\n<li><a href=\"github.com/luoyunchong/lin-cms-dotnetcore\">github.com/luoyunchong/lin-cms-dotnetcore</a></li>\n</ul>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2022-09-13T11:34:29.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "全局敏感词处理",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/StopWords.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/StopWords.html",
      "summary": "全局敏感词处理 基于ToolGood.Words类库，配合敏感字的文本文件，写的API接口。 https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-stopwords 一共二种方式 1.ToolGood.Words 类库配合敏感库 ToolGood.Words...",
      "content_html": "\n<p>基于ToolGood.Words类库，配合敏感字的文本文件，写的API接口。</p>\n<ul>\n<li><a href=\"https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-stopwords\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-stopwords</a></li>\n</ul>\n<p>一共二种方式</p>\n<h2>1.ToolGood.Words</h2>\n<p>类库配合敏感库</p>\n<ul>\n<li><a href=\"https://github.com/toolgood/ToolGood.Words\" target=\"_blank\" rel=\"noopener noreferrer\">ToolGood.Words</a></li>\n</ul>\n<p>简单用法</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>[Fact]</span></span>\n<span class=\"line\"><span>public void IssuesTest_17()</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    var illegalWordsSearch = new IllegalWordsSearch();</span></span>\n<span class=\"line\"><span>    string s = \"中国|zg人|abc\";</span></span>\n<span class=\"line\"><span>    illegalWordsSearch.SetKeywords(s.Split('|'));</span></span>\n<span class=\"line\"><span>    var str = illegalWordsSearch.Replace(\"我是中美国人厉害中国完美ａｂｃddb好的\", '*');</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    Assert.Equal(\"我是中美国人厉害**完美***ddb好的\", str);</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>配合敏感库文本文件，写的工具类</p>\n<p>二个文件放到wwwroot/_Illegal目录下，通过ReplaceStopWords方法调用即可对</p>\n<ul>\n<li><a href=\"https://github.com/toolgood/ToolGood.Words/blob/master/csharp/ToolGood.Words.Test/_Illegal/IllegalKeywords.txt\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/toolgood/ToolGood.Words/blob/master/csharp/ToolGood.Words.Test/_Illegal/IllegalKeywords.txt</a></li>\n<li><a href=\"https://github.com/toolgood/ToolGood.Words/blob/master/csharp/ToolGood.Words.Test/_Illegal/IllegalUrls.txt\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/toolgood/ToolGood.Words/blob/master/csharp/ToolGood.Words.Test/_Illegal/IllegalUrls.txt</a></li>\n</ul>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>public class ToolGoodUtils</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    //敏感库只要这二个文件存在即可</span></span>\n<span class=\"line\"><span>    //本地敏感库缓存-https://github.com/toolgood/ToolGood.Words/tree/master/csharp/ToolGood.Words.Test/_Illegal</span></span>\n<span class=\"line\"><span>    //因为需要上传至github并同步gitee,安全起见，所以未上传至git，需要自行下载并复制</span></span>\n<span class=\"line\"><span>    private const string KeywordsPath = \"wwwroot/_Illegal/IllegalKeywords.txt\";</span></span>\n<span class=\"line\"><span>    private const string UrlsPath = \"wwwroot/_Illegal/IllegalUrls.txt\";</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    private const string InfoPath = \"wwwroot/_Illegal/IllegalInfo.txt\";</span></span>\n<span class=\"line\"><span>    private const string BitPath = \"wwwroot/_Illegal/IllegalBit.iws\";</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    private static IllegalWordsSearch _search;</span></span>\n<span class=\"line\"><span>    /// &lt;summary&gt;</span></span>\n<span class=\"line\"><span>    /// 本地敏感库,文件修改后，重新创建缓存Bit</span></span>\n<span class=\"line\"><span>    /// &lt;/summary&gt;</span></span>\n<span class=\"line\"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>\n<span class=\"line\"><span>    public static IllegalWordsSearch GetIllegalWordsSearch()</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        if (_search == null)</span></span>\n<span class=\"line\"><span>        {</span></span>\n<span class=\"line\"><span>            string ipath = Path.GetFullPath(InfoPath);</span></span>\n<span class=\"line\"><span>            if (File.Exists(ipath) == false)</span></span>\n<span class=\"line\"><span>            {</span></span>\n<span class=\"line\"><span>                _search = CreateIllegalWordsSearch();</span></span>\n<span class=\"line\"><span>            }</span></span>\n<span class=\"line\"><span>            else</span></span>\n<span class=\"line\"><span>            {</span></span>\n<span class=\"line\"><span>                var texts = File.ReadAllText(ipath).Split('|');</span></span>\n<span class=\"line\"><span>                if (new FileInfo(Path.GetFullPath(KeywordsPath)).LastWriteTime.ToString(\"yyyy-MM-dd HH:mm:ss\") !=</span></span>\n<span class=\"line\"><span>                    texts[0] ||</span></span>\n<span class=\"line\"><span>                    new FileInfo(Path.GetFullPath(UrlsPath)).LastWriteTime.ToString(\"yyyy-MM-dd HH:mm:ss\") !=</span></span>\n<span class=\"line\"><span>                    texts[1]</span></span>\n<span class=\"line\"><span>                )</span></span>\n<span class=\"line\"><span>                {</span></span>\n<span class=\"line\"><span>                    _search = CreateIllegalWordsSearch();</span></span>\n<span class=\"line\"><span>                }</span></span>\n<span class=\"line\"><span>                else</span></span>\n<span class=\"line\"><span>                {</span></span>\n<span class=\"line\"><span>                    var s = new IllegalWordsSearch();</span></span>\n<span class=\"line\"><span>                    s.Load(Path.GetFullPath(BitPath));</span></span>\n<span class=\"line\"><span>                    _search = s;</span></span>\n<span class=\"line\"><span>                }</span></span>\n<span class=\"line\"><span>            }</span></span>\n<span class=\"line\"><span>        }</span></span>\n<span class=\"line\"><span>        return _search;</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    private static IllegalWordsSearch CreateIllegalWordsSearch()</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        string[] words1 = File.ReadAllLines(Path.GetFullPath(KeywordsPath), Encoding.UTF8);</span></span>\n<span class=\"line\"><span>        string[] words2 = File.ReadAllLines(Path.GetFullPath(UrlsPath), Encoding.UTF8);</span></span>\n<span class=\"line\"><span>        var words = new List&lt;string&gt;();</span></span>\n<span class=\"line\"><span>        foreach (var item in words1)</span></span>\n<span class=\"line\"><span>        {</span></span>\n<span class=\"line\"><span>            words.Add(item.Trim());</span></span>\n<span class=\"line\"><span>        }</span></span>\n<span class=\"line\"><span>        foreach (var item in words2)</span></span>\n<span class=\"line\"><span>        {</span></span>\n<span class=\"line\"><span>            words.Add(item.Trim());</span></span>\n<span class=\"line\"><span>        }</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>        var search = new IllegalWordsSearch();</span></span>\n<span class=\"line\"><span>        search.SetKeywords(words);</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>        search.Save(Path.GetFullPath(BitPath));</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>        var text = new FileInfo(Path.GetFullPath(KeywordsPath)).LastWriteTime.ToString(\"yyyy-MM-dd HH:mm:ss\") + \"|\"+ new FileInfo(Path.GetFullPath(UrlsPath)).LastWriteTime.ToString(\"yyyy-MM-dd HH:mm:ss\");</span></span>\n<span class=\"line\"><span>        File.WriteAllText(Path.GetFullPath(InfoPath), text);</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>        return search;</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>2. 循环使用Replace</h2>\n<p>方案：通过维护敏感库，循环replace<br>\n大佬分享给我的，稍微改成了从文件中获取敏感字。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>public static class StopWords</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    static readonly ConcurrentDictionary&lt;string, bool&gt; FunNlpDataSensitive = new ConcurrentDictionary&lt;string, bool&gt;();</span></span>\n<span class=\"line\"><span>    static readonly ConcurrentDictionary&lt;int, string&gt; ReplaceNewValue = new ConcurrentDictionary&lt;int, string&gt;();</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    private const string KeywordsPath = \"wwwroot/_Illegal/IllegalKeywords.txt\";</span></span>\n<span class=\"line\"><span>    private const string UrlsPath = \"wwwroot/_Illegal/IllegalUrls.txt\";</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    static StopWords()</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        LoadDataFromFile();</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    public static void LoadDataFromFile()</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        string words1 = File.ReadAllText(Path.GetFullPath(KeywordsPath), Encoding.UTF8);</span></span>\n<span class=\"line\"><span>        string words2 = File.ReadAllText(Path.GetFullPath(UrlsPath), Encoding.UTF8);</span></span>\n<span class=\"line\"><span>        LoadDataFromText(words1);</span></span>\n<span class=\"line\"><span>        LoadDataFromText(words2);</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    public static void LoadDataFromText(string text)</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        int oldcount = FunNlpDataSensitive.Count;</span></span>\n<span class=\"line\"><span>        foreach (string wd in text.Split('\\n'))</span></span>\n<span class=\"line\"><span>        {</span></span>\n<span class=\"line\"><span>            string keykey = wd.Trim().Trim('\\r', '\\n').Trim();</span></span>\n<span class=\"line\"><span>            if (string.IsNullOrEmpty(keykey)) continue;</span></span>\n<span class=\"line\"><span>            FunNlpDataSensitive.TryAdd(keykey, true);</span></span>\n<span class=\"line\"><span>            if (ReplaceNewValue.ContainsKey(keykey.Length) == false)</span></span>\n<span class=\"line\"><span>                ReplaceNewValue.TryAdd(keykey.Length, \"\".PadRight(keykey.Length, '*'));</span></span>\n<span class=\"line\"><span>        }</span></span>\n<span class=\"line\"><span>        Console.WriteLine($\"敏感词加载完毕，增加数量：{FunNlpDataSensitive.Count - oldcount}\");</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    /// &lt;summary&gt;</span></span>\n<span class=\"line\"><span>    /// 替换所有敏感词为 *</span></span>\n<span class=\"line\"><span>    /// &lt;/summary&gt;</span></span>\n<span class=\"line\"><span>    /// &lt;param name=\"that\"&gt;&lt;/param&gt;</span></span>\n<span class=\"line\"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>\n<span class=\"line\"><span>    public static string ReplaceStopWords(this string that)</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        foreach (var wd in FunNlpDataSensitive.Keys)</span></span>\n<span class=\"line\"><span>            that = that.Replace(wd, ReplaceNewValue.TryGetValue(wd.Length, out var tryval) ? tryval : \"\".PadRight(wd.Length, '*'));</span></span>\n<span class=\"line\"><span>        return that;</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>FreeSql全局处理敏感词</h2>\n<p>使用FreeSql这个ORM时，全局处理string类型的值，进行敏感词处理。代码在StartUp.cs的构造函数中。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>//敏感词处理</span></span>\n<span class=\"line\"><span>IllegalWordsSearch illegalWords = ToolGoodUtils.GetIllegalWordsSearch();</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>Fsql.Aop.AuditValue += (s, e) =&gt;</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    if (e.Column.CsType == typeof(string) &amp;&amp; e.Value != null)</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        string oldVal = (string)e.Value;</span></span>\n<span class=\"line\"><span>        string newVal = illegalWords.Replace(oldVal);</span></span>\n<span class=\"line\"><span>        //第二种处理敏感词的方式</span></span>\n<span class=\"line\"><span>        //string newVal = oldVal.ReplaceStopWords();</span></span>\n<span class=\"line\"><span>        if (newVal != oldVal)</span></span>\n<span class=\"line\"><span>        {</span></span>\n<span class=\"line\"><span>            e.Value = newVal;</span></span>\n<span class=\"line\"><span>        }</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span>};</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2020-07-24T17:10:08.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "依赖注入scrutor",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/dependency-injection-scrutor.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/dependency-injection-scrutor.html",
      "summary": "依赖注入scrutor 官网介绍 https://docs.microsoft.com/zh-cn/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-2.2 开源地址https://github.com/khellang/Scrutor 参考文档 https://www.cnbl...",
      "content_html": "\n<p>官网介绍</p>\n<p><a href=\"https://docs.microsoft.com/zh-cn/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-2.2\" target=\"_blank\" rel=\"noopener noreferrer\">https://docs.microsoft.com/zh-cn/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-2.2</a></p>\n<ul>\n<li>开源地址<a href=\"https://github.com/khellang/Scrutor\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/khellang/Scrutor</a></li>\n<li>参考文档 <a href=\"https://www.cnblogs.com/catcher1994/p/10316928.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.cnblogs.com/catcher1994/p/10316928.html</a><br>\n手动管理依赖注入过于麻烦,当有多个仓储，服务，无法统一注入，<a href=\"http://xn--ScrutorASP-2j4p127aslb656gqgmrg3hkrta.NET\" target=\"_blank\" rel=\"noopener noreferrer\">Scrutor能帮助我们简化ASP.NET</a> Core的DI注册。</li>\n</ul>\n<p>在ConfigServices中，我们原本需要这样子依次注入仓储，服务和其他接口及实现，当有多个仓储时，这样就过于繁琐。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddTransient</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IUserRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UserRepository</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddTransient</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">IUserService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">UserService</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddTransient</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ICurrentUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">CurrentUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>Serivce后缀服务注入DI</h2>\n<p>当我们有多个Service后缀的服务时，使用以下方法，可将服务扫描只留下以Serivce结尾的类，将其类型注册为提供所有公共接口生成服务，其生命周期为Transient，</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Scan</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">scan</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> scan</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //加载Startup这个类所在的程序集</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">FromAssemblyOf</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // 表示要注册那些类，上面的代码还做了过滤，只留下了以 Service 结尾的类</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddClasses</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">classes</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> classes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">t</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> t</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Name</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">EndsWith</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Service\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">StringComparison</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">OrdinalIgnoreCase</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //表示将类型注册为提供其所有公共接口作为服务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AsImplementedInterfaces</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        //表示注册的生命周期为 Transient</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WithTransientLifetime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">         );</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>ITransientDependency</h2>\n<p>新建一个空接口，当其他类继承此接口后，统一注入到DI中，以Transient的生命周期。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">namespace</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Zero</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Dependency</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> interface</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ITransientDependency</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>接口</h2>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> interface</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ICurrentUser</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">? </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">Id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">? </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">GroupId</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    bool</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">? </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">IsAdmin</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> { </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">; }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>模拟实现</h2>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> CurrentUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ICurrentUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ITransientDependency</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">     </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">? </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">Id</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">? </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">GroupId</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> bool</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">? </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#ABB2BF\">IsAdmin</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>扫描所有继承ITransientDependency的实现。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">   services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Scan</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">scan</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> scan</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">       // We start out with all types in the assembly of ITransientService</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">FromAssemblyOf</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ITransientDependency</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // AddClasses starts out with all public, non-abstract types in this assembly.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // These types are then filtered by the delegate passed to the method.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // In this case, we filter out only the classes that are assignable to ITransientService.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddClasses</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">classes</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> classes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AssignableTo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ITransientDependency</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;())</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // We then specify what type we want to register these classes as.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // In this case, we want to register the types as all of its implemented interfaces.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // So if a type implements 3 interfaces; A, B, C, we'd end up with three separate registrations.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AsImplementedInterfaces</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // And lastly, we specify the lifetime of these registrations.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WithTransientLifetime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">         );</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>如何使用</h2>\n<p>在其他类中使用此接口</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ApiController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Route</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"cms/user\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> UserController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ControllerBase</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> readonly</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> ICurrentUser</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> _currentUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> UserController</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ICurrentUser</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> currentUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        _currentUser</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> currentUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    [</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> int</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> GetUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _currentUser</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Id</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>统一注入</h2>\n<p>当然，我们可以统一注入，而非写二次servics.Scan</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Scan</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">scan</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> scan</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">FromAssemblyOf</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Startup</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddClasses</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">classes</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> classes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Where</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">t</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> t</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Name</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">EndsWith</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Service\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">StringComparison</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">OrdinalIgnoreCase</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AsImplementedInterfaces</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WithTransientLifetime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">FromAssemblyOf</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ITransientDependency</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddClasses</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">classes</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> classes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AssignableTo</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ITransientDependency</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;())</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AsImplementedInterfaces</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WithTransientLifetime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">      );</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2022-09-13T11:34:29.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "认证与授权",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/dynamic-authorization-in-aspnetcore.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/dynamic-authorization-in-aspnetcore.html",
      "summary": "认证与授权 主要就基于权限的授权的实现进行研究，实现方法级别的权限验证。 https://www.cnblogs.com/RainingNight/p/dynamic-authorization-in-asp-net-core.html 认证鉴权相关 IdentityServer4 ASP.NET Core WebAPI JWT Bearer 认证失败...",
      "content_html": "\n<p>主要就<strong>基于权限的授权</strong>的实现进行研究，实现方法级别的权限验证。</p>\n<ul>\n<li><a href=\"https://www.cnblogs.com/RainingNight/p/dynamic-authorization-in-asp-net-core.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.cnblogs.com/RainingNight/p/dynamic-authorization-in-asp-net-core.html</a></li>\n</ul>\n<h2>认证鉴权相关</h2>\n<p>IdentityServer4</p>\n<ul>\n<li><a href=\"https://blog.csdn.net/jasonsong2008/article/details/89226705\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET Core WebAPI JWT Bearer 认证失败返回自定义数据 Json</a></li>\n<li><a href=\"https://www.cnblogs.com/stulzq/p/8119928.html\" target=\"_blank\" rel=\"noopener noreferrer\">IdentityServer4 中文文档与实战</a></li>\n</ul>\n<h2>JWT</h2>\n<p>json web token</p>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2022-06-02T11:02:17.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "code",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/error-code.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/error-code.html",
      "summary": "code 核心库内置已使用状态码 0 成功 999 服务器未知错误 9999 失败 10000 认证失败 10020 资源不存在 10030 参数错误 10040 令牌失效 10050 令牌过期 10060 字段重复 10070 禁止操作 10080 请求方法不允许 10100 refresh token 获取失败 10110 文件体积过大 10120...",
      "content_html": "\n<h2>核心库内置已使用状态码</h2>\n<p>0 成功</p>\n<p>999 服务器未知错误</p>\n<p>9999 失败</p>\n<p>10000 认证失败</p>\n<p>10020 资源不存在</p>\n<p>10030 参数错误</p>\n<p>10040 令牌失效</p>\n<p>10050 令牌过期</p>\n<p>10060 字段重复</p>\n<p>10070 禁止操作</p>\n<p>10080 请求方法不允许</p>\n<p>10100 refresh token 获取失败</p>\n<p>10110 文件体积过大</p>\n<p>10120 文件数量过多</p>\n<p>10130 文件扩展名不符合规范</p>\n<p>10140 请求过于频繁，请稍后重试</p>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2020-02-28T11:10:31.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "认证鉴权状态",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/identityserver4-jwt.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/identityserver4-jwt.html",
      "summary": "认证鉴权状态 认证分为以下情况：当前角色为管理员，该分组配置了权限，该分组未分配某一方法的权限. 状态码（StatusCode):401 UnAuthorized 未登录，不带access_token，直接请求需要登录的接口、管理员接口结果一样。 返回结果应为：状态码：401 UNAUTHORIZED 携带access_token，但非超级管理员(ad...",
      "content_html": "\n<p>认证分为以下情况：当前角色为管理员，该分组配置了权限，该分组未分配某一方法的权限.</p>\n<p>状态码（StatusCode):401 UnAuthorized</p>\n<p>| StatusCode                | 含义                   |<br>\n|</p>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2022-10-30T15:36:06.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "Newtonsoft.Json基础问题",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/newtonsoft-json-question.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/newtonsoft-json-question.html",
      "summary": "Newtonsoft.Json基础问题 它是.NET下的一个序列化、反序化的基础类库，更基础的用法还是看别人的吧，这里只说一些遇到的问题。 设置下划线 ContractResolver 默认是小驼峰，我想改成下划线方式，遇到了一些问题，dictionary的键未格式化 in controller 创建一个控制器 In Startup.cs 此时运行后，...",
      "content_html": "\n<p>它是.NET下的一个序列化、反序化的基础类库，更基础的用法还是看别人的吧，这里只说一些遇到的问题。</p>\n<h2>设置下划线</h2>\n<p>ContractResolver  默认是小驼峰，我想改成下划线方式，遇到了一些问题，dictionary的键未格式化</p>\n<p>in controller 创建一个控制器</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"getDictionary\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> IDictionary</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetDictionary</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">    IDictionary</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt; </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\">dics</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> Dictionary</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    dics</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Add</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Key\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Value\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    dics</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Add</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"KeyTest\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Value_Test\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\"> dics</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>In Startup.cs</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">services</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddMvc</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SetCompatibilityVersion</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CompatibilityVersion</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Version_2_2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddJsonOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">opt</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // 设置下划线方式，首字母是小写</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    opt</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">SerializerSettings</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ContractResolver</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> DefaultContractResolver</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        NamingStrategy</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SnakeCaseNamingStrategy</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">});</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>此时运行后，得到的是Key,而不是key，我想他的键都变成下划线方式的小写</p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"Key\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Value\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"KeyTest\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Value_Test\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>其他测试，增加多级，测试正常</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">HttpGet</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"get\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> dynamic</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> Get</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> return</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            Content</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">                Url</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Request</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Path</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Value</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">                NewUrlTest</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"test in new url test\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">            }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>此时运行后，满足要求，多层结构也不会影响</p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"content\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"url\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"/test/get\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">    \"new_url_test\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"test in new url test\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">  }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>看了Newtonsoft.Json的github，并在in this repository 搜索Dictionary，看issues中的配置项如下即可满足dictionary的键也转小写,<br>\nProcessDictionaryKeys 功能：A flag indicating whether dictionary keys should be processed. Defaults to false.</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">services</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddMvc</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SetCompatibilityVersion</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CompatibilityVersion</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Version_2_2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddJsonOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">opt</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // 设置下划线方式，首字母是小写</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    opt</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">SerializerSettings</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">ContractResolver</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> DefaultContractResolver</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">        NamingStrategy</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SnakeCaseNamingStrategy</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            ProcessDictionaryKeys</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">});</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"key\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Value\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"key_test\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Value_Test\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>实现时间戳</h2>\n<p>前台要的格式为  <strong>1562904163734</strong>,只有一个数字，我搜索了一下，也没找到相关的文档，本身这个类库有一些时间戳，不过他们都包含特殊字符，如/Date(1562904163734)/,好像类似这样，他好像在逗我，为啥他要加Date，怕是有毒吧。看到<br>\n他有Converters属性可配置，即配置自己的序列化返回格式。</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">services</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddMvc</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">SetCompatibilityVersion</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">CompatibilityVersion</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Version_2_2</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddJsonOptions</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">opt</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> =&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //opt.SerializerSettings.DateFormatString = \"yyyy-MM-dd HH:MM:ss\";</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    //设置时间戳格式</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">    opt</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">SerializerSettings</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Converters</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> List</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&lt;</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">JsonConverter</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">&gt;()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\">        new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCmsTimeConverter</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">});</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>这里的时间戳是毫秒级别</p>\n<div class=\"language-csharp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"csharp\" data-title=\"csharp\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// 配合LinCMS中的时间戳 后台只返回 1562904163734</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">/// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> LinCmsTimeConverter</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> : </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">DateTimeConverterBase</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> WriteJson</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">JsonWriter</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> writer</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">object</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> value</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">JsonSerializer</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> serializer</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        double</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> javaScriptTicks</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\"> 0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">value</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> is</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> DateTime</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> dateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            javaScriptTicks</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ConvertDateTimeInt</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">dateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        else</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">            if</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\">!</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">value</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> is</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> DateTimeOffset</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> dateTimeOffset</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">                throw</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> JsonSerializationException</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Expected date object value.\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">            javaScriptTicks</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ConvertDateTimeInt</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">dateTimeOffset</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToUniversalTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">UtcDateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        writer</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteValue</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">javaScriptTicks</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> override</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> object</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ReadJson</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">JsonReader</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> reader</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">Type</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> objectType</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">object</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> existingValue</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">JsonSerializer</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> serializer</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ConvertIntDateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">double</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">Parse</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">reader</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Value</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">ToString</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">()));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// 日期转换为时间戳（时间戳单位毫秒）</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">summary</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic\"> name</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">=</span><span style=\"--shiki-light:#032F62;--shiki-light-font-style:inherit;--shiki-dark:#98C379;--shiki-dark-font-style:italic\">\"TimeStamp\"</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">param</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    /// </span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&lt;</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;&lt;/</span><span style=\"--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">returns</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic\">&gt;</span><span style=\"--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> DateTime</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ConvertIntDateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">double</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> milliseconds</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> DateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1970</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddMilliseconds</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">milliseconds</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> static</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> double</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> ConvertDateTimeInt</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">DateTime</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> aDt</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">aDt</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> -</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> DateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1970</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">1</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)).</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">TotalMilliseconds</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>参考</h2>\n<ul>\n<li><a href=\"https://github.com/JamesNK/Newtonsoft.Json/issues/2088\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/JamesNK/Newtonsoft.Json/issues/2088</a></li>\n<li><a href=\"https://www.newtonsoft.com/json/help/html/P_Newtonsoft_Json_Serialization_NamingStrategy_ProcessDictionaryKeys.htm\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.newtonsoft.com/json/help/html/P_Newtonsoft_Json_Serialization_NamingStrategy_ProcessDictionaryKeys.htm</a></li>\n<li><a href=\"https://blog.csdn.net/yw1688/article/details/38492583\" target=\"_blank\" rel=\"noopener noreferrer\">https://blog.csdn.net/yw1688/article/details/38492583</a></li>\n<li><a href=\"https://www.jianshu.com/p/c53b1a2a121d\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.jianshu.com/p/c53b1a2a121d</a></li>\n</ul>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2022-09-13T11:34:29.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "开源介绍",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/open-source-road.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/open-source-road.html",
      "summary": "开源介绍 地址：https://github.com/luoyunchong/lin-cms-dotnetcore 1.什么是cms？ Content Management System，内容管理系统。 2.dotnetcore是什么 .NET Core，是由Microsoft开发，目前在.NET Foundation(一个非营利的开源组织)下进行管理...",
      "content_html": "\n<ul>\n<li>地址：<a href=\"https://github.com/luoyunchong/lin-cms-dotnetcore\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/lin-cms-dotnetcore</a></li>\n</ul>\n<p>1.什么是cms？</p>\n<p>Content Management System，内容管理系统。</p>\n<p>2.dotnetcore是什么</p>\n<p>.NET Core，是由Microsoft开发，<a href=\"http://xn--ldr31jfr8a.NET\" target=\"_blank\" rel=\"noopener noreferrer\">目前在.NET</a> Foundation(一个非营利的开源组织)下进行管理，采用宽松的MIT协议，可构建各种软件，包括Web应用程序、移动应用程序、桌面应用程序、云服务、微服务、API、游戏和物联网应用程序</p>\n<p>3.lin-cms 是什么</p>\n<p>Lin-CMS 是林间有风团队经过大量项目实践所提炼出的一套内容管理系统框架。Lin-CMS 可以有效的帮助开发者提高 CMS 的开发效率, 需要前端？请访问前端仓库。官方团队产品了解请访问TaleLin</p>\n<p>4.lin-cms-dotnetcore有哪些特点？</p>\n<p>前后端分离，提供后端接口，更少的依赖，后续将实现模块化安装与卸载。</p>\n<ul>\n<li>用户管理、分组管理、分组权限管理、日志系统、文件上传等</li>\n<li>更多功能（自定义扩展-模块系统）</li>\n<li>博客模块，类掘金专栏，用户中心，标签、个人专栏、技术频道（首页分类）</li>\n</ul>\n<h2>设计如下</h2>\n<h4>字典管理</h4>\n<h3>我原本想实现这样的功能</h3>\n<p>BaseType 1 对BaseItem多。</p>\n<p>如：标签管理，一个文章下可以设置多个标签，原本需要设计表Tag,字段也大抵为Id,Name,Sort及关联表。<br>\n我们使用BaseType、BaseItem实现。<br>\nBaseType中TypeCode为tag,FullName为标签，id为1时。<br>\nBaseItem中BaseTypeId为1，ItemCode为编码,ItemName为标签。ItemCode为不重复的字符串即可。</p>\n<p>另Tag与Article的关联表，需要另设计一个表。</p>\n<p>当我们要实现文章类别的下拉，原本需要设计一个表ArticleType，有字段,id,name,sort等。<br>\n我们可以通过BaseType、BaseItem来实现，从而简化这些基础数据。<br>\nBaseType有一条数据，TypeCode为 字符串category、FullName文章类别，BaseItem存多个文章类别(Java、大数据、Python、C#等)，编码不同即可。</p>\n<ol>\n<li>表结构</li>\n</ol>\n<h4>base_type （字典类别管理）</h4>\n<p>| 字段      | 类型        | 备注     |<br>\n|</p>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2022-10-24T14:14:31.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "功能模块的设计",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/pm-design-modules.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/pm-design-modules.html",
      "summary": "功能模块的设计 基础权限模块 用户信息：邮件、用户名（唯一）、昵称、头像、分组、是否激活、手机号、是否是Admin、个性签名 注册/登录 上传头像 修改密码 用户基本信息修改 用户增删改，配置分组 绑定第三方账号 GitHub登录 QQ 登录 分组信息：是否静态分组（无法删除，无法修改分组编码）、名称可以修改 分组增删改 组别配置权限 文件管理 本地文...",
      "content_html": "\n<h2>基础权限模块</h2>\n<ul>\n<li>用户信息：邮件、用户名（唯一）、昵称、头像、分组、是否激活、手机号、是否是Admin、个性签名\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-0\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-0\"> 注册/登录</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-1\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-1\"> 上传头像</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-2\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-2\"> 修改密码</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-3\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-3\"> 用户基本信息修改</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-4\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-4\"> 用户增删改，配置分组</label></li>\n</ul>\n</li>\n<li>绑定第三方账号\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-5\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-5\"> GitHub登录</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-6\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-6\"> QQ 登录</label></li>\n</ul>\n</li>\n<li>分组信息：是否静态分组（无法删除，无法修改分组编码）、名称可以修改\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-7\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-7\"> 分组增删改</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-8\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-8\"> 组别配置权限</label></li>\n</ul>\n</li>\n<li>文件管理\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-9\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-9\"> 本地文件上传</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-10\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-10\"> 七牛云存储</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-11\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-11\"> 文件去重，秒传</label></li>\n</ul>\n</li>\n<li>系统日志：请求方法、路径、http返回码、时间、用户昵称、用户id、访问哪个权限、 日志信息\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-12\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-12\"> 记录系统请求的日志</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-13\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-13\"> 异常日志</label></li>\n</ul>\n</li>\n<li>设置管理：name(键）,value(值),provider_name(提供名),provider_key（提供者值）\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-14\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-14\"> 设置新增修改删除</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-15\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-15\"> 所有设置</label></li>\n</ul>\n</li>\n</ul>\n<p>比如存某用户选择的是markdown还是富文本。</p>\n<div class=\"language-txt line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"txt\" data-title=\"txt\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>name=\"Article.Editor\",</span></span>\n<span class=\"line\"><span>value=\"markdown\" 或 \"富文本\"，</span></span>\n<span class=\"line\"><span>provider_name为\"User\",</span></span>\n<span class=\"line\"><span>provider_key为用户Id</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>或存储七牛云的某一个配置</p>\n<div class=\"language-txt line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"txt\" data-title=\"txt\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>name=\"Qiniu.AK\",</span></span>\n<span class=\"line\"><span>value=\"asfadsfadf23rft66S4XM2GIK7FGmj7czuYkcAyNGDAc\" ，</span></span>\n<span class=\"line\"><span>provider_name为\"Qiniu\"或自己定义的字符串</span></span>\n<span class=\"line\"><span>provider_key为空</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>cms 管理员维护模块</h2>\n<ul>\n<li>标签管理：名称、图片，是否启用/禁用，排序、文章数量、用户关注数量。\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-16\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-16\"> 标签增删改</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-17\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-17\"> 标签列表，禁用</label></li>\n</ul>\n</li>\n<li>技术频道：封面图、名称、是否启用/禁用、排序、编码、备注描述、下属标签.一个技术频道对应多个标签\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-18\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-18\"> 技术频道增删改</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-19\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-19\"> 列表、禁用</label></li>\n</ul>\n</li>\n<li>随笔管理：\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-20\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-20\"> 审核随笔/拉黑</label></li>\n</ul>\n</li>\n<li>评论管理\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-21\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-21\"> 后台审核通过/拉黑</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-22\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-22\"> 管理员删除评论</label></li>\n</ul>\n</li>\n<li>字典管理\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-23\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-23\"> 字典类别管理</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-24\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-24\"> 字典管理：如随笔类型（原创、转载、翻译）</label></li>\n</ul>\n</li>\n</ul>\n<h2>cms 用户端模块</h2>\n<ul>\n<li>\n<p>技术频道</p>\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-25\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-25\"> 首页展示技术频道</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-26\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-26\"> 选择技术频道后，可再根据标签查询文章</label></li>\n</ul>\n</li>\n<li>\n<p>分类专栏管理:发布随笔时可选择单个分类。</p>\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-27\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-27\"> 分类增删改(随笔数量、图片、名称、排序)</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-28\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-28\"> 分类列表，仅查看、编辑自己创建的分类专栏</label></li>\n</ul>\n</li>\n<li>\n<p>标签：统计每个标签下多少个文章、多少人关注</p>\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-29\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-29\"> 标签列表</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-30\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-30\"> 无限加载</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-31\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-31\"> 最新/最热 根据标签名称模糊查询</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-32\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-32\"> 已关注的标签</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-33\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-33\"> 热门标签</label></li>\n</ul>\n</li>\n<li>\n<p>随笔</p>\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-34\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-34\"> 支持markdown，增删改（仅自己的随笔）,修正分类专栏中的随笔数量</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-35\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-35\"> 列表无限加载，按标签查询随笔</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-36\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-36\"> 点赞随笔</label></li>\n<li>随笔详情页\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-37\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-37\"> 支持目录导航（滚动时，固定至顶部位置），展示字数统计、预计阅读时长；</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-38\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-38\"> 作者介绍：头像，昵称，签名，随笔数；</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-39\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-39\"> 展示文章类型：原创、转载、翻译</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-40\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-40\">  相关文章</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-41\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-41\">  推荐文章</label></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>评论</p>\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-42\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-42\"> 用户关闭评论时，无法对随笔进行评论</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-43\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-43\"> 评论随笔(内容支持超链接、emoji)</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-44\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-44\"> 删除自己的评论</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-45\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-45\"> 点赞评论</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-46\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-46\"> 回复评论</label></li>\n</ul>\n</li>\n<li>\n<p>关注</p>\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-47\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-47\"> 关注/取消关注用户</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-48\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-48\"> 关注/取消关注标签</label></li>\n</ul>\n</li>\n<li>\n<p>个人主页</p>\n<ul>\n<li>随笔\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-49\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-49\"> 用户专栏分类展示</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-50\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-50\"> 最新发布的随笔</label></li>\n</ul>\n</li>\n<li>关注\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-51\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-51\"> 关注的人</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-52\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-52\"> 粉丝</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-53\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-53\"> 关注的标签</label></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>设置</p>\n<ul>\n<li>个人主页设置\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-54\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-54\"> 个人资料更新</label></li>\n</ul>\n</li>\n<li>安全设置\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-55\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-55\"> 密码修改</label></li>\n</ul>\n</li>\n<li>博客设置\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-56\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-56\"> 默认编辑器设置(markdown/富文本)</label></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>消息</p>\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-57\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-57\"> 点赞随笔、点赞评论</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-58\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-58\"> 评论随笔、回复评论</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-59\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-59\"> 用户关注</label></li>\n</ul>\n</li>\n</ul>\n<h2>评论模块</h2>\n<h3>主题式</h3>\n<p>将评论分为二级，第一级采用时间倒序，二级按照时间正序，有助于理解上下文关系。</p>\n<p>用户操作：</p>\n<ul>\n<li>评论随笔(内容支持超链接、emoji)</li>\n<li>点赞评论/取消点赞</li>\n<li>回复评论</li>\n<li>删除自己的评论</li>\n</ul>\n<p>运营操作：</p>\n<ul>\n<li>审核通过/拉黑评论</li>\n<li>删除任何评论</li>\n<li>拉黑后的显示逻辑。（保留当前区块、显示内容为：该评论因违规被拉黑）</li>\n<li>删除：（如果是二级评论，直接软删除，如果是一级评论，软删除子评论和当前评论-需要提前提醒用户）<br>\n交互设计</li>\n<li>评论的字数长度（500）、emoji。</li>\n<li>点赞交互-动画、消息通知/推送</li>\n<li>评论区域元素，需要有明确可点击的区域，会跳转到哪个地方。</li>\n</ul>\n<h3>优化</h3>\n<ul>\n<li>精选评论</li>\n</ul>\n<h3>脑图分享</h3>\n<p><a href=\"http://naotu.baidu.com/file/6532431a2e1f0c37c93c5ffd1dd5b49c?token=87690a9bc64fbae1\" target=\"_blank\" rel=\"noopener noreferrer\">http://naotu.baidu.com/file/6532431a2e1f0c37c93c5ffd1dd5b49c?token=87690a9bc64fbae1</a></p>\n<h3>分组</h3>\n<p>分为三种</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>id  name        info</span></span>\n<span class=\"line\"><span>1 Admin     系统管理员</span></span>\n<span class=\"line\"><span>2 CmsAdmin 内容管理员</span></span>\n<span class=\"line\"><span>3 User     普通用户</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>审计日志</h3>\n<p>大多数表存在如下8个字段，用于记录行的变化状态，is_deleted为软删除，执行删除操作时，将其状态置为true，默认实体类继承 <strong>FullAuditEntity</strong>  即可拥有以下8个字段。该设计参考ABP中的实现。FullAuditEntity为泛型，默认id为long类型，FullAuditEntity&lt;Guid&gt;,即可改变主键类型，默认LinUser表主键long，保持<strong>create_user_id</strong>,<strong>delete_user_id</strong>,<strong>update_user_id</strong>都与LinUser的主键相同</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span></span></span>\n<span class=\"line\"><span>id                 bigint</span></span>\n<span class=\"line\"><span>create_user_id   bigint</span></span>\n<span class=\"line\"><span>create_time         datetime</span></span>\n<span class=\"line\"><span>is_deleted         bit</span></span>\n<span class=\"line\"><span>delete_user_id   bigint</span></span>\n<span class=\"line\"><span>delete_time         datetime</span></span>\n<span class=\"line\"><span>update_user_id     bigint</span></span>\n<span class=\"line\"><span>update_time         datetime</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>0.3.0版本权限功能升级</h2>\n<p>为支持一个用户多个分组，一个分组多个权限，一个用户可分多种授权登录方式，根据lin-cms-springboot项目功能模块升级，介绍如下：</p>\n<ol>\n<li>lin_permission  权限表，本系统通过反射在系统初次启动时，启动异步任务，将不存在的权限新增到此表中。</li>\n<li>lin_group_permission  分组权限表，用于分组与权限表的关联</li>\n<li>lin_user_group  用户分组表。用于用户和分组表的关联。可配置一个用户属于多个分组。</li>\n<li>lin_user_identity 用户授权信息表，用于存储不同登录类型的用户信息，如手机号、邮件、用户名、第三方应用（微信、QQ、GitHub）的登录</li>\n</ol>\n<h2>lin-cms 开源地址分享</h2>\n<ul>\n<li>后端接口 <a href=\"https://github.com/luoyunchong/lin-cms-dotnetcore\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/lin-cms-dotnetcore</a></li>\n<li>管理后台UI <a href=\"https://github.com/luoyunchong/lin-cms-vue\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/lin-cms-vue</a></li>\n<li>前端UI<a href=\"https://github.com/luoyunchong/lin-cms-vvlog\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/lin-cms-vvlog</a></li>\n</ul>\n",
      "date_published": "2019-11-24T12:44:22.000Z",
      "date_modified": "2023-03-12T13:50:00.000Z",
      "authors": [],
      "tags": [
        "lin-cms-dotnetcore"
      ]
    },
    {
      "title": "产品设计",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/production-design.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/production-design.html",
      "summary": "产品设计 产品设计-评论模块的设计 1.主题式 将评论分为二级，第一级采用时间倒序，二级按照时间正序，有助于理解上下文关系。 用户操作： 评论随笔(内容支持超链接、emoji) 点赞评论/取消点赞 回复评论 删除自己的评论 运营操作： 审核通过/拉黑评论 删除任何评论 拉黑后的显示逻辑。（保留当前区块、显示内容为：该评论因违规被拉黑） 删除：（如果是二...",
      "content_html": "\n<h2>产品设计-评论模块的设计</h2>\n<h3>1.主题式</h3>\n<p>将评论分为二级，第一级采用时间倒序，二级按照时间正序，有助于理解上下文关系。</p>\n<p>用户操作：</p>\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-0\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-0\"> 评论随笔(内容支持超链接、emoji)</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-1\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-1\">  点赞评论/取消点赞</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-2\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-2\">  回复评论</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-3\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-3\">  删除自己的评论</label></li>\n</ul>\n<p>运营操作：</p>\n<ul class=\"task-list-container\">\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-4\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-4\">  审核通过/拉黑评论</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-5\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-5\">  删除任何评论</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" class=\"task-list-item-checkbox\" id=\"task-item-6\" checked=\"checked\" disabled=\"disabled\"><label class=\"task-list-item-label\" for=\"task-item-6\">  拉黑后的显示逻辑。（保留当前区块、显示内容为：该评论因违规被拉黑）</label></li>\n<li>删除：（如果是二级评论，直接软删除，如果是一级评论，软删除子评论和当前评论-需要提前提醒用户）<br>\n交互设计</li>\n<li>评论的字数长度（500）、emoji。</li>\n<li>点赞交互-动画、消息通知/推送</li>\n<li>评论区域元素，需要有明确可点击的区域，会跳转到哪个地方。</li>\n</ul>\n<h3>优化</h3>\n<ul>\n<li>精选评论</li>\n</ul>\n<h2>排行榜见解</h2>\n<p>排行榜从心理学上分析，主要从四个方面影响着您：<strong>寻找权威 、参与比较 、关注主流 、自我确认。</strong></p>\n<p>如何设计一个简单的排行榜呢。。</p>\n<p>在一个博客随笔中，我们设计一个3天、七天（周榜）、30天（月榜）、全部的榜单。以浏览量（权重1）、点赞量（20）、评论量（30)。权重可自己定义。</p>\n<p>1.默认取最新的随笔</p>\n<p>前台传create_time时，使用如下sql</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>select * from `blog_article` order by create_time desc;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>2.传排序方式为最近n天的热榜时。</p>\n<p>参数：THREE_DAYS_HOTTEST（三天）、WEEKLY_HOTTEST(七天）、MONTHLY_HOTTEST（一个月）、HOTTEST（全部）</p>\n<p>mysql 查询当前日期时间前三天数据</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>select date_sub(now() ,interval 3 day);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>根据权重查询</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>select * from `blog_article` a </span></span>\n<span class=\"line\"><span>where a.`create_time`&gt;(select date_sub(now() ,interval 3 day))</span></span>\n<span class=\"line\"><span>order by (a.`view_hits` + a.`likes_quantity` * 20 + a.`comment_quantity` * 30) DESC, a.`create_time` DESC</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>创作者中心</h2>\n<h3>用户主页</h3>\n<p>统计值：阅读总数，点赞总数，关注者总数</p>\n<h3>个人设置</h3>\n<p>用户信息、密码修改</p>\n<h2>更多参考</h2>\n<ul>\n<li><a href=\"http://www.woshipm.com/pd/1255548.html\" target=\"_blank\" rel=\"noopener noreferrer\">万字长文深度分析：产品排行榜的设计和玩法</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/52322777\" target=\"_blank\" rel=\"noopener noreferrer\">想知道谁是你的最佳用户？基于Redis实现排行榜周期榜与最近N期榜</a></li>\n</ul>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2022-06-02T11:44:24.000Z",
      "authors": [],
      "tags": []
    },
    {
      "title": "GitHub第三方授权登录",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/spa-github-login.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/spa-github-login.html",
      "summary": "使用 SPA+.NET Core3.1 实现 GitHub 第三方授权登录 类似使用 AspNet.Security.OAuth.GitHub，前端使用如下：VUE+Vue-Router+axios AspNet.Security.OAuth.GitHub GitHub https://github.com/aspnet-contrib/AspNet....",
      "content_html": "<p>使用 <a href=\"http://SPA+.NET\" target=\"_blank\" rel=\"noopener noreferrer\">SPA+.NET</a> Core3.1 实现 GitHub 第三方授权登录 类似使用 AspNet.Security.OAuth.GitHub，前端使用如下：VUE+Vue-Router+axios</p>\n<h2>AspNet.Security.OAuth.GitHub</h2>\n<ul>\n<li>GitHub <a href=\"https://github.com/aspnet-contrib/AspNet.Security.OAuth.Providers\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/aspnet-contrib/AspNet.Security.OAuth.Providers</a></li>\n</ul>\n<h2>GitHub 授权登录</h2>\n<p>什么配置的过程不说了。。有一推。</p>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/78d186aeb526\" target=\"_blank\" rel=\"noopener noreferrer\">GitHub 第三方登录</a></li>\n<li><a href=\"https://juejin.im/post/5dfb04cee51d45583a66c2f3\" target=\"_blank\" rel=\"noopener noreferrer\">给你的网站添加第三方登录以及短信验证功能</a></li>\n</ul>\n<p>下面为示例</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>client_id:0be6b05fc717bfc4fb67</span></span>\n<span class=\"line\"><span>client_secret:xxxxxxxxxxxxxxx</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>Get</p>\n<div class=\"language-text line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"text\" data-title=\"text\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>https://github.com/login/oauth/authorize?client_id=0be6b05fc717bfc4fb67&amp;redirect_uri=https://localhost:5001/signin-github</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>会重定向到</p>\n<p><a href=\"https://localhost:5001/signin-github?code=07537a84d12bbae08361\" target=\"_blank\" rel=\"noopener noreferrer\">https://localhost:5001/signin-github?code=07537a84d12bbae08361</a></p>\n<p>这个 code 放到下面的请求中，获取 access_token<br>\nPOST 方式（PostMan 去请求）</p>\n<div class=\"language-text line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"text\" data-title=\"text\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>https://github.com/login/oauth/access_token?client_id=0be6b05fc717bfc4fb67&amp;client_secret=xxxxxxxxxxxxxxx&amp;code=07537a84d12bbae08361</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>Get 方式</p>\n<div class=\"language-text line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"text\" data-title=\"text\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>https://api.github.com/user?access_token=787506afa3271d077b98f18af56d7cfdc8db43b4</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>然后就能获取用户信息</p>\n<div class=\"language-json line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"json\" data-title=\"json\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"login\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"luoyunchong\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"id\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">18613266</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"node_id\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"MDQ6VXNlcjE4NjEzMjY2\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"avatar_url\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"https://avatars1.githubusercontent.com/u/18613266?v=4\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"gravatar_id\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"url\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"https://api.github.com/users/luoyunchong\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"html_url\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"https://github.com/luoyunchong\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"followers_url\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"https://api.github.com/users/luoyunchong/followers\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"following_url\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"https://api.github.com/users/luoyunchong/following{/other_user}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"gists_url\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"https://api.github.com/users/luoyunchong/gists{/gist_id}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"starred_url\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"https://api.github.com/users/luoyunchong/starred{/owner}{/repo}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"subscriptions_url\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"https://api.github.com/users/luoyunchong/subscriptions\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"organizations_url\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"https://api.github.com/users/luoyunchong/orgs\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"repos_url\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"https://api.github.com/users/luoyunchong/repos\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"events_url\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"https://api.github.com/users/luoyunchong/events{/privacy}\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"received_events_url\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"https://api.github.com/users/luoyunchong/received_events\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"type\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"User\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"site_admin\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">false</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"name\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"IGeekFan\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"company\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">null</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"blog\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"https://igeekfan.cn\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"location\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">null</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"email\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"luoyunchong@foxmail.com\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"hireable\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">null</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"bio\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"学习之路漫漫无期。\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"public_repos\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">14</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"public_gists\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">0</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"followers\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">16</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"following\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">11</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"created_at\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"2016-04-22T10:33:44Z\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#005CC5;--shiki-dark:#E06C75\">  \"updated_at\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"2019-12-21T14:49:33Z\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>.NET Core3.1</h2>\n<p>以下代码为主要代码，完整代码看下面的 DEMO 链接。</p>\n<p>使用 WebApi 时，看了一些项目，全是基于 MVC 结构的，都不是我想要的。看了一些博客上面介绍 ,步骤都是千篇一律，都是配合前后端分离的。</p>\n<ul>\n<li>前端运行在:<a href=\"http://localhost:8081\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost:8081</a></li>\n<li>后端运行在:<a href=\"https://localhost:5001\" target=\"_blank\" rel=\"noopener noreferrer\">https://localhost:5001</a></li>\n</ul>\n<h3>前后端分离的 SPA 配合第三方授权登录流程如下</h3>\n<p>本地测试时，gitHub 回调地址设置 http(s)😕/ip:端口/signin-github</p>\n<ul>\n<li>如: <a href=\"https://localhost:5001/signin-github%E3%80%82\" target=\"_blank\" rel=\"noopener noreferrer\">https://localhost:5001/signin-github。</a></li>\n</ul>\n<h4>1. 上面这个明明填写的后端的地址，那后端怎么把结果通知前端呢？</h4>\n<p>前端请求<strong><a href=\"https://localhost:5001/signin?provider=GitHub&amp;redirectUrl=http://localhost:8080/login-result\" target=\"_blank\" rel=\"noopener noreferrer\">https://localhost:5001/signin?provider=GitHub&amp;redirectUrl=http://localhost:8080/login-result</a></strong></p>\n<ul>\n<li>提供参数 provider 为 GitHub，</li>\n<li>redirectUrl 为 GitHub 授权登录后，回调 signin-github 后，后端再去重定向的地址，这里填前端的一个路由。</li>\n</ul>\n<h4>2. 后端只提供了 signin，signin-callback 路由，没有 signin-github，那 github 上配置的路由是怎么回调回来呢？</h4>\n<p><a href=\"https://docs.microsoft.com/zh-cn/aspnet/core/security/authentication/social/google-logins?view=aspnetcore-3.1\" target=\"_blank\" rel=\"noopener noreferrer\">google-登录，微软文档</a>，其中有一个<strong>更改默认回调 URI</strong>,通过 AddGitHub 中的 CallbackPath 属性配置。</p>\n<p>介绍了回调地址应配置 signin-google,所以这里应该是 signin-github，他是可以配置的，不需要自己写程序处理 signin-google 这个路由，内部有中间件已经处理了。</p>\n<h4>3. 回调到 signin-github 后，后端怎么处理，才能让前端刷新。获取登录后的信息呢。</h4>\n<p>具体上面的根据 code 获取 access_token，根据 access_token 获取用户的信息的过程，这些处理的过程，都不需要我们自己处理。我们可以用直接获取用户信息。</p>\n<p>一个方法 SignIn,只要<strong>return Challenge(properties, provider);</strong>，</p>\n<ul>\n<li>provider 为 GitHub，</li>\n<li>properties var properties = new AuthenticationProperties { RedirectUri = url };</li>\n</ul>\n<p>这个 url 为另一个获取用户信息的路由，只要拼接好地址即可。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>var authenticateResult = await _contextAccessor.HttpContext.AuthenticateAsync(provider);</span></span>\n<span class=\"line\"><span>string email = authenticateResult.Principal.FindFirst(ClaimTypes.Email)?.Value;</span></span>\n<span class=\"line\"><span>string name = authenticateResult.Principal.FindFirst(ClaimTypes.Name)?.Value;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>需要注入</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>private readonly IHttpContextAccessor _contextAccessor;</span></span>\n<span class=\"line\"><span>public AuthenticationController( IHttpContextAccessor contextAccessor)</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    _contextAccessor = contextAccessor;</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>代码部署（简化）</h3>\n<p>打开 NuGet 包管理,安装包</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>Install-Package AspNet.Security.OAuth.GitHub</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>appSettings.json</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>\"Authentication\": {</span></span>\n<span class=\"line\"><span>    \"GitHub\": {</span></span>\n<span class=\"line\"><span>      \"ClientId\": \"0be6b05fc717bfc4fb67\",</span></span>\n<span class=\"line\"><span>      \"ClientSecret\": \"xxxxxxxxxxxxxxx\"</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>add 扩展方法</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>public static class JwtConfiguration</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    public static void AddJwtConfiguration(this IServiceCollection services, IConfiguration configuration)</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>        services.AddAuthentication(opts =&gt;</span></span>\n<span class=\"line\"><span>            {</span></span>\n<span class=\"line\"><span>                opts.DefaultScheme = CookieAuthenticationDefaults.AuthenticationScheme;</span></span>\n<span class=\"line\"><span>                opts.DefaultAuthenticateScheme = JwtBearerDefaults.AuthenticationScheme;</span></span>\n<span class=\"line\"><span>            }).AddCookie(options =&gt;</span></span>\n<span class=\"line\"><span>        {</span></span>\n<span class=\"line\"><span>            options.LoginPath = \"/signin\";</span></span>\n<span class=\"line\"><span>            options.LogoutPath = \"/signout\";</span></span>\n<span class=\"line\"><span>        }).AddGitHub(options =&gt;</span></span>\n<span class=\"line\"><span>        {</span></span>\n<span class=\"line\"><span>            options.ClientId = configuration[\"Authentication:GitHub:ClientId\"];</span></span>\n<span class=\"line\"><span>            options.ClientSecret = configuration[\"Authentication:GitHub:ClientSecret\"];</span></span>\n<span class=\"line\"><span>        });</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>默认情况下，如头像，email，是没有获取的。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>.AddGitHub(options =&gt;</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    options.ClientId = configuration[\"Authentication:GitHub:ClientId\"];</span></span>\n<span class=\"line\"><span>    options.ClientSecret = configuration[\"Authentication:GitHub:ClientSecret\"];</span></span>\n<span class=\"line\"><span>    //options.CallbackPath = new PathString(\"~/signin-github\");//与GitHub上的回调地址相同，默认即是/signin-github</span></span>\n<span class=\"line\"><span>    options.Scope.Add(\"user:email\");</span></span>\n<span class=\"line\"><span>    //authenticateResult.Principal.FindFirst(LinConsts.Claims.AvatarUrl)?.Value;  得到GitHub头像</span></span>\n<span class=\"line\"><span>    options.ClaimActions.MapJsonKey(LinConsts.Claims.AvatarUrl, \"avatar_url\");</span></span>\n<span class=\"line\"><span>    options.ClaimActions.MapJsonKey(LinConsts.Claims.BIO, \"bio\");</span></span>\n<span class=\"line\"><span>    options.ClaimActions.MapJsonKey(LinConsts.Claims.BlogAddress, \"blog\");</span></span>\n<span class=\"line\"><span>});</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>#其中LinConsts类为静态常量</span></span>\n<span class=\"line\"><span>public static class LinConsts</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    public static class Claims</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        public const string BIO = \"urn:github:bio\";</span></span>\n<span class=\"line\"><span>        public const string AvatarUrl = \"urn:github:avatar_url\";</span></span>\n<span class=\"line\"><span>        public const string BlogAddress = \"urn:github:blog\";</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>startup.cs</p>\n<p>ConfigureServices 中配置此服务</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>    services.AddSingleton&lt;IHttpContextAccessor, HttpContextAccessor&gt;();</span></span>\n<span class=\"line\"><span>    services.AddJwtConfiguration(Configuration);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>创建 AuthenticationController.cs<br>\n增加 SignIn，用于处理用户授权成功后，重定回 signin-callback,并将参数带回。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>        private readonly IHttpContextAccessor _contextAccessor;</span></span>\n<span class=\"line\"><span>        private readonly IConfiguration _configuration;</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>        public AuthenticationController(IHttpContextAccessor contextAccessor, IConfiguration configuration)</span></span>\n<span class=\"line\"><span>        {</span></span>\n<span class=\"line\"><span>            _contextAccessor = contextAccessor;</span></span>\n<span class=\"line\"><span>            _configuration = configuration;</span></span>\n<span class=\"line\"><span>        }</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>        [HttpGet(\"~/signin\")]</span></span>\n<span class=\"line\"><span>        public async Task&lt;IActionResult&gt; SignIn(string provider, string redirectUrl)</span></span>\n<span class=\"line\"><span>        {</span></span>\n<span class=\"line\"><span>            var request = _contextAccessor.HttpContext.Request;</span></span>\n<span class=\"line\"><span>            var url =</span></span>\n<span class=\"line\"><span>                $\"{request.Scheme}://{request.Host}{request.PathBase}{request.Path}-callback?provider={provider}&amp;redirectUrl={redirectUrl}\";</span></span>\n<span class=\"line\"><span>            var properties = new AuthenticationProperties { RedirectUri = url };</span></span>\n<span class=\"line\"><span>            properties.Items[\"LoginProviderKey\"] = provider;</span></span>\n<span class=\"line\"><span>            return Challenge(properties, provider);</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>        }</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>在 signin 方法中，用户点击授权后（第一次），会根据其传递的 URL，重定向到这个地址，signin-callback,参数也会一同携带。provider 为 GitHub,redirectUrl 为：<a href=\"http://localhost:8081/login-result\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost:8081/login-result</a>.</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>[HttpGet(\"~/signin-callback\")]</span></span>\n<span class=\"line\"><span>public async Task&lt;IActionResult&gt; Home(string provider = null, string redirectUrl = \"\")</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    var authenticateResult = await _contextAccessor.HttpContext.AuthenticateAsync(provider);</span></span>\n<span class=\"line\"><span>    if (!authenticateResult.Succeeded) return Redirect(redirectUrl);</span></span>\n<span class=\"line\"><span>    var openIdClaim = authenticateResult.Principal.FindFirst(ClaimTypes.NameIdentifier);</span></span>\n<span class=\"line\"><span>    if (openIdClaim == null || string.IsNullOrWhiteSpace(openIdClaim.Value))</span></span>\n<span class=\"line\"><span>        return Redirect(redirectUrl);</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    //TODO 记录授权成功后的信息</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    string email = authenticateResult.Principal.FindFirst(ClaimTypes.Email)?.Value;</span></span>\n<span class=\"line\"><span>    string name = authenticateResult.Principal.FindFirst(ClaimTypes.Name)?.Value;</span></span>\n<span class=\"line\"><span>    string gitHubName = authenticateResult.Principal.FindFirst(GitHubAuthenticationConstants.Claims.Name)?.Value;</span></span>\n<span class=\"line\"><span>    string gitHubUrl = authenticateResult.Principal.FindFirst(GitHubAuthenticationConstants.Claims.Url)?.Value;</span></span>\n<span class=\"line\"><span>    //startup 中 AddGitHub配置项  options.ClaimActions.MapJsonKey(LinConsts.Claims.AvatarUrl, \"avatar_url\");</span></span>\n<span class=\"line\"><span>    string avatarUrl = authenticateResult.Principal.FindFirst(LinConsts.Claims.AvatarUrl)?.Value;</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    return Redirect($\"{redirectUrl}?openId={openIdClaim.Value}\");</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>这时候我们能获取用户信息了。那么前端怎么办呢。我们写个方法，获取用户信息，看看效果。</p>\n<ul>\n<li>浏览器直接打开能得到 github 的 id。</li>\n<li>axios GET 请求 <a href=\"https://localhost:5001/OpenId\" target=\"_blank\" rel=\"noopener noreferrer\">https://localhost:5001/OpenId</a> 得到 null</li>\n</ul>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>[HttpGet(\"~/OpenId\")]</span></span>\n<span class=\"line\"><span>public async Task&lt;string&gt; OpenId(string provider = null)</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>   var authenticateResult = await _contextAccessor.HttpContext.AuthenticateAsync(provider);</span></span>\n<span class=\"line\"><span>   if (!authenticateResult.Succeeded) return null;</span></span>\n<span class=\"line\"><span>   var openIdClaim = authenticateResult.Principal.FindFirst(ClaimTypes.NameIdentifier);</span></span>\n<span class=\"line\"><span>   return openIdClaim?.Value;</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>我记得之前传 Token 时，后台是可以这样获取的。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>[HttpGet(\"~/GetOpenIdByToken\")]</span></span>\n<span class=\"line\"><span>public string GetOpenIdByToken()</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    return User.FindFirst(ClaimTypes.NameIdentifier)?.Value;</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>LoginResult.vue 在 created 生命周期中。都是得到 null</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>axios({</span></span>\n<span class=\"line\"><span>  methods: \"get\",</span></span>\n<span class=\"line\"><span>  url: \"https://localhost:5001/OpenId?provider=GitHub\"</span></span>\n<span class=\"line\"><span>})</span></span>\n<span class=\"line\"><span>  .then(function(response) {</span></span>\n<span class=\"line\"><span>    // handle success</span></span>\n<span class=\"line\"><span>    console.log(response);</span></span>\n<span class=\"line\"><span>  })</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>axios({</span></span>\n<span class=\"line\"><span>  methods: \"get\",</span></span>\n<span class=\"line\"><span>  url: \"https://localhost:5001/GetOpenIdByToken\"</span></span>\n<span class=\"line\"><span>})</span></span>\n<span class=\"line\"><span>  .then(function(response) {</span></span>\n<span class=\"line\"><span>    // handle success</span></span>\n<span class=\"line\"><span>    console.log(response);</span></span>\n<span class=\"line\"><span>  })</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3>为什么呢？？？</h3>\n<p>因为前后端分离，不是基于 Cookies 的。http 是无状态的。每次请求无法区分用户的。我们可以根据当前的 ClaimsPrincipal，根据 JWT 生成相应的 Token，axios 请求时，放到 headers 中。</p>\n<p>安装包</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>Install-Package Microsoft.AspNetCore.Authentication.JwtBearer</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>AppSettings.json 配置改成</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>\"Authentication\": {</span></span>\n<span class=\"line\"><span>\"JwtBearer\": {</span></span>\n<span class=\"line\"><span>  \"SecurityKey\": \"JWTStudyWebsite_DI20DXU3\",</span></span>\n<span class=\"line\"><span>  \"Issuer\": \"JWTStudy\",</span></span>\n<span class=\"line\"><span>  \"Audience\": \"JWTStudyWebsite\"</span></span>\n<span class=\"line\"><span>},</span></span>\n<span class=\"line\"><span>\"GitHub\": {</span></span>\n<span class=\"line\"><span>  \"ClientId\": \"0be6b05fc717bfc4fb67\",</span></span>\n<span class=\"line\"><span>  \"ClientSecret\": \"xxxxxxxxxxxxxxx\"</span></span>\n<span class=\"line\"><span>}</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>在 signin-callback 路由中，得到 authenticateResult.Principal，其中默认包含了(id,login,name,url)，授权得到 eamil，另外 MapJsonKey 扩展了以下字段（avatar_url、bio、blog)</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> authenticateResult</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> await</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> _contextAccessor</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">HttpContext</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AuthenticateAsync</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">provider</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> token</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\"> this</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">CreateToken</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">authenticateResult</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Principal</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>根据 ClaimsPrincipal 值生成 token 值。</p>\n<div class=\"language-cs line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cs\" data-title=\"cs\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">private</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\"> string</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\"> CreateToken</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">ClaimsPrincipal</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> claimsPrincipal</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">{</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> handler</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> JwtSecurityTokenHandler</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> key</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SymmetricSecurityKey</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        Encoding</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">UTF8</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">GetBytes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">_configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Authentication:JwtBearer:SecurityKey\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">]));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> credentials</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> SigningCredentials</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">key</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">SecurityAlgorithms</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">HmacSha256</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    var</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E06C75\"> token</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\"> new</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\"> JwtSecurityToken</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        _configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Authentication:JwtBearer:Issuer\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">],</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        _configuration</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">[</span><span style=\"--shiki-light:#032F62;--shiki-dark:#98C379\">\"Authentication:JwtBearer:Audience\"</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">],</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">        claimsPrincipal</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Claims</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        expires</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">DateTime</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\">Now</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">AddMinutes</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#005CC5;--shiki-dark:#D19A66\">30</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#6F42C1;--shiki-dark:#E5C07B\">        signingCredentials</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">credentials</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">    );</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#D73A49;--shiki-dark:#C678DD\">    return</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E5C07B\"> handler</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\">WriteToken</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#24292E;--shiki-dark:#E06C75\">token</span><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>这里的 claimsPrincipal 是什么呢。简单的说就是一个存有 github 授权信息的对象，可以解析出对应的 Clamis，这里其实就是用了 Clamis 的属性值。</p>\n<p>| Claim                            | ClaimsIdentity                                                | ClaimsPrincipal         |<br>\n|</p>\n",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2022-06-13T14:06:43.000Z",
      "authors": [],
      "tags": [
        "lin-cms-dotnetcore"
      ]
    },
    {
      "title": "全局敏感词处理",
      "url": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/stopwords.html",
      "id": "https://igeekfan.cn/igeekfan-docs/dotnetcore/lin-cms/stopwords.html",
      "summary": "全局敏感词处理 基于ToolGood.Words类库，配合敏感字的文本文件，写的API接口。 https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-stopwords 一共二种方式 1.ToolGood.Words 类库配合敏感库 ToolGood.Words...",
      "content_html": "\n<p>基于ToolGood.Words类库，配合敏感字的文本文件，写的API接口。</p>\n<ul>\n<li><a href=\"https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-stopwords\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luoyunchong/dotnetcore-examples/tree/master/aspnetcore-stopwords</a></li>\n</ul>\n<p>一共二种方式</p>\n<h2>1.ToolGood.Words</h2>\n<p>类库配合敏感库</p>\n<ul>\n<li><a href=\"https://github.com/toolgood/ToolGood.Words\" target=\"_blank\" rel=\"noopener noreferrer\">ToolGood.Words</a></li>\n</ul>\n<p>简单用法</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>[Fact]</span></span>\n<span class=\"line\"><span>public void IssuesTest_17()</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    var illegalWordsSearch = new IllegalWordsSearch();</span></span>\n<span class=\"line\"><span>    string s = \"中国|zg人|abc\";</span></span>\n<span class=\"line\"><span>    illegalWordsSearch.SetKeywords(s.Split('|'));</span></span>\n<span class=\"line\"><span>    var str = illegalWordsSearch.Replace(\"我是中美国人厉害中国完美ａｂｃddb好的\", '*');</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    Assert.Equal(\"我是中美国人厉害**完美***ddb好的\", str);</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>配合敏感库文本文件，写的工具类</p>\n<p>二个文件放到wwwroot/_Illegal目录下，通过ReplaceStopWords方法调用即可对</p>\n<ul>\n<li><a href=\"https://github.com/toolgood/ToolGood.Words/blob/master/csharp/ToolGood.Words.Test/_Illegal/IllegalKeywords.txt\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/toolgood/ToolGood.Words/blob/master/csharp/ToolGood.Words.Test/_Illegal/IllegalKeywords.txt</a></li>\n<li><a href=\"https://github.com/toolgood/ToolGood.Words/blob/master/csharp/ToolGood.Words.Test/_Illegal/IllegalUrls.txt\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/toolgood/ToolGood.Words/blob/master/csharp/ToolGood.Words.Test/_Illegal/IllegalUrls.txt</a></li>\n</ul>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>public class ToolGoodUtils</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    //敏感库只要这二个文件存在即可</span></span>\n<span class=\"line\"><span>    //本地敏感库缓存-https://github.com/toolgood/ToolGood.Words/tree/master/csharp/ToolGood.Words.Test/_Illegal</span></span>\n<span class=\"line\"><span>    //因为需要上传至github并同步gitee,安全起见，所以未上传至git，需要自行下载并复制</span></span>\n<span class=\"line\"><span>    private const string KeywordsPath = \"wwwroot/_Illegal/IllegalKeywords.txt\";</span></span>\n<span class=\"line\"><span>    private const string UrlsPath = \"wwwroot/_Illegal/IllegalUrls.txt\";</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    private const string InfoPath = \"wwwroot/_Illegal/IllegalInfo.txt\";</span></span>\n<span class=\"line\"><span>    private const string BitPath = \"wwwroot/_Illegal/IllegalBit.iws\";</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    private static IllegalWordsSearch _search;</span></span>\n<span class=\"line\"><span>    /// &lt;summary&gt;</span></span>\n<span class=\"line\"><span>    /// 本地敏感库,文件修改后，重新创建缓存Bit</span></span>\n<span class=\"line\"><span>    /// &lt;/summary&gt;</span></span>\n<span class=\"line\"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>\n<span class=\"line\"><span>    public static IllegalWordsSearch GetIllegalWordsSearch()</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        if (_search == null)</span></span>\n<span class=\"line\"><span>        {</span></span>\n<span class=\"line\"><span>            string ipath = Path.GetFullPath(InfoPath);</span></span>\n<span class=\"line\"><span>            if (File.Exists(ipath) == false)</span></span>\n<span class=\"line\"><span>            {</span></span>\n<span class=\"line\"><span>                _search = CreateIllegalWordsSearch();</span></span>\n<span class=\"line\"><span>            }</span></span>\n<span class=\"line\"><span>            else</span></span>\n<span class=\"line\"><span>            {</span></span>\n<span class=\"line\"><span>                var texts = File.ReadAllText(ipath).Split('|');</span></span>\n<span class=\"line\"><span>                if (new FileInfo(Path.GetFullPath(KeywordsPath)).LastWriteTime.ToString(\"yyyy-MM-dd HH:mm:ss\") !=</span></span>\n<span class=\"line\"><span>                    texts[0] ||</span></span>\n<span class=\"line\"><span>                    new FileInfo(Path.GetFullPath(UrlsPath)).LastWriteTime.ToString(\"yyyy-MM-dd HH:mm:ss\") !=</span></span>\n<span class=\"line\"><span>                    texts[1]</span></span>\n<span class=\"line\"><span>                )</span></span>\n<span class=\"line\"><span>                {</span></span>\n<span class=\"line\"><span>                    _search = CreateIllegalWordsSearch();</span></span>\n<span class=\"line\"><span>                }</span></span>\n<span class=\"line\"><span>                else</span></span>\n<span class=\"line\"><span>                {</span></span>\n<span class=\"line\"><span>                    var s = new IllegalWordsSearch();</span></span>\n<span class=\"line\"><span>                    s.Load(Path.GetFullPath(BitPath));</span></span>\n<span class=\"line\"><span>                    _search = s;</span></span>\n<span class=\"line\"><span>                }</span></span>\n<span class=\"line\"><span>            }</span></span>\n<span class=\"line\"><span>        }</span></span>\n<span class=\"line\"><span>        return _search;</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    private static IllegalWordsSearch CreateIllegalWordsSearch()</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        string[] words1 = File.ReadAllLines(Path.GetFullPath(KeywordsPath), Encoding.UTF8);</span></span>\n<span class=\"line\"><span>        string[] words2 = File.ReadAllLines(Path.GetFullPath(UrlsPath), Encoding.UTF8);</span></span>\n<span class=\"line\"><span>        var words = new List&lt;string&gt;();</span></span>\n<span class=\"line\"><span>        foreach (var item in words1)</span></span>\n<span class=\"line\"><span>        {</span></span>\n<span class=\"line\"><span>            words.Add(item.Trim());</span></span>\n<span class=\"line\"><span>        }</span></span>\n<span class=\"line\"><span>        foreach (var item in words2)</span></span>\n<span class=\"line\"><span>        {</span></span>\n<span class=\"line\"><span>            words.Add(item.Trim());</span></span>\n<span class=\"line\"><span>        }</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>        var search = new IllegalWordsSearch();</span></span>\n<span class=\"line\"><span>        search.SetKeywords(words);</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>        search.Save(Path.GetFullPath(BitPath));</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>        var text = new FileInfo(Path.GetFullPath(KeywordsPath)).LastWriteTime.ToString(\"yyyy-MM-dd HH:mm:ss\") + \"|\"+ new FileInfo(Path.GetFullPath(UrlsPath)).LastWriteTime.ToString(\"yyyy-MM-dd HH:mm:ss\");</span></span>\n<span class=\"line\"><span>        File.WriteAllText(Path.GetFullPath(InfoPath), text);</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>        return search;</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>2. 循环使用Replace</h2>\n<p>方案：通过维护敏感库，循环replace<br>\n大佬分享给我的，稍微改成了从文件中获取敏感字。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>public static class StopWords</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    static readonly ConcurrentDictionary&lt;string, bool&gt; FunNlpDataSensitive = new ConcurrentDictionary&lt;string, bool&gt;();</span></span>\n<span class=\"line\"><span>    static readonly ConcurrentDictionary&lt;int, string&gt; ReplaceNewValue = new ConcurrentDictionary&lt;int, string&gt;();</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    private const string KeywordsPath = \"wwwroot/_Illegal/IllegalKeywords.txt\";</span></span>\n<span class=\"line\"><span>    private const string UrlsPath = \"wwwroot/_Illegal/IllegalUrls.txt\";</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    static StopWords()</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        LoadDataFromFile();</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    public static void LoadDataFromFile()</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        string words1 = File.ReadAllText(Path.GetFullPath(KeywordsPath), Encoding.UTF8);</span></span>\n<span class=\"line\"><span>        string words2 = File.ReadAllText(Path.GetFullPath(UrlsPath), Encoding.UTF8);</span></span>\n<span class=\"line\"><span>        LoadDataFromText(words1);</span></span>\n<span class=\"line\"><span>        LoadDataFromText(words2);</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    public static void LoadDataFromText(string text)</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        int oldcount = FunNlpDataSensitive.Count;</span></span>\n<span class=\"line\"><span>        foreach (string wd in text.Split('\\n'))</span></span>\n<span class=\"line\"><span>        {</span></span>\n<span class=\"line\"><span>            string keykey = wd.Trim().Trim('\\r', '\\n').Trim();</span></span>\n<span class=\"line\"><span>            if (string.IsNullOrEmpty(keykey)) continue;</span></span>\n<span class=\"line\"><span>            FunNlpDataSensitive.TryAdd(keykey, true);</span></span>\n<span class=\"line\"><span>            if (ReplaceNewValue.ContainsKey(keykey.Length) == false)</span></span>\n<span class=\"line\"><span>                ReplaceNewValue.TryAdd(keykey.Length, \"\".PadRight(keykey.Length, '*'));</span></span>\n<span class=\"line\"><span>        }</span></span>\n<span class=\"line\"><span>        Console.WriteLine($\"敏感词加载完毕，增加数量：{FunNlpDataSensitive.Count - oldcount}\");</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    /// &lt;summary&gt;</span></span>\n<span class=\"line\"><span>    /// 替换所有敏感词为 *</span></span>\n<span class=\"line\"><span>    /// &lt;/summary&gt;</span></span>\n<span class=\"line\"><span>    /// &lt;param name=\"that\"&gt;&lt;/param&gt;</span></span>\n<span class=\"line\"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>\n<span class=\"line\"><span>    public static string ReplaceStopWords(this string that)</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        foreach (var wd in FunNlpDataSensitive.Keys)</span></span>\n<span class=\"line\"><span>            that = that.Replace(wd, ReplaceNewValue.TryGetValue(wd.Length, out var tryval) ? tryval : \"\".PadRight(wd.Length, '*'));</span></span>\n<span class=\"line\"><span>        return that;</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span>}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2>FreeSql全局处理敏感词</h2>\n<p>使用FreeSql这个ORM时，全局处理string类型的值，进行敏感词处理。代码在StartUp.cs的构造函数中。</p>\n<div class=\"language- line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"\" data-title=\"\" style=\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes github-light one-dark-pro vp-code\"><code><span class=\"line\"><span>//敏感词处理</span></span>\n<span class=\"line\"><span>IllegalWordsSearch illegalWords = ToolGoodUtils.GetIllegalWordsSearch();</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>Fsql.Aop.AuditValue += (s, e) =&gt;</span></span>\n<span class=\"line\"><span>{</span></span>\n<span class=\"line\"><span>    if (e.Column.CsType == typeof(string) &amp;&amp; e.Value != null)</span></span>\n<span class=\"line\"><span>    {</span></span>\n<span class=\"line\"><span>        string oldVal = (string)e.Value;</span></span>\n<span class=\"line\"><span>        string newVal = illegalWords.Replace(oldVal);</span></span>\n<span class=\"line\"><span>        //第二种处理敏感词的方式</span></span>\n<span class=\"line\"><span>        //string newVal = oldVal.ReplaceStopWords();</span></span>\n<span class=\"line\"><span>        if (newVal != oldVal)</span></span>\n<span class=\"line\"><span>        {</span></span>\n<span class=\"line\"><span>            e.Value = newVal;</span></span>\n<span class=\"line\"><span>        }</span></span>\n<span class=\"line\"><span>    }</span></span>\n<span class=\"line\"><span>};</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>",
      "date_published": "2020-02-28T11:10:31.000Z",
      "date_modified": "2022-06-02T11:44:24.000Z",
      "authors": [],
      "tags": []
    }
  ]
}